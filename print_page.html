
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Print as PDF - famima65536/Defragmentation-of-PocketMine-Information</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/print-site.css">
    
      <link rel="stylesheet" href="css/print-site-material.css">
    
    
      


    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="famima65536/Defragmentation-of-PocketMine-Information" class="md-header__button md-logo" aria-label="famima65536/Defragmentation-of-PocketMine-Information" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            famima65536/Defragmentation-of-PocketMine-Information
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print as PDF
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/famima65536/Defragmentation-of-PocketMine-Information/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="famima65536/Defragmentation-of-PocketMine-Information" class="md-nav__button md-logo" aria-label="famima65536/Defragmentation-of-PocketMine-Information" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    famima65536/Defragmentation-of-PocketMine-Information
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/famima65536/Defragmentation-of-PocketMine-Information/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Defragmentation of PocketMine information
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="link.html" class="md-nav__link">
        リンク集
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        API4
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API4" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API4
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="API4/index.html" class="md-nav__link">
        API4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="API4/API4changelogs.html" class="md-nav__link">
        API4 Changelogs全訳(34%完了)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        サーバー構築
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="サーバー構築" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          サーバー構築
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E6%A7%8B%E7%AF%89/index.html" class="md-nav__link">
        サーバー構築
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E6%A7%8B%E7%AF%89/build-in-API4.html" class="md-nav__link">
        API4でのサーバー構築
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        単項記事
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="単項記事" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          単項記事
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      <label class="md-nav__link" for="__nav_5_1">
        Poggit
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Poggit" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Poggit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="%E5%8D%98%E9%A0%85%E8%A8%98%E4%BA%8B/poggit/poggit.html" class="md-nav__link">
        Poggit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="%E5%8D%98%E9%A0%85%E8%A8%98%E4%BA%8B/poggit/virion.html" class="md-nav__link">
        Virion
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
      <a href="print_page.html" class="md-nav__link md-nav__link--active">
        Print as PDF
      </a>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
  
                
                
                <div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <div id="print-site-banner">
            <p>
    <em>This box will disappear when printing</em>
    <span style="float: right"><a href="https://timvink.github.io/mkdocs-print-site-plugin/">mkdocs-print-site-plugin</a></span>
</p>
<p>This page combines all site pages and applies print and PDF friendly styling. Print or export to PDF using <b>File > Print > Save as PDF</b>.</p>
<p>For creating PDFs, make sure to use the browser's print and save-as-pdf function instead of the system dialog.</p>
        </div>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="6">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Index</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-defragmentation-of-pocketmine-information">Defragmentation of PocketMine information</h1>
<p>散ってしまった情報を一つにまとめます。改善点があればIssueやPull Request願います。</p>
<h2 id="index-_1">現在の情報一覧</h2>
<ul>
<li>API4関連情報</li>
<li>PocketMine-MP関連サービス・サイトリンク</li>
</ul>
<p><a href="https://famima65536.github.io/Defragmentation-of-PocketMine-Information/">https://famima65536.github.io/Defragmentation-of-PocketMine-Information/</a>を参照</p></section><section class="print-page" id="link"><h1 id="link-_1">リンク集</h1>
<h2 id="link-_2">バイナリやソースコードの配布先</h2>
<ul>
<li><a href="https://github.com/pmmp/PocketMine-MP">pmmp/PocketMine-MP(GitHub)</a> - Releaseから最新版をダウンロード可能</li>
<li><a href="https://dev.azure.com/pocketmine/PHP-Builds/_build?definitionId=3&amp;_a=summary">PHP8 Binary</a> - publishedから、︙をクリックでダウンロードできます。</li>
</ul>
<h2 id="link-_3">ドキュメント</h2>
<ul>
<li><a href="https://pmmp.readthedocs.io/en/rtfd">公式ドキュメント</a> - インストール方法やアップデート方法、プラグインについてやよくある質問を見ることができます。</li>
</ul>
<h2 id="link-_4">フォーラム</h2>
<ul>
<li><a href="https://forums.pmmp.io">Forums</a> - 公式フォーラム(英語)</li>
<li><a href="https://forum.mcbe.jp">MCBEフォーラム</a> - 非公式日本語フォーラム</li>
<li><a href="https://forum.minecraft.study/">マインクラフト非公式フォーラム</a></li>
</ul>
<h2 id="link-_5">サーバーリスト</h2>
<ul>
<li><a href="https://mcservers.jp/">MCServers.JP</a></li>
</ul>
<h2 id="link-_6">プラグイン配布先</h2>
<ul>
<li><a href="https://poggit.pmmp.io/">poggit</a> - レビューされたプラグインやその他開発中のプラグインをダウンロードできます。</li>
</ul></section><h1 class='nav-section-title'>API4</h1><section class="print-page" id="api4-index"><h1 id="api4-index-api4">API4</h1>
<h2 id="api4-index-_1">インストールについて</h2>
<p>現在(2021.10.9) API4.0.0はベータ段階であり、安定版ではありません。テスト目的でのみ使用してください。
インストール方法は以下のページを参考にしてください。
<a href="https://qiita.com/bbo51dog/items/414b6270682f1a028bfe">https://qiita.com/bbo51dog/items/414b6270682f1a028bfe</a> (Ubuntu)</p>
<h2 id="api4-index-_2">変更点の抄訳</h2>
<p>翻訳元 <a href="https://github.com/pmmp/PocketMine-MP/blob/master/changelogs/4.0.md">https://github.com/pmmp/PocketMine-MP/blob/master/changelogs/4.0.md</a></p>
<p>全訳は<a href="#api4-api4changelogs">API4changelogs</a>より</p>
<h3 id="api4-index-beta1">BETA1</h3>
<p>2021.9.7リリース
API4は重要なAPIの変更,新しいワールド形式のサポート,パフォーマンスの向上やネットワークの刷新を含めたコア全体の重要な変更に焦点を当てています。</p>
<h4 id="api4-index-general">一般 General</h4>
<ul>
<li>"プラグイングレーリスト"機能が導入されます。ローディング時からプラグインをホワイトリスト化もしくはブラックリスト化することができます。</li>
<li>Remote Console (RCON) は削除されました。<a href="https://github.com/pmmp/RconServer">RconServer</a>プラグインが代わりに提供されます。</li>
<li>スポーンプロテクションは削除されました。<a href="https://github.com/pmmp/BasicSpawnProtection">BasicSpawnProtection</a>プラグインが代わりに提供されます。</li>
<li>Ctrl+Cシグナルハンドリングは削除されました。[PcnltSignalHandler]プラグインが代わりに提供されます。</li>
<li>プレイヤー移動アンチチートは削除されました。</li>
<li>GS4 QueryはRakLibが無効化されても停止されなくなりました。</li>
<li><code>pocketmine_chunkutils</code> PHP拡張は使われなくなりました。</li>
<li>新しいPHP拡張がこのバージョンから必要になりました。<ul>
<li><a href="https://github.com/pmmp/ext-chunkutils2">chunkutils2</a></li>
<li><a href="https://github.com/pmmp/ext-morton">morton</a></li>
</ul>
</li>
<li>プレイヤーリスポーン時の多くのバグが修正されました。<ul>
<li>生成されていない地形でリスポーンする際に岩盤下にスポーンするバグ</li>
<li>非常に遅いマシン上で初回サーバー参加時に岩盤下にスポーンするバグ</li>
<li>カスタムスポーン地点がセットされている状態でリスポーンしたときにブロック内(または上空)にスポーンするバグ</li>
<li>プレイヤースポーン地点がワールドスポーンが変わった時に以前の場所になってしまうバグ</li>
</ul>
</li>
<li>高い維持コストのわりに恩恵が少ないためプリプロセッサーはビルドから削除されました。現在、プリプロセッサー利用は非推奨です。</li>
</ul>
<h4 id="api4-index-commands">コマンド Commands</h4>
<ul>
<li><code>/reload</code> コマンドは削除されました。</li>
<li><code>/effect</code> コマンドは数字IDをサポートしなくなりました。現在では名前が要求されます。</li>
<li><code>/enchant</code> コマンドは数学IDをサポートしなくなりました。現在では名前が要求されます。</li>
<li><code>/clear</code> コマンドが追加されました。バニラのMinecraftのものと機能的に同等のものです。</li>
<li>以下のコマンドの出力は選択した言語にローカライズされました。<ul>
<li><code>/gc</code></li>
<li><code>/status</code></li>
<li><code>/op</code></li>
<li><code>/deop</code></li>
</ul>
</li>
</ul>
<h4 id="api4-index-configuration">設定 Configuration</h4>
<ul>
<li>ワールドのプリセットは<code>pocketmine.yml</code>の<code>preset</code>キーとして利用できるようになりました: 以前は<code>generator</code>キー</li>
<li>新たに以下のオプションが<code>pocketmine.yml</code>に追加されます<ul>
<li><code>chunk-ticking.blocks-per-subchunk-per-tick</code>(デフォルト <code>3</code>):この値を増加させるとランダムブロックアップデートの確率が上がります。(例. 草の成長)</li>
<li><code>network.enable-encryption</code>(デフォルト<code>true</code>): Minecraftネットワークパケットを暗号化するか否かを決定できます。</li>
</ul>
</li>
<li>以下のオプションが<code>pocketmine.yml</code>から削除されました。<ul>
<li><code>chunk-ticking.light-updates</code>: 明るさ計算は基本的なバニラの機能を動作させるのに必要なため、チャンクチックを無効化することなくこの機能を停止することは意味がありません。もし、明るさ計算をしたくなければチャンクチックと共に無効化するようにしてください。</li>
<li><code>player.anti-cheat.allow-movement-cheats</code></li>
</ul>
</li>
</ul>
<h2 id="api4-index-_3">開発者向け情報</h2>
<h3 id="api4-index-devtools-api4">DevTools API4対応版の配布場所</h3>
<p>poggit上でダウンロード可 <a href="https://poggit.pmmp.io/ci/pmmp/DevTools/PocketMine-DevTools">https://poggit.pmmp.io/ci/pmmp/DevTools/PocketMine-DevTools</a> の Build History:master により最新版がダウンロード可能</p></section><section class="print-page" id="api4-api4changelogs"><h1 id="api4-api4changelogs-api4-changelogs34">API4 Changelogs全訳(34%完了)</h1>
<h2 id="api4-api4changelogs-_1">訳に関して</h2>
<p><a href="https://github.com/pmmp/PocketMine-MP/commit/9e6d7405709560c0025e072324602983213276dd">https://github.com/pmmp/PocketMine-MP/commit/9e6d7405709560c0025e072324602983213276dd</a> 版より翻訳</p>
<p>翻訳漏れの無いように気を配りますが、書かれていない項目がある場合PRを送ってもらえると助かります。</p>
<h2 id="api4-api4changelogs-400-beta1">4.0.0-BETA1</h2>
<p>2021.9.7リリース
このメジャーバージョンAPI4は重要なAPIの変更,新しいワールド形式のサポート,パフォーマンスの向上やネットワークの刷新を含めたコア全体の重要な変更に焦点を当てています。</p>
<p>これはベータリリースであり、最終版でないことを注意してください。 現在からリリースまでに重大な変更はない予定ですがAPIはまだ変更される可能性があります。</p>
<p>さらに、このチェンジログはベストエフォートに基づいて提供されていて、すべての変更点が言及されていない可能性があることに注意してください。何か洩れがあった場合追加するためにプルリクエストをお願いします。(すなわち pmmp公式へ)</p>
<h3 id="api4-api4changelogs-_2">警告</h3>
<p>これは安定版リリースでは<strong>ありません</strong>。PMMPはこのビルドを使用したことによる損害のいかなる責任を負いません。
<strong>テスト</strong>目的にのみ使用してください。</p>
<h3 id="api4-api4changelogs-_3">コア</h3>
<h4 id="api4-api4changelogs-general">一般 General</h4>
<ul>
<li>"プラグイングレーリスト"機能が導入されます。ローディング時からプラグインをホワイトリスト化もしくはブラックリスト化することができます。</li>
<li>Remote Console (RCON) は削除されました。<a href="https://github.com/pmmp/RconServer">RconServer</a>プラグインが代わりに提供されます。</li>
<li>スポーンプロテクションは削除されました。<a href="https://github.com/pmmp/BasicSpawnProtection">BasicSpawnProtection</a>プラグインが代わりに提供されます。</li>
<li>Ctrl+Cシグナルハンドリングは削除されました。[PcnltSignalHandler]プラグインが代わりに提供されます。</li>
<li>プレイヤー移動アンチチートは削除されました。</li>
<li>GS4 QueryはRakLibが無効化されても停止されなくなりました。</li>
<li><code>pocketmine_chunkutils</code> PHP拡張は使われなくなりました。</li>
<li>新しいPHP拡張がこのバージョンから必要になりました。<ul>
<li><a href="https://github.com/pmmp/ext-chunkutils2">chunkutils2</a></li>
<li><a href="https://github.com/pmmp/ext-morton">morton</a></li>
</ul>
</li>
<li>プレイヤーリスポーン時の多くのバグが修正されました。<ul>
<li>生成されていない地形でリスポーンする際に岩盤下にスポーンするバグ</li>
<li>非常に遅いマシン上で初回サーバー参加時に岩盤下にスポーンするバグ</li>
<li>カスタムスポーン地点がセットされている状態でリスポーンしたときにブロック内(または上空)にスポーンするバグ</li>
<li>プレイヤースポーン地点がワールドスポーンが変わった時に以前の場所になってしまうバグ</li>
</ul>
</li>
<li>高い維持コストのわりに恩恵が少ないためプリプロセッサーはビルドから削除されました。現在、プリプロセッサー利用は非推奨です。</li>
</ul>
<h4 id="api4-api4changelogs-commands">コマンド Commands</h4>
<ul>
<li><code>/reload</code> コマンドは削除されました。</li>
<li><code>/effect</code> コマンドは数字IDをサポートしなくなりました。現在では名前が要求されます。</li>
<li><code>/enchant</code> コマンドは数学IDをサポートしなくなりました。現在では名前が要求されます。</li>
<li><code>/clear</code> コマンドが追加されました。バニラのMinecraftのものと機能的に同等のものです。</li>
<li>以下のコマンドの出力は選択した言語にローカライズされました。<ul>
<li><code>/gc</code></li>
<li><code>/status</code></li>
<li><code>/op</code></li>
<li><code>/deop</code></li>
</ul>
</li>
</ul>
<h4 id="api4-api4changelogs-configuration">設定 Configuration</h4>
<ul>
<li>ワールドのプリセットは<code>pocketmine.yml</code>の<code>preset</code>キーとして利用できるようになりました: 以前は<code>generator</code>キー</li>
<li>新たに以下のオプションが<code>pocketmine.yml</code>に追加されます<ul>
<li><code>chunk-ticking.blocks-per-subchunk-per-tick</code>(デフォルト <code>3</code>):この値を増加させるとランダムブロックアップデートの確率が上がります。(例. 草の成長)</li>
<li><code>network.enable-encryption</code>(デフォルト<code>true</code>): Minecraftネットワークパケットを暗号化するか否かを決定できます。</li>
</ul>
</li>
<li>以下のオプションが<code>pocketmine.yml</code>から削除されました。<ul>
<li><code>chunk-ticking.light-updates</code>: 光処理は基本的なバニラの機能を動作させるのに必要なため、チャンクチックを無効化することなくこの機能を停止することは意味がありません。もし、明るさ計算をしたくなければチャンクチックと共に無効化するようにしてください。</li>
<li><code>player.anti-cheat.allow-movement-cheats</code></li>
</ul>
</li>
</ul>
<h4 id="api4-api4changelogs-_4">ワールドハンドリング</h4>
<h5 id="api4-api4changelogs-_5">インターフェイス</h5>
<ul>
<li>最初のワールド生成時にスポーン地形チャンク生成の進度が表示されるようになりました。</li>
</ul>
<h5 id="api4-api4changelogs-_6">機能</h5>
<ul>
<li>1.12.xまでのMinecraft Bedrockのワールドがサポートされました。(1.13より上はまた別の形式変更によりまだ<strong>サポートされていません</strong>。対応には非常に労力を要します。)</li>
<li>非推奨のワールド形式の自動変換が実装されました。</li>
<li><code>leveldb</code>以外のすべての形式は非推奨となりました。以下のワールド形式は<strong>ロード時に自動的に新しい形式に変換されます</strong>:<ul>
<li><code>mcregion</code></li>
<li><code>anvil</code></li>
<li><code>pmanvil</code></li>
</ul>
</li>
<li>建築上限256はすべてのワールドでサポートされます。(自動変換により)</li>
<li>追加ブロックがサポートされます。(自動変換により)</li>
<li>光処理はディスク上に保存・ロードされなくなりました。</li>
<li>かわりに必要に応じてすぐに算出されます。これは以前からあった多くのバグを修正します。</li>
</ul>
<h5 id="api4-api4changelogs-_7">パフォーマンス</h5>
<ul>
<li><code>leveldb</code>は現在、基本のサポートされたワールド形式です。優れた設計により生来よりリージョンベース形式よりも高速です。</li>
<li>部分的なチャンク保存(変更されたチャンクの子要素のみを保存する)が実装されました。これによりチャンク保存時に書き込む必要のあるデータ量を徹底的に減らすことができます。また、同様に<strong>ワールド保存にかかる時間も徹底的に減らします</strong>。 これは<code>leveldb</code>ワールド形式のモジュール設計に可能になりました。リージョンベース形式ではこの強化はできません。</li>
<li>光処理はすべてのチャンクで利用可能であるとは限らなくなります。必要に応じてすぐに算出されます。</li>
<li><code>/op</code>, <code>/deop</code>, <code>/whitelist add</code> and <code>/whitelist remove</code> は理由なくプレイヤーデータを読み込まないようになりました。</li>
<li><code>Timings</code>はより正確なパフォーマンスメトリクスを収集するため<code>hrtime()</code>により提供される高精度なタイマーを使うようになります。</li>
<li>Z階数曲線(モートンコード)がブロックとチャンク座標のハッシュのために使用されます。これはハッシュテーブルキーハッシュ衝突問題を解決することにより広い範囲でパフォーマンスを非常に改善します。影響がある範囲には爆発や明るさ計算などを含みます。</li>
<li><a href="https://github.com/ebiggers/libdeflate"><code>libdeflate</code></a>が(オプションで)外方向へのMinecraftパケット圧縮に使用できます。これは多くのケースで<code>zlib</code>の2倍以上高速で、パケットブロードキャストとネットワーク全体の性能を向上させます。</li>
<li>クロージャーは現在内部イベントハンドラーの呼び出しのために使用されています。これにより3.xシステムよりも10-20%の性能向上ができます。3.xシステムはイベントコールのたびに動的にコーラブルを解決する必要がありました。</li>
</ul>
<h4 id="api4-api4changelogs-logger">Logger刷新</h4>
<ul>
<li>多くのコンポーネントは自動的にプレフィックスをメッセージに追加する専用のロガーを持つようになりました。</li>
<li>メインロガーはミリ秒のタイムスタンプを含むようになりました。</li>
</ul>
<h4 id="api4-api4changelogs-_8">ネットワーク</h4>
<p>このバージョンではネットワークシステムの重大な変更を組み込んでいます: コヒーレンシ、信頼性、モジュール性の向上をしました。</p>
<h5 id="api4-api4changelogs-minecraft-bedrock">Minecraft Bedrock パケット暗号化</h5>
<ul>
<li>これはハッカーがプレイヤーのログインを盗聴し利用することによる反射攻撃を防ぎます。</li>
<li>新たな設定<code>network.enable-encryption</code>が<code>pocketmine.yml</code>に追加されました。デフォルトでは<code>true</code>です。</li>
</ul>
<h5 id="api4-api4changelogs-_9">パケット受信エラーハンドリングが整備されました</h5>
<ul>
<li>今は<code>BadPacketException</code>のみがパケットのデコード、ハンドリング時にキャッチされます。これにはすべてのデコードが適切なエラーチェックを行うことが<strong>必須</strong>とされます。<ul>
<li>デコードで<code>BadPacketException</code>を投げるとプレイヤーは<code>Packet processing error</code>メッセージでキックされます。</li>
<li>切断メッセージにはサーバーオーナーがプレイヤーから報告された問題を特定しやすくするためのランダムな16進数IDが含まれます。</li>
</ul>
</li>
<li>そのほかの例外を投げるとサーバーはクラッシュします。<code>Internal server error</code>は削除されました。</li>
<li>現在ではサーバーに対するクライアント方向へのパケットの送信は不当なものになりました。これを行うとクライアントは<code>Unexpected non-serverbound packet</code>メッセージでキックされます。</li>
</ul>
<h5 id="api4-api4changelogs-_10">新たなパケットハンドラーシステム</h5>
<ul>
<li>パケットハンドラーはネットワークセッションから分離され、専用のパケットハンダラー構造に分かれました。</li>
<li>ネットワークセッションは正確に1つのハンドラーをその時点で持つことができます。ハンドラーは可変ありいつでも置き換えられます。これによりパケットハンドリングのロジックを複数のステージへと分離することができます。<ul>
<li>不正なタイミングで不正なパケットを送信することを防ぐ(今では何事もなくドロップされます)</li>
<li>一時的な状態固有のロジックの存在を許可する(例えばリソースパックのより厳格なダウンロードチェック)</li>
</ul>
</li>
<li>パケットハンドラーはほとんどいたるところで<code>Player</code>からなくなり、代わりにそのパケットハンドラー専用のユニットに存在しまるようになりました。</li>
<li>以前まで<code>Player</code>のパケットハンドラー内部に絡み合っていたほぼすべてのゲームロジックは新たなAPIメソッドへと展開されました。詳しくはPlayer APIの変更をご覧ください。</li>
</ul>
<h3 id="api4-api4changelogs-api">API</h3>
<h4 id="api4-api4changelogs-_11">一般</h4>
<ul>
<li>以前まで<code>callable</code>を許容していた大半の個所は、現在では<code>/Closure</code>のみを許可します。これはクロージャーがより一貫性のある振る舞いをして性能がより高いためです。</li>
<li><code>void</code>と<code>?nullable</code> パラメータおよび返り値の型指定は多くの箇所に適用されました。</li>
<li><code>pocketmine\metadeta</code>にあるすべてのものとそれに関連する実装は削除されました。</li>
</ul>
<h4 id="api4-api4changelogs-pluginyml"><code>plugin.yml</code>の変更</h4>
<h5 id="api4-api4changelogs-_12">パーミッションのネスト</h5>
<p>パーミッションのネストは<code>plugin.yml</code>内ではサポートされなくなりました。 <code>plugin.yml</code>内で(デフォルトにより)パーミッションのグループ化には、非常に混乱しやすく一貫性のないふるまいがありました。
ネストによるパーミッションの宣言の代わりに、宣言はそれぞればらばらになさなければならなりません。</p>
<p><em>Before</em>:
<div class="highlight"><pre><span></span><code>permissions:
    pmmp:
        default: op
children:
    pmmp.something:
        default: op
            pmmp.somethingElse:
                default: op
</code></pre></div></p>
<p><em>After</em>:
<div class="highlight"><pre><span></span><code>permissions:
    pmmp.something:
        default: op
    pmmp.somethingElse:
        default: op
</code></pre></div></p>
<h5 id="api4-api4changelogs-src-namespace-prefix"><code>src-namespace-prefix</code></h5>
<p>新しい指示文<code>src-namespace-prefix</code>が導入されます。これにより以下のようなプラグイン構造にある無駄なサブディレクトリを取り除くことができます。
例えば、以前では<code>pmmp\TesterPlugin\Main</code>がメインクラスであるようなプラグインはこのような構造でした。
<div class="highlight"><pre><span></span><code>|-- plugin.yml
|-- src/
    |-- pmmp/
        |-- TesterPlugin/
            |-- Main.php
            |-- SomeOtherClass.php
            |-- SomeNamespace/
                |-- SomeNamespacedClass.php
</code></pre></div>
しかし、<code>src-namespace-prefix:pmmp\TesterPlugin</code>を<code>plugin.yml</code>に付けくわえることで無駄なディレクトリを取り除き、このような構造にすることができます。
<div class="highlight"><pre><span></span><code>|-- plugin.yml
|-- src/
    |-- Main.php
    |-- SomeOtherClass.php
    |-- SomeNamespace/
        |-- SomeNamespacedClass.php
</code></pre></div></p>
<p><strong>ノート</strong>: 昔の構造でもちゃんと動きます。これは必ず変えなければならない変更ではありません。</p>
<h5 id="api4-api4changelogs-block">Block</h5>
<ul>
<li>新たに<code>VanillaBlocks</code>クラスが追加されました。このクラスは現在知られているどのブロックタイプでも生成できる静的メソッドを保有しています。 これは定数が使われている場合に<code>BlockFactory::get()</code>の代わりとしてしようされることが好ましいです。</li>
<li>ブロックは<code>Position</code>を継承するかわりにポジションを保有します。<code>Block-&gt;getBlockPosition()</code>が追加されました。</li>
<li>256以上のIDをもつブロックがサポートされました。</li>
<li>ブロックのステートとバリアントメタデータは分離されました。<ul>
<li>バリアントはIDの拡張と考えられ、不変です。(解説:これは回転や開閉といった状態を含まないことを表す)</li>
<li><code>Block-&gt;setDamage()</code>は削除されました。</li>
<li>すべてのブロックにはブロックプロパティ相応のゲッターとセッターが備わりました。例えば<code>facing</code> どの向きか,<code>lit/unlit</code> 着火/消火, <code>colour</code> 色などです。これらはメタデータの代わりに利用されるべきです。</li>
</ul>
</li>
<li>タイルエンティティは,タイルエンティティを必要とするブロックが<code>World-&gt;setBlock()</code>されたときに自動的に作成/削除されるようになります。</li>
<li>いくつかのタイルエンティティのAPIは,タイルエンティティが非推奨となると同時に対応する<code>Block</code>クラスで公開されるようになりました。</li>
<li>名前空間<code>pocketmine\tile</code>は<code>pocketmine\block\tile</code>に移動されました。</li>
<li><code>Block-&gt;recalculateBoundingBox()</code>と<code>Block-&gt;recalculateCollisionBoxes()</code>は自身の位置基準ではなく<code>0,0,0</code>に基準のAABBsを返すようになります。</li>
<li>ブロックの破壊情報は新しい動的な<code>BlockBreakInfo</code>ユニットへと展開されました。以下のメソッドが移動されます。<ul>
<li><code>Block-&gt;getBlastResistance()</code> -&gt; <code>BlockBreakInfo-&gt;getBlastResistance()</code></li>
<li><code>Block-&gt;getBreakTime()</code> -&gt; <code>BlockBreakInfo-&gt;getBreakTime()</code></li>
<li><code>Block-&gt;getHardness()</code> -&gt; <code>BlockBreakInfo-&gt;getHardness()</code></li>
<li><code>Block-&gt;getToolHarvestLevel()</code> -&gt; <code>BlockBreakInfo-&gt;getToolHarvestLevel()</code></li>
<li><code>Block-&gt;getToolType()</code> -&gt; <code>BlockBreakInfo-&gt;getToolType()</code></li>
<li><code>Block-&gt;isBreakable()</code> -&gt; <code>BlockBreakInfo-&gt;isBreakable()</code></li>
<li><code>Block-&gt;isCompatibleWithTool()</code> -&gt; <code>BlockBreakInfo-&gt;isToolCompatible()</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Block-&gt;asItem()</code>: ブロックに対応するアイテムスタックを返す。</li>
<li><code>Block-&gt;isSameState()</code>: ステート情報を含めてブロックが同じパラメータであるかを返す。</li>
<li><code>Block-&gt;isSameType()</code>: ステート情報を含めずにブロックが同じパラメータであるかを返す。</li>
<li><code>Block-&gt;isFullCube()</code></li>
</ul>
</li>
<li>以下のフックが追加されました。<ul>
<li><code>Block-&gt;onAttack()</code>: サバイバルモードのプレイヤーがブロックを左クリックしブロックの破壊をし始めた時に呼ばれる。</li>
<li><code>Block-&gt;onEntityLand()</code>: エンティティが(高さによらず)落下後にブロック上に乗ったときに呼ばれる。</li>
<li><code>Block-&gt;onPostPlace()</code>: ワールドにおかれた直後に呼ばれ、レール接続やチェストの連結をハンドルする。</li>
</ul>
</li>
<li>以下のAPIメソッドがリネームされました。<ul>
<li><code>Block-&gt;getDamage()</code> -&gt; <code>Block-&gt;getMeta()</code></li>
<li><code>Block-&gt;onActivate()</code> -&gt; <code>Block-&gt;onInteract()</code></li>
<li><code>Block-&gt;onEntityCollide()</code> -&gt; <code>Block-&gt;onEntityInside()</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変わりました。<ul>
<li><code>Block-&gt;onInteract()</code> は現在ではシグネチャ <code>onInteract(Item $item, int $face, Vector3 $clickVector, ?Player $player = null) : bool</code> を持ちます。</li>
<li><code>Block-&gt;getCollisionBoxes()</code> はファイナルになりました。 子クラスは<code>recalculateCollisionBoxes()</code>をオーバーライドするべきです。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Block-&gt;canPassThrough()</code></li>
<li><code>Block-&gt;setDamage()</code></li>
<li><code>Block::get()</code>: これはずいぶん前に <code>BlockFactory::get()</code>に置き換えられています。</li>
<li><code>Block-&gt;getBoundingBox()</code></li>
</ul>
</li>
<li>以下のクラスはリネームされました。<ul>
<li><code>BlockIds</code> -&gt; <code>BlockLegacyIds</code></li>
<li><code>CobblestoneWall</code> -&gt; <code>Wall</code></li>
<li><code>NoteBlock</code> -&gt; <code>Note</code></li>
<li><code>SignPost</code> -&gt; <code>Sign</code></li>
<li><code>StandingBanner</code> -&gt; <code>Banner</code></li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>Bricks</code></li>
<li><code>BurningFurnace</code></li>
<li><code>CobblestoneStairs</code></li>
<li><code>Dandelion</code></li>
<li><code>DoubleSlab</code></li>
<li><code>DoubleStoneSlab</code></li>
<li><code>EndStone</code></li>
<li><code>GlowingRedstoneOre</code></li>
<li><code>GoldOre</code></li>
<li><code>Gold</code></li>
<li><code>IronDoor</code></li>
<li><code>IronOre</code></li>
<li><code>IronTrapdoor</code></li>
<li><code>Iron</code></li>
<li><code>Lapis</code></li>
<li><code>NetherBrickFence</code></li>
<li><code>NetherBrickStairs</code></li>
<li><code>Obsidian</code></li>
<li><code>PurpurStairs</code></li>
<li><code>Purpur</code></li>
<li><code>QuartzStairs</code></li>
<li><code>Quartz</code></li>
<li><code>RedSandstoneStairs</code></li>
<li><code>RedSandstone</code></li>
<li><code>SandstoneStairs</code></li>
<li><code>Sandstone</code></li>
<li><code>StainedClay</code></li>
<li><code>StainedGlassPane</code></li>
<li><code>StainedGlass</code></li>
<li><code>StoneBrickStairs</code></li>
<li><code>StoneBricks</code></li>
<li><code>StoneSlab2</code></li>
<li><code>StoneSlab</code></li>
<li><code>Stone</code></li>
<li><code>WallBanner</code></li>
<li><code>WallSign</code></li>
<li><code>Wood2</code></li>
</ul>
</li>
<li><code>BlockToolType</code>の定数は<code>TYPE_</code>プレフィックスを削除する形でリネームされました。</li>
</ul>
<h4 id="api4-api4changelogs-command">Command</h4>
<ul>
<li>以下のクラスは削除されました。<ul>
<li><code>RemoteConsoleCommandSender</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変わりました。<ul>
<li><code>Command-&gt;setPermission()</code> nullableではありますが、引数が必須になりました</li>
<li><code>CommandSender-&gt;setScreenLineHeight()</code> nullableではありますが、引数が必須になりました</li>
</ul>
</li>
<li>名前に空白を含むコマンドはサポートされなくなりました</li>
</ul>
<h4 id="api4-api4changelogs-entity">Entity</h4>
<h5 id="api4-api4changelogs-_13">一般</h5>
<ul>
<li><code>Entity</code>は<code>Location</code>を継承しなくなります。 代わりに<code>Entity-&gt;getLocation()</code>や<code>Entity-&gt;getPosition()</code>を使ってください。</li>
<li>以下のフィールドは削除されました。<ul>
<li><code>Entity-&gt;chunk</code>: エンティティはどのチャンクにいるのかを自身では記憶しなくなりました (かわりに<code>World</code>がそれを管理します)。</li>
<li><code>Entity-&gt;height</code>: <code>EntitySizeInfo</code>に移動しました。 代わりに<code>Entity-&gt;size</code>を使ってください。</li>
<li><code>Entity-&gt;width</code>: <code>EntitySizeInfo</code>に移動しました。 代わりに<code>Entity-&gt;size</code>を使ってください。</li>
<li><code>Entity-&gt;eyeHeight</code>: <code>EntitySizeInfo</code>に移動しました。 代わりに <code>Entity-&gt;size</code>を使ってください。</li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Entity-&gt;getFallDistance()</code></li>
<li><code>Entity-&gt;setFallDistance()</code></li>
<li><code>ItemEntity-&gt;getDespawnDelay()</code></li>
<li><code>ItemEntity-&gt;setDespawnDelay()</code></li>
<li><code>Living-&gt;calculateFallDamage()</code>: これは<code>protected</code>です。 サブクラスにより、これをオーバーライドすることでダメージロジックをカスタマイズできます。</li>
<li><code>Human-&gt;getHungerManager()</code></li>
<li><code>Human-&gt;getXpManager()</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変わりました。<ul>
<li><code>Entity-&gt;entityBaseTick()</code>は<code>protected</code>になりました。</li>
<li><code>Entity-&gt;move()</code>は<code>protected</code>になりました。</li>
<li><code>Living-&gt;knockBack()</code>は<code>float, float, float</code>を受け入れるようになりました。 (最初の２つのパラメーターは削除されました).</li>
<li><code>Living-&gt;getEffects()</code>は<code>Effect[]</code>の代わりに<code>EffectManager</code>を返すようになりました。</li>
</ul>
</li>
<li>以下のクラスは追加されました。<ul>
<li><code>effect\EffectManager</code>: <code>Living</code>から展開されたエフェクト管理の機能群を保持します。</li>
<li><code>HungerManager</code>: <code>Human</code>から展開された空腹管理の機能群を保持します。</li>
<li><code>ExperienceManager</code>: <code>Human</code>から展開された経験値管理の機能群を保持します。</li>
</ul>
</li>
<li>以下のAPIメソッドは移動、またはリネームされました。<ul>
<li><code>Entity-&gt;fall()</code> -&gt; <code>Entity-&gt;onHitGround()</code> (また、アクセス権が<code>public</code>から<code>protected</code>になりました。)</li>
<li><code>Living-&gt;removeAllEffects()</code> -&gt; <code>EffectManager-&gt;clear()</code></li>
<li><code>Living-&gt;removeEffect()</code> -&gt; <code>EffectManager-&gt;remove()</code></li>
<li><code>Living-&gt;addEffect()</code> -&gt; <code>EffectManager-&gt;add()</code></li>
<li><code>Living-&gt;getEffect()</code> -&gt; <code>EffectManager-&gt;get()</code></li>
<li><code>Living-&gt;hasEffect()</code> -&gt; <code>EffectManager-&gt;has()</code></li>
<li><code>Living-&gt;hasEffects()</code> -&gt; <code>EffectManager-&gt;hasEffects()</code></li>
<li><code>Living-&gt;getEffects()</code> -&gt; <code>EffectManager-&gt;all()</code></li>
<li><code>Human-&gt;getFood()</code> -&gt; <code>HungerManager-&gt;getFood()</code></li>
<li><code>Human-&gt;setFood()</code> -&gt; <code>HungerManager-&gt;setFood()</code></li>
<li><code>Human-&gt;getMaxFood()</code> -&gt; <code>HungerManager-&gt;getMaxFood()</code></li>
<li><code>Human-&gt;addFood()</code> -&gt; <code>HungerManager-&gt;addFood()</code></li>
<li><code>Human-&gt;isHungry()</code> -&gt; <code>HungerManager-&gt;isHungry()</code></li>
<li><code>Human-&gt;getSaturation()</code> -&gt; <code>HungerManager-&gt;getSaturation()</code></li>
<li><code>Human-&gt;setSaturation()</code> -&gt; <code>HungerManager-&gt;setSaturation()</code></li>
<li><code>Human-&gt;addSaturation()</code> -&gt; <code>HungerManager-&gt;addSaturation()</code></li>
<li><code>Human-&gt;getExhaustion()</code> -&gt; <code>HungerManager-&gt;getExhaustion()</code></li>
<li><code>Human-&gt;setExhaustion()</code> -&gt; <code>HungerManager-&gt;setExhaustion()</code></li>
<li><code>Human-&gt;exhaust()</code> -&gt; <code>HungerManager-&gt;exhaust()</code></li>
<li><code>Human-&gt;getXpLevel()</code> -&gt; <code>ExperienceManager-&gt;getXpLevel()</code></li>
<li><code>Human-&gt;setXpLevel()</code> -&gt; <code>ExperienceManager-&gt;setXpLevel()</code></li>
<li><code>Human-&gt;addXpLevels()</code> -&gt; <code>ExperienceManager-&gt;addXpLevels()</code></li>
<li><code>Human-&gt;subtractXpLevels()</code> -&gt; <code>ExperienceManager-&gt;subtractXpLevels()</code></li>
<li><code>Human-&gt;getXpProgress()</code> -&gt; <code>ExperienceManager-&gt;getXpProgress()</code></li>
<li><code>Human-&gt;setXpProgress()</code> -&gt; <code>ExperienceManager-&gt;setXpProgress()</code></li>
<li><code>Human-&gt;getRemainderXp()</code> -&gt; <code>ExperienceManager-&gt;getRemainderXp()</code></li>
<li><code>Human-&gt;getCurrentTotalXp()</code> -&gt; <code>ExperienceManager-&gt;getCurrentTotalXp()</code></li>
<li><code>Human-&gt;setCurrentTotalXp()</code> -&gt; <code>ExperienceManager-&gt;setCurrentTotalXp()</code></li>
<li><code>Human-&gt;addXp()</code> -&gt; <code>ExperienceManager-&gt;addXp()</code></li>
<li><code>Human-&gt;subtractXp()</code> -&gt; <code>ExperienceManager-&gt;subtractXp()</code></li>
<li><code>Human-&gt;getLifetimeTotalXp()</code> -&gt; <code>ExperienceManager-&gt;getLifetimeTotalXp()</code></li>
<li><code>Human-&gt;setLifetimeTotalXp()</code> -&gt; <code>ExperienceManager-&gt;setLifetimeTotalXp()</code></li>
<li><code>Human-&gt;canPickupXp()</code> -&gt; <code>ExperienceManager-&gt;canPickupXp()</code></li>
<li><code>Human-&gt;onPickupXp()</code> -&gt; <code>ExperienceManager-&gt;onPickupXp()</code></li>
<li><code>Human-&gt;resetXpCooldown()</code> -&gt; <code>ExperienceManager-&gt;resetXpCooldown()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Human-&gt;getRawUniqueId()</code>は、代わりに<code>Human-&gt;getUniqueId()-&gt;toBinary()</code>を使うようになりました。</li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>Creature</code></li>
<li><code>Damageable</code></li>
<li><code>Monster</code></li>
<li><code>NPC</code></li>
<li><code>Rideable</code></li>
<li><code>Vehicle</code></li>
</ul>
</li>
<li><code>Skin</code>無効なデータを受け取ると例外を投げるようになりました。</li>
</ul>
<h5 id="api4-api4changelogs-effect">Effect</h5>
<ul>
<li>全ての<code>Effect</code>に関連したクラスは<code>pocketmine\entity\effect</code>の名前空間に移動しました。</li>
<li><code>Effect</code>クラスに入っていたエフェクト機能はいくつかのクラスに分けられました。以下のクラスが新しく追加されました。<ul>
<li><code>AbsorptionEffect</code></li>
<li><code>HealthBoostEffect</code></li>
<li><code>HungerEffect</code></li>
<li><code>InstantDamageEffect</code></li>
<li><code>InstantEffect</code></li>
<li><code>InstantHealthEffect</code></li>
<li><code>InvisibilityEffect</code></li>
<li><code>LevitationEffect</code></li>
<li><code>PoisonEffect</code></li>
<li><code>RegenerationEffect</code></li>
<li><code>SaturationEffect</code></li>
<li><code>SlownessEffect</code></li>
<li><code>SpeedEffect</code></li>
<li><code>WitherEffect</code></li>
</ul>
</li>
<li><code>VanillaEffects</code>クラスが追加されました。これは全てのバニラエフェクトタイプを静的メソッドで表現し、<code>Effect::getEffect()</code>よりもきれいに書けるようになります。<ul>
<li>例: <code>Effect::getEffect(Effect::NIGHT_VISION)</code>は<code>VanillaEffects::NIGHT_VISION()</code>に置き換えることができます。</li>
</ul>
</li>
<li>エフェクトの強さ(amplifiers)を負の値にすることは現在では明確に禁止されます。エフェクトの生み出す効果が定義されていないためです。</li>
<li>MCPEのエフェクトIDとPocketMine-MP内部のIDの境目がより明確になりました。<ul>
<li>IDハンドリングは<code>pocketmine\data\bedrock\EffectIdMap</code>へ移動しました。</li>
<li>すべてのエフェクトID定数は<code>Effect</code>から削除されました。何らかの理由でレガシーエフェクトIDが必要なら<code>pocketmine\data\bedrock\EffectIds</code>を利用してください。</li>
</ul>
</li>
<li>以下のAPIメソッドは移動しました。<ul>
<li><code>Effect-&gt;getId()</code> -&gt; <code>EffectIdMap-&gt;toId()</code></li>
<li><code>Effect::registerEffect()</code> -&gt; <code>EffectIdMap-&gt;register()</code></li>
<li><code>Effect::getEffect()</code> -&gt; <code>EffectIdMap-&gt;fromId()</code></li>
<li><code>Effect::getEffectByName()</code> -&gt; <code>VanillaEffects::fromString()</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Effect-&gt;getRuntimeId()</code>: これは<strong>動的ID</strong>でありエフェクトタイプの比較に用いることができます。<strong>これは決して保持されないため、configやNBTでは利用しないでください！</strong></li>
</ul>
</li>
</ul>
<h5 id="api4-api4changelogs-nbt">実行時エンティティNBTの削除</h5>
<ul>
<li>エンティティは実行時にNBTを存在させ続けなくなりました。<ul>
<li><code>Entity-&gt;namedtag</code>は削除されました。</li>
<li><code>Entity-&gt;saveNBT()</code>はその場で前のNBTに変更を加えるのではなく、現在では新規生成された<code>CompoundTag</code>を返すようになりました。</li>
<li><code>Entity-&gt;initEntity()</code>は現在では<code>CompoundTag</code>パラメータを受け付けます。</li>
</ul>
</li>
</ul>
<h5 id="api4-api4changelogs-_14">エンティティ生成</h5>
<ul>
<li><code>Entity::createEntity()</code>は削除されました。もはや実行時に新たなエンティティを生成するためには必要なくなりました。代わりに、単に<code>new YourEntity</code>のようにしてください。</li>
<li><code>Entity</code>の子クラスのコンストラクタは普通のクラスと同様にどのようなシグネチャでも持つことができます。</li>
<li>NBTからのエンティティの読み込みは現在では<code>EntityFactory</code>にハンドルされるようになりました。<code>Entity::createEntity()</code>の動作とはかなり違った動作をします。 <code>YourEntity::class</code>を一式のMinecraft save IDに登録する代わりに、 あるNBTと<code>World</code>が与えられたときにエンティティを構築するコールバックを与える必要があります。<ul>
<li>生成コールバックは<code>EntityFactory::register()</code>を用いて登録されます。</li>
<li>生成コールバックはシグネチャ<code>function(World, CompoundTag) : Entity</code>を持つ必要があります。</li>
<li>これにより<code>Entity</code>の子クラスはそれぞれにふさわしいコンストラクタ引数を持てるようになりました。</li>
<li>また、特定のデータが常に与えられるように要求することも可能になります。(例えば、<code>FallingBlock</code>をどの種類のブロックかを指定することなく生成するというのは理解できません。)</li>
<li>例:<ul>
<li><code>ItemEntity</code>は現在では<code>Item</code>をコンストラクタで要求するようになりました。そのため、生成コールバックは<code>Item</code>をコンストラクタに渡されたNBTからデコードするものです。</li>
<li><code>Painting</code>は現在では<code>PaintingMotive</code>をコンストラクタで要求するようになりました。そのため、生成コールバックはどの<code>PaintingMotive</code>を与えるべきかを受け取ったNBTに応じて決定するものです。</li>
<li>さらなる例は<code>EntityFactory</code>をご覧ください。</li>
</ul>
</li>
</ul>
</li>
<li><code>EntityFactory::register()</code>(以前の<code>Entity::registerEntity()</code>)はエラー発生時に<code>false</code>のかわりに例外を投げるようになりました。</li>
<li>以下のAPIメソッドが移動しました。<ul>
<li><code>Entity::registerEntity()</code> -&gt; <code>EntityFactory::register()</code></li>
</ul>
</li>
<li>以下のクラスはコンストラクタが変更されました。<ul>
<li>すべての発射物の子クラスは現在では<code>?Entity $thrower</code>パラメータを必要とします。</li>
<li><code>Arrow-&gt;__construct()</code>は現在では<code>bool $critical</code> パラメータを必要とします。</li>
<li><code>ExperienceOrb-&gt;__construct()</code>は現在では<code>int $xpValue</code>パラメータを必要とします。</li>
<li><code>FallingBlock-&gt;__construct()</code>は現在では<code>Block $block</code>パラメータを必要とします。</li>
<li><code>ItemEntity-&gt;__construct()</code>は現在では<code>Item $item</code>パラメータを必要とします。</li>
<li><code>Painting-&gt;__construct()</code>は現在では<code>PaintingMotive $motive</code>を必要とします。</li>
<li><code>SplashPotion-&gt;__construct()</code>は現在では<code>int $potionId</code>を必要とします。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Entity::createBaseNBT()</code>: <code>new YourEntity</code>と適切なAPIメソッドが利用されるべきです。</li>
<li><code>Entity-&gt;getSaveId()</code></li>
<li><code>Entity::getKnownEntityTypes()</code></li>
<li><code>Entity::createEntity()</code>: <code>new YourEntity</code>をかわりに利用してください。 </li>
</ul>
</li>
</ul>
<h5 id="api4-api4changelogs-_15">やりかけ エンティティのネットワークメタデータの削除</h5>
<ul>
<li>定数に関するすべてのネットワークメタデータは<code>Entity</code>クラスから削除され、プロトコル層へ移動されました。これはネットワークメタデータをAPIから全体的に削除することを意図していますが、完了はしていません。<ul>
<li>定数<code>Entity::DATA_FLAG_*</code>は<code>pocketmine\network\mcpe\protocol\types\entity\EntityMetadataFlags</code>に移動されました。</li>
<li>定数<code>Entity::DATA_TYPE_*</code>は<code>pocketmine\network\mcpe\protocol\types\entity\EntityMetadataTypes</code>に移動されました。</li>
<li>定数<code>Entity::DATA_*</code>は<code>pocketmine\network\mcpe\protocol\types\entity\EntityMetadataProperties</code>に移動されました。</li>
</ul>
</li>
<li><code>DataPropertyManager</code>は 名前空間<code>pocketmine\network\mcpe\protocol\types\entity</code>に移動され、したがってAPIの一部ではないものとして扱われます。</li>
<li>導入された内部の<code>Entity</code>は<code>syncNetworkData()</code>をフックします。この関数はエンティティのプロパティをエンティティはエンティティのネットワークデータセット同期することが期待されます。</li>
<li>内部のエンティティのプロパティを保存するためのネットワークメタデータセットの内部利用は削除されました。エンティティは現在では正規のクラスプロパティを使用し、ネットワークデータセットを同期することが期待されます。</li>
<li><code>Entity-&gt;propertyManager</code>は<code>Entity-&gt;networkProperties</code>にリネームされました。</li>
<li><code>Entity-&gt;getDataPropertyManager()</code>は<code>Entity-&gt;getNetworkProperties()</code>にリネームされました。</li>
</ul>
<h4 id="api4-api4changelogs-event">Event</h4>
<h5 id="api4-api4changelogs-listener">内部イベントシステムにおける<code>Listener</code>依存の排除</h5>
<ul>
<li>内部イベント処理システムは<code>Listener</code>オブジェクトに依存しなくなりました。ハンドラーになるための標準要求さえ満たせば任意のクロージャーが利用できます。<ul>
<li>この変更により、イベントハンドラーの呼び出し性能が15%程改善されます。プラグインが行っていることは何も含まれません。</li>
<li>以下のクラスが削除されました。<ul>
<li><code>pocketmine\plugin\EventExecutor</code></li>
<li><code>pocketmine\plugin\MethodEventExecutor</code></li>
</ul>
</li>
<li><code>RegisteredListener-&gt;__construct()</code>は先頭のパラメータとして<code>Listener, EventExecutor</code>の代わりに<code>Closure</code>を必要とします。</li>
<li><code>RegisteredListener-&gt;getListener()</code>は削除されました。</li>
</ul>
</li>
</ul>
<h5 id="api4-api4changelogs-_16">デフォルトのキャンセルハンドリングの振る舞いの変化</h5>
<ul>
<li>ハンドラー関数は<strong>デフォルトではキャンセルされたイベントを受け取らなくなります</strong>。 これは<strong>静かに後方互換性を損なうもの</strong>であり、すなわち直接エラーを吐くことはなくともバグを引き起こす可能性があります。</li>
<li><code>@ignoreCancelled</code>は無視されるようになりました。</li>
<li><code>@handleCancelled</code>が追加されました。これを用いるとキャンセルされたイベントを <em>受け取る</em> ことができるようになります。(<code>@ignoreCancelled</code>の反対です)</li>
</ul>
<h5 id="api4-api4changelogs-playerpreloginevent"><code>PlayerPreLoginEvent</code>の変更</h5>
<ul>
<li><code>Player</code>オブジェクトはログインのこのフェーズでは存在しなくなりました。代わりに<code>PlayerInfo</code>オブジェクトが接続情報とともに与えられます。</li>
<li>Ban、サーバーの満員、ホワイトリストの確認は<code>PlayerPreLoginEvent</code>に一元化されます。もはやこの手の切断をハンドルするために<code>PlayerKickEvent</code>に介入する必要はなくなるとともに、介入することはできなくなりました。<ul>
<li>複数のキック理由を使用すると、他にプレイヤーを切断する理由があって内一つが除外されたときにもプレイヤーを確実に切断することができます。例えばあるプレイヤーがBanされていてサーバーが満員であったとすると、Banフラグを除外してもサーバーが満員であることからプレイヤーはそれでも切断されます。</li>
<li>プラグインはカスタムのキック理由をセットできます。どの理由も絶対的な優先度を持ちます。</li>
<li>もし複数のフラグがセットされていた場合、キックメッセージには最も優先度が高いものが表示されます。優先度(このスナップショットにおいて)は下記の順に続きます。<ul>
<li>カスタム (最優先)</li>
<li>満員</li>
<li>ホワイトリスト</li>
<li>Ban</li>
</ul>
</li>
</ul>
</li>
<li><code>PlayerPreLoginEvent::KICK_REASON_PRIORITY</code>定数は高いほうが先にくるキック理由の優先度のリストを保持します。</li>
<li>以下の定数が追加されました<ul>
<li><code>PlayerPreLoginEvent::KICK_REASON_PLUGIN</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_SERVER_FULL</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_SERVER_WHITELISTED</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_BANNED</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_PRIORITY</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;clearAllKickReasons()</code></li>
<li><code>PlayerPreLoginEvent-&gt;clearKickReason()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getFinalKickMessage()</code>: 現在の理由リストでプレイヤーに表示されるメッセージ</li>
<li><code>PlayerPreLoginEvent-&gt;getIp()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getKickReasons()</code>: キック理由を示すフラグの配列, 参加できる時には空</li>
<li><code>PlayerPreLoginEvent-&gt;getPlayerInfo()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getPort()</code></li>
<li><code>PlayerPreLoginEvent-&gt;isAllowed()</code></li>
<li><code>PlayerPreLoginEvent-&gt;isAuthRequired()</code>: XBL認証が強制されているか</li>
<li><code>PlayerPreLoginEvent-&gt;isKickReasonSet()</code></li>
<li><code>PlayerPreLoginEvent-&gt;setAuthRequired()</code></li>
<li><code>PlayerPreLoginEvent-&gt;setKickReason()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは変更されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;getKickMessage()</code>は現在ではシグネチャ<code>getKickMessage(int $flag) : ?string</code>を持ちます。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;setKickMessage()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getPlayer()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは移動/リネームされました。<ul>
<li><code>InventoryPickupItemEvent-&gt;getItem()</code> -&gt; <code>InventoryPickupItemEvent-&gt;getItemEntity()</code></li>
</ul>
</li>
</ul>
<h5 id="api4-api4changelogs-_17">その他の変更</h5>
<ul>
<li>イベントの間にプレイヤーが切断されてもサーバーはクラッシュしなくなりました。(それでも他の副作用を引き起こす可能性があります)</li>
<li><code>PlayerKickEvent</code>は最初のログインシークエンスが完了する以前に発生した切断では着火されなくなりました。(例 リソースパックのダウンロード完了時)</li>
<li>キャンセル可能なイベントはインターフェースの要件を満たすために必要なキャンセル可能なコンポーネントを得るための<code>CancellableTrait</code>を実装する必要があります。<code>Event</code>はこれらのメソッドをスタブを持たなくなりました。</li>
<li><code>PlayerInteractEvent</code>はプレイヤーがアイテムをアクティベートしたときに着火されなくなりました。これは古くからの問題であった<code>PlayerInteractEvent</code>が一回触った時にも繰り返し発火されてしまう問題を修正します。以下の定数は削除されました。<ul>
<li><code>PlayerInteractEvent::LEFT_CLICK_AIR</code></li>
<li><code>PlayerInteractEvent::RIGHT_CLICK_AIR</code></li>
<li><code>PlayerInteractEvent::PHYSICAL</code></li>
</ul>
</li>
<li>以下のイベントが追加されます。<ul>
<li><code>PlayerEntityInteractEvent</code>: プレイヤーがエンティティを右クリック(スマホでは長押し)した時のイベント</li>
<li><code>PlayerItemUseEvent</code>: プレイヤーが持っているアイテムをアクティベートした時のイベント, 例えば雪玉を投げるなど。</li>
<li><code>BlockTeleportEvent</code>: ブロックがテレポートした時のイベント、例えばエンドラの卵が攻撃されたときなど。</li>
<li><code>PlayerDisplayNameChangeEvent</code></li>
<li><code>EntityItemPickupEvent</code>: プレイヤーやエンティティが落ちているアイテム(か矢)を拾った時のイベント。 <code>InventoryPickupItemEvent</code>と<code>InventoryPickupArrowEvent</code>の置き換え<ul>
<li>置き換え前とは違って、アイテムが入るインベントリを変更することができます。</li>
<li>もし入るインベントリを<code>null</code>にすると、アイテムは破棄されます。これはインベントリが満杯の状態でクリエイティブのプレイヤーが拾うときに見られる動作です。</li>
</ul>
</li>
<li><code>EntityTrampleFarmlandEvent</code>: 農地上でmobやプレイヤーがジャンプをして土に変化させるときのイベント。</li>
<li><code>StructureGrowEvent</code>: 木や竹、その他の複数ブロックの苗木構造物が成長するときに呼ばれます。</li>
</ul>
</li>
<li>以下のイベントは削除されました。<ul>
<li><code>EntityArmorChangeEvent</code></li>
<li><code>EntityInventoryChangeEvent</code></li>
<li><code>EntityLevelChangeEvent</code> - <code>EntityTeleportEvent</code>にてワールドの確認をすることで代用してください。</li>
<li><code>InventoryPickupItemEvent</code> - <code>EntityItemPickupEvent</code>を代わりに使用してください。</li>
<li><code>InventoryPickupArrowEvent</code> - <code>EntityItemPickupEvent</code>を代わり使用してください。</li>
<li><code>NetworkInterfaceCrashEvent</code></li>
<li><code>PlayerCheatEvent</code></li>
<li><code>PlayerIllegalMoveEvent</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>EntityDeathEvent-&gt;getXpDropAmount()</code></li>
<li><code>EntityDeathEvent-&gt;setXpDropAmount()</code></li>
<li><code>PlayerDeathEvent-&gt;getXpDropAmount()</code></li>
<li><code>PlayerDeathEvent-&gt;setXpDropAmount()</code></li>
</ul>
</li>
<li>以下のメソッドは削除されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;getPlayer()</code></li>
<li><code>Cancellable-&gt;setCancelled()</code>: これにより<code>Cancellable</code>実装はそのイベント特有のキャンセル機構を実装できるようになりました。例えば<code>PlayerPreLoginEvent</code>における複雑な機構などです。</li>
</ul>
</li>
<li>以下のAPIメソッドは移動されました。<ul>
<li><code>Event-&gt;isCancelled()</code> -&gt; <code>CancellableTrait-&gt;isCancelled()</code>: これはクラスが<code>Cancellable</code>を実装していなかった場合に<code>BadMethodCallException</code>を投げるスタブでした。これは現在ではキャンセル不可能なイベントでは単に使えなくなっています。</li>
<li><code>Event-&gt;setCancelled()</code>は<code>cancel()</code>と<code>uncancel()</code>に分割され、<code>CancellableTrait</code>に移動しました。</li>
<li><code>HandlerList::unregisterAll()</code> -&gt; <code>HandlerListManager-&gt;unregisterAll()</code></li>
<li><code>HandlerList::getHandlerListFor()</code> -&gt; <code>HandlerListManager-&gt;getListFor()</code></li>
<li><code>HandlerList::getHandlerLists()</code> -&gt; <code>HandlerListManager-&gt;getAll()</code></li>
</ul>
</li>
<li>以下のクラスは移動しました。<ul>
<li><code>pocketmine\plugin\RegisteredListener</code> -&gt; <code>pocketmine\event\RegisteredListener</code></li>
</ul>
</li>
</ul></section><h1 class='nav-section-title-end'>Ended: API4</h1><h1 class='nav-section-title'>サーバー構築</h1><section class="print-page" id="%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e6%a7%8b%e7%af%89-index"><h1 id="%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e6%a7%8b%e7%af%89-index-_1">サーバー構築</h1>
<p>ここではサーバー構築について記述します
API4.0.0(ベータ版)での構築は<a href="#%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e6%a7%8b%e7%af%89-build-in-api4">API4.0.0での構築</a>を参照してください</p></section><section class="print-page" id="%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e6%a7%8b%e7%af%89-build-in-api4"><h1 id="%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e6%a7%8b%e7%af%89-build-in-api4-api4">API4でのサーバー構築</h1>
<p>🚧</p></section><h1 class='nav-section-title-end'>Ended: サーバー構築</h1><h1 class='nav-section-title'>単項記事</h1><h2 class='nav-section-title'>Poggit</h1><section class="print-page" id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-poggit"><h1 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-poggit-poggit">Poggit</h1>
<p>PocketMineの公式プラグインレポジトリです。
ここにあるプラグインは以下の二つに分けられます。</p>
<ul>
<li>
<p><strong>Releases</strong> Poggitスタッフに承認されたプラグインがダウンロードでき、評価をつけることもできます。</p>
</li>
<li>
<p><strong>Dev</strong> 開発中のプラグインがダウンロードできます。動作の確認がされているとは限りません。</p>
</li>
</ul>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-poggit-_1">使い方</h2>
<!-- 画像をつける -->
<p>ReleasesやDevタブからプラグインを探すことができます。
Relesesでは初期状態ではすべてのプラグインが表示されていますが<code>All Caregories</code>となっているプルダウンメニューから自分の探したいジャンル、<code>All API Versions</code>となっているメニューから対応するバージョンを絞って探すことができます。</p></section><section class="print-page" id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion"><h1 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion">Virion</h1>
<p>Poggit Virion(以下Virion)はPocketMineプラグイン専用のPHPライブラリです。
このドキュメントでは、Virionの開発と使用についてのワークフローについての情報を提供します。</p>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion_1">Virionの目的</h2>
<p>ソフトウェア開発においてライブラリは素晴らしいものですが、複数のプラグインが同じライブラリを使用する場合、同じPHPランタイムで実行されるために間違ったバージョンのライブラリが使用される可能性があります。Virionフレームワークでは、クラスをシェーディング(名前空間の操作)することでこの問題を解決することを目指しています。</p>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-_1">前置き</h2>
<p>Virionはプラグインや他のVirionによって使用されます。
このドキュメントでは、<code>Virionユーザ</code>は、Virionを使用するプラグインまたはVirionを指します。</p>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-_2">ワークフロー</h2>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion_2">Virionの開発</h3>
<p>Virionはメインクラスを含む必要はありませんが、virion が宣言するすべてのシンボル (クラス・インターフェース・trait・名前空間関数・名前空間定数) は、<strong>Antigen</strong>と呼ばれるVirionの名前空間、またはAntigenのサブ名前空間の下になければなりません。
Antigenはビリオンに固有のものでなければなりません。
他のVirionやプラグインは、Antigenの名前空間またはその下位の名前空間の下でシンボルを宣言することはできません。</p>
<p>名前空間内に置くことができない他の名前付きグローバルリソースを登録する場合、その名前は、Virionのランタイム名前空間に依存するか、Virionユーザが提供する文字列に依存する必要があります。
例えば、VirionがAsyncTaskスレッドストアを使用する場合、<code>AsyncTask::saveToThreadStore()</code>に渡されるキーは<strong>クラスの構文上の名前空間の参照 (<a href="#%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-構文的参照">構文的参照</a>) から生成されるか、Virionユーザから渡された値から生成されなければなりません</strong>。
stream_wrapper_register()`も同様のケースで、プロトコル名Virionによってハードコードされてはなりません。</p>
<p>Virionフレームワークには、<code>PSR-0</code>のソースファイルとVirionのマニフェストファイル <code>virion.yml</code> が含まれています。
<code>virion.yml</code>には以下の属性が含まれます。</p>
<table>
<thead>
<tr>
<th align="center">名前</th>
<th align="center">説明</th>
<th align="center">例</th>
<th align="center">必須/任意</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>name</code></td>
<td align="center">現在は使用されていませんが、Poggitのプロジェクト名と一致する必要があります。</td>
<td align="center"><code>libasynql</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>version</code></td>
<td align="center">セマンティック・バージョニングを用いたVirionのバージョン</td>
<td align="center"><code>0.1.0-beta</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>antigen</code></td>
<td align="center">Antigen(名前空間)</td>
<td align="center"><code>poggit\libasynql</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>api</code></td>
<td align="center">このVirionが使用できる<strong>唯一</strong>のPocketMine APIのバージョンです。plugin.yml の<code>api</code>と同じシステムを使用します。</td>
<td align="center"><code>[1.4.0, 2.0.0, 3.0.0-ALPHA1]</code></td>
<td align="center"><code>api</code>か<code>php</code>のどちらか</td>
</tr>
<tr>
<td align="center"><code>php</code></td>
<td align="center">このVirionが使用できる<strong>唯一</strong>の PHP バージョンです。plugin.ymlの<code>api</code> と同様のシステムを使用します。</td>
<td align="center"><code>[5.6, 7.0]</code></td>
<td align="center"><code>api</code>か<code>php</code>のどちらか</td>
</tr>
<tr>
<td align="center"><code>authors</code></td>
<td align="center">製作者名。文字列かリストが指定できます。</td>
<td align="center"><code>[SOFe, PEMapModder]</code></td>
<td align="center">任意</td>
</tr>
<tr>
<td align="center"><code>description</code></td>
<td align="center">説明文</td>
<td align="center"><code>Simple asynchronous SQL access</code></td>
<td align="center">任意</td>
</tr>
</tbody>
</table>
<p>異なるプラグインで使用されている同じVirionが相互に作用してはいけません。</p>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion_3">Virionユーザの開発</h3>
<p>virion ユーザーは、virion によって宣言されたシンボルが正常にロードされることを前提に開発することができます。ただし、これらのシンボルへのすべての参照は、<a href="#%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-構文的参照">構文的</a>でなければなりません。</p>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion_4">Virionやプラグインのテスト</h3>
<p>Virion用テスターの役割を果たすプラグインを作ることが推奨されます。</p>
<p>Poggitは<a href="https://poggit.pmmp.io/p/DEVirion">DEVirion</a>を提供しています。詳しい使い方はPoggitのリリースページにあるプラグインの説明を参照してください。
このプラグインを使うと、Phar形式またはフォルダ形式のVirionまたはプラグインでサーバーを動かすことができます。</p>
<p><strong>デバッグ以外の理由でDEVirionを使用しないでください</strong>。
DEVirionはvirionのクラスを影で支えているわけではないので、DEVirionを使った複数のプラグインがあっても互換性の問題が発生し、virionフレームワークの意味がなくなってしまいます。</p>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-poggitvirion">PoggitでVirionをビルドする</h3>
<p>Virionプロジェクトは、プラグインプロジェクトと同様にリポジトリの<code>.poggit.yml</code>で宣言することができますが、プロジェクト属性が 2 つ追加されます。</p>
<div class="highlight"><pre><span></span><code><span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">library</span>
<span class="nt">model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">virion</span>
</code></pre></div>
<p>例:</p>
<div class="highlight"><pre><span></span><code><span class="nt">projects</span><span class="p">:</span>
    <span class="nt">libasynql</span><span class="p">:</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">path/to/libasynql</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">library</span>
        <span class="nt">model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">virion</span>
</code></pre></div>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion_5">ローカルでVirionをビルドする</h3>
<p>Virionをローカルで直接コンパイルする公式ツールは作成されていませんが、ビルドスクリプトは簡単に作成することができます。</p>
<p>基本的にVirionはプラグインと同じフォーマットですが、4つの違いがあります。
- <code>plugin.yml</code>が<code>virion.yml</code>になります。
- <code>resources</code> はサポートされていません (将来的に追加される可能性があります)。
- <code>virion.php</code>というファイルと、<code>virion_stub.php</code>というファイルがpharに含まれている必要があります。これらのファイルは、<a href="https://github.com/poggit/poggit/tree/beta/assets/php/"></a>からダウンロードすることができます。
        - <code>virion_stub.php</code>はビルド用のCLIを提供します。
        - <code>virion.php</code>には、実際にVirionを注入するコードが含まれています。
- pharのスタブは<code>virion.php</code>を直接読み込む必要があります。以下は有効なスタブの例です。</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">require</span> <span class="s2">&quot;phar://&quot;</span> <span class="o">.</span> <span class="no">__FILE__</span> <span class="o">.</span> <span class="s2">&quot;/virion_stub.php&quot;</span><span class="p">;</span> <span class="nx">__HALT_COMPILER</span><span class="p">();</span>
</code></pre></div>
<p><a href="https://github.com/poggit/poggit/blob/d587ecf3891270bd37940bf5640fca1eb7e374ad/src/poggit/ci/builder/PoggitVirionBuilder.php?utf8=%E2%9C%93#L50-L52">参考</a></p>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-poggitvirion_1">PoggitでVirionユーザをビルドする</h3>
<p>Virionユーザ(Virionを使用するプラグインやVirion本体)は、<code>.poggit.yml</code>で使用するVirionを宣言することができ、プラグインのビルド時にPoggitが自動的にVirionを注入します。Virionは、プラグインプロジェクトの<code>libs</code>属性でリストアップできます。利用する各Virionの宣言は下記の属性を含みます。</p>
<table>
<thead>
<tr>
<th align="center">名前</th>
<th align="center">説明</th>
<th align="center">形式・例</th>
<th align="center">必須/任意</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>format</code></td>
<td align="center">ライブラリのフォーマット</td>
<td align="center"><code>virion</code> (現在この値のみ選択可能)</td>
<td align="center">任意 (デフォルト：<code>virion</code>)</td>
</tr>
<tr>
<td align="center"><code>vendor</code></td>
<td align="center">Virionのインポート元</td>
<td align="center"><code>poggit-project</code> または <code>raw</code></td>
<td align="center">任意 (デフォルト：<code>poggit-project</code>)</td>
</tr>
<tr>
<td align="center"><code>src</code> (<code>vendor</code>属性で<code>poggit-project</code>を選択した場合)</td>
<td align="center">Poggitプロジェクトのフルパス</td>
<td align="center"><code>/projectName</code> (同じリポジトリのプロジェクト) OR <code>repoOwner/repoName/projectName</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>src</code> (<code>vendor</code>属性で<code>raw</code>)を選択した場合</td>
<td align="center">ダウンロード先URL(HTTP/HTTPS)、またはプロジェクトからの相対パス</td>
<td align="center"><code>https://example.com/virion.phar</code> または <code>libs/virion.phar</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>version</code> (<code>vendor: poggit-project</code>)</td>
<td align="center"><a href="https://getcomposer.org/doc/articles/versions.md">セマンティックバージョニング</a>で指定</td>
<td align="center"><code>^1.0</code></td>
<td align="center"><code>vender</code>属性で<code>poggit-project</code>を指定した場合のみ必須</td>
</tr>
<tr>
<td align="center"><code>shade</code></td>
<td align="center">シェーディングストラテジ</td>
<td align="center"><code>syntax</code> または <code>single</code> または <code>double</code></td>
<td align="center">任意 (デフォルト：<code>syntax</code>)</td>
</tr>
<tr>
<td align="center"><code>branch</code> (<code>vendor</code>属性で<code>poggit-project</code>を選択した場合)</td>
<td align="center">ブランチの指定</td>
<td align="center"><code>ブランチ名</code> または <code>:default</code>(デフォルトブランチ) または <code>*</code>/<code>%</code>(全てのブランチ)</td>
<td align="center">任意(デフォルト：<code>:default</code>)</td>
</tr>
<tr>
<td align="center"><code>epitope</code></td>
<td align="center">追加の名前空間</td>
<td align="center"><code>.random</code>(ランダム) または <code>.sha</code>(ハッシュ) または <code>.none</code> または <code>任意の名前空間</code></td>
<td align="center">任意 (デフォルト：<code>libs</code>)</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong></p>
<p>セキュリティ上の理由から、Poggitでのビルドではローカルのvirion.phpを無視し、常に最新のvirion.phpを使用します。</p>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-virion_6">ローカルでVirionユーザをコンパイルする</h3>
<p>ビルドされたVirionには、<code>virion_stub.php</code>および<code>virion.php</code>ファイルが含まれている必要があります。これらのファイルはVirionをVirionユーザに注入するためのCLIを提供します。</p>
<p>基本的な使い方：</p>
<div class="highlight"><pre><span></span><code>php used_virion.phar virion_user.phar <span class="si">${</span><span class="nv">ANTIBODY_PREFIX</span><span class="si">}</span>
</code></pre></div>
<p><code>${ANTIBODY_PREFIX}</code>はビリオンユーザーのメインの名前空間（プラグインの場合はメインクラスの名前空間、ビリオンの場合はAntigenの名前空間）でなければなりません。バックスラッシュ等はエスケープする必要があります。</p>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-cli">CLI機能の拡張</h2>
<p>Virionは、プロジェクトルートに<code>cli-map.json</code>というファイルを追加することで、カスタムコマンドを追加することができます。このファイルには、コマンド名と実行ファイルをマッピングしたオブジェクトを記述します。</p>
<p><code>cli-map.json</code>が存在する場合、Poggitはsrcディレクトリのオートローダーのための<code>cli-autoload.php</code>を作成します。</p>
<p>コマンド名は<code>.phar</code>で終わらないようにしてください。</p>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-_3">制限事項</h2>
<ul>
<li>Virionユーザは、自分のAPIでVirionのクラスを公開してはいけません。もしそのようなオブジェクトをAPIで公開しなければならない場合は、Virionユーザが宣言したインターフェースでラップしなければなりません。</li>
</ul>
<h2 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-_4">付録</h2>
<h3 id="%e5%8d%98%e9%a0%85%e8%a8%98%e4%ba%8b-poggit-virion-_5">構文的参照</h3>
<p>基本的に、構文参照は以下のように定義されます。</p>
<blockquote>
<p>A <code>T_NAMESPACE</code> (<code>namespace</code>), <code>T_USE</code> (<code>use</code>) or <code>T_NS_SEPARATOR</code> (<code>\</code>) token, or <code>T_USE</code> + <code>T_FUNCTION</code> (<code>use function</code>) or <code>T_USE</code> + <code>T_CONST</code> (<code>use const</code>), followed by a consecutive series of <code>T_STRING</code> (a non-keyword set of characters, i.e. part of the namespace) and <code>T_NS_SEPARATOR</code> (<code>\</code>).</p>
</blockquote>
<p>Virionの<code>クラス</code>・<code>関数</code>・<code>定数</code>の名前空間を参照する際には、以下のような形式で<strong>のみ</strong>行うことができます。</p>
<p><div class="highlight"><pre><span></span><code><span class="x">namespace name\space;</span>
<span class="x">use name\space\Clazz;</span>
<span class="x">use function name\space\func;</span>
<span class="x">use const name\space\CONSTANT;</span>
<span class="x">\name\space\Clazz::method();</span>
</code></pre></div>
<code>poggit\libasynql</code>というAntigenのVirionの例：</p>
<div class="highlight"><pre><span></span><code><span class="x">// syntactic reference</span>
<span class="x">use poggit\libasynql\SqlResult as Result; </span>
<span class="x">$result = new Result;</span>

<span class="x">// syntactic reference</span>
<span class="x">$result = new \poggit\libasynql\SqlResult;</span>

<span class="x">// syntactic reference</span>
<span class="x">use poggit\libasynql\SqlResult as Result;</span>
<span class="x">$class = new \ReflectionClass(Result::class);</span>

<span class="x">// syntactic reference</span>
<span class="x">$class = new \ReflectionClass(\poggit\libasynql\SqlResult::class);</span>

<span class="x">// syntactic references, from the scope of a class method in poggit\libasynql\SqlResult</span>
<span class="x">$class = new \ReflectionClass(self::class);</span>
<span class="x">$class = new \ReflectionClass(static::class);</span>
<span class="x">$class = new \ReflectionClass(get_class());</span>
<span class="x">$class = new \ReflectionClass(__CLASS__);</span>
<span class="x">$class = new \ReflectionClass(__NAMESPACE__ . &quot;\\SqlResult&quot;); // a boundary case barely acceptable</span>

<span class="x">// non-syntactic reference</span>
<span class="x">$class = new \ReflectionClass(&quot;poggit\\libasynql\\SqlResult&quot;);</span>
<span class="x">$class = new \ReflectionClass(&#39;poggit\libasynql\SqlResult&#39;);</span>
</code></pre></div>
<p>名前空間からの相対参照はシェーディングされないため、<strong>Virionの名前空間への相対参照は使用しないでください</strong>。例えば、Virion のAntigenが<code>namespace poggit\libasynql</code>である場合、Virionユーザでは<code>namespace poggit</code>で始まるコードを書いてはいけません。</p></section><h1 class='nav-section-title-end'>Ended: Poggit</h1><h1 class='nav-section-title-end'>Ended: 単項記事</h1></div>
                
              

  
    <div class="md-source-date">
      <small>
          Authors: <span class='git-page-authors git-authors'><a href='mailto:famima65536@gmail.com'>famima65536</a> (4.8%), <a href='mailto:25810983+UramnOIL@users.noreply.github.com'>うらむんオイル</a> (95.2%)</span>
      </small>
    </div>
  

              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
<script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    

<script src="https://unpkg.com/iframe-worker/polyfill"></script>
<script src="search/search_index.js"></script>


    
      <script src="assets/javascripts/bundle.756773cc.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="js/arithmatex.config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>