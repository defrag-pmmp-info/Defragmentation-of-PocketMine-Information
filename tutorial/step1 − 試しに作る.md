# 実際にサーバーを立ててみよう
さて、実際にサーバーを作って遊んでみましょう。
完成形はこんなかんじ。
![完成図](/image/1FCB70B6-D6D5-48FF-8E59-8694F1D5F3FC.gif)

誰ですかこんなひどい絵を描いたのは。

それはさておき、左側から準備していきます。

## サーバーソフトの準備
[サーバーの立て方](/building/README.md)から見ることができます。  
また、Windowsであれば、ねらひかだ氏がインストーラーを開発しています。
[このページ](https://github.com/Nerahikada/PocketMine-MP_Installer/releases/latest)のPocketMine-MPなんとかかんとか.exeをダウンロードして実行すればインストールしてくれます。
<!-- ここ、不親切だけどどうしようか -->
<!-- TODO
## Bedrock Dedicated Serverでのサーバーの立て方 -->

## 試しに入ってみよう
それでは、試しにサーバーに入ってみましょう。

PMMPを起動したときに「あなたの内部IPは〇〇.〇〇.〇〇.〇〇です。外部IPは〇〇.〇〇.〇〇.〇〇です」と言われたと思います。(もし忘れちゃった場合は「IPチェック」とかで検索。)
これは、サーバーの住所に当たる場所です。なので、これをMinecraftのサーバー追加のところに入れれば、サーバーの場所がわかるのでサーバーに参加できます。

今回は自宅サーバー(を想定)なので内部IPの方をMinecraftのサーバー追加欄のIPアドレスに入力します。ポートはそのまま。

入れましたか？うまく行かない場合は聞きましょう。

### Windows10版でサーバー機と同じPCでサーバーに入る
自分自身にアクセスすることになるのでちょっと小細工が必要です。
ループバックを有効にします。
検索にPowershellと入力、開いて

```powershell
CheckNetIsolation LoopbackExempt -a -n="Microsoft.MinecraftUWP_8wekyb3d8bbwe"
```
を入力し、Enterを押せばMinecraftがループバックできるようになる、はずです。

参考記事: <https://yomi-note.com/games/minectaft/477/> on 2021/11/13

----
次は、同じネットワークに繋いでいないお友達も参加できるようにしてみましょう。


## サーバーに外部から入れるようにする
そもそも、今はセキュリティとかの関係もあって、ルーターさん(ネットワーク用の機械)などは面識のない怪しい通信は追い返し、必要な通信だけを通す、という仕組みが備わっています。  
しかしながら、サーバーというのはルーターさんが知らない人からの通信がやってきます。なので、ルーターさんには「Minecraftの通信が来たら俺目当てだから俺に回しといてくれや」という指示をしておく必要があります。    

さて、そのための機能が**ポートフォワーディング**(しばしば**ポート開放**)というものです。
ポートフォワーディングというのは外部であるインターネットから来た通信をサーバーなどの機械に転送する機能です。

自宅サーバーの場合UPnPを利用したり、手動でルーターの設定をいじることでポートフォワーディングすることができます。ただし、ネットワークの問題でできないこともあります。
設定方法は使っているルーターの種類によってまちまちなので「ルーターの名前 ポート開放」とかでgoogleで検索しましょう。よほどマイナーな機械じゃない限り使えるサイトがあるはず。

設定が終われば、Minecraftのサーバー追加画面にIPを打ち込んで誰でもサーバーに入ることができます。

!!! warning
 - ポートフォワーディングはネットワークに穴をあけるような事です。具体的に言うと郵便物のために窓全開にするイメージ。なので、郵便物のふりをした爆弾とかが送られる可能性がなくはないです。むやみにしないほうがいいです。
 - IPアドレスを公開するのは、「我が家に遊びに来てね！住所は──」って叫ぶのと大して変わりません。信用できる人だけに教える、セキュリティガチガチにするなどの対策が大事です。
   - ちなみに、公開されてるサーバーは他のサーバーを中継させて被害を減らす「身代わり」を使っているらしいです


### tips
「あれ？サーバーIPのとこに入力するのってexample.comみたいな形式じゃなかったっけ？」と疑問に思った方もいると思います。

実は、example.comとかは〇〇.〇〇.〇〇.〇〇の形式の「あだ名」です。webサイトとかもですが、アドレスにいちいち数字を打ち込むのは分かりづらいので、こんな仕組みが用意されています。
