# API4

## インストールについて
現在(2021.10.9) API4.0.0はベータ段階であり、安定版ではありません。テスト目的でのみ使用してください。
インストール方法は以下のページを参考にしてください。

- <https://qiita.com/bbo51dog/items/414b6270682f1a028bfe> (Ubuntu)
- [API4でのサーバー構築](/building/build-in-api4)

## 変更点のまとめ(鯖主向け)
このセクションではAPI4での変更点をいくつかまとめて記述します。全訳は[API4 Changelogs全訳](/api4/changelogs)より見られます。
### 一般
- セキュリティ・荒らし対策に関する変更点
    - プラグインのホワイトリスト化・ブラックリスト化ができるようになります。
    - RCONやスポーンプロテクションはプラグインに代わりました。
    - プレイヤーのアンチ移動チートがなくなります。
- サーバーの動作に関する変更
    - チャンク関連のPHP拡張が変更されました。binの変更が必要です。
    - リスポーン時のバグが修正されました。
    - 
### コマンド
- `/reload`コマンドが無くなりました
- `/effect`, `/enchant`コマンドは数字のIDは受け付けなくなり、英語のIDのみでしか使えません。
- `/gc`,`/status`,`/op`,`/deop`コマンドの表示が日本語化されるようになりました。

### 設定 (`pocketmine.yml`)
- `pocketmine.yml`におけるワールドプリセットのキーが`generator`から`preset`に変更されました。
- 新たなオプションが使えるようになります
    - `chunk-ticking.blocks-per-subchunk-per-tick` サボテンの成長など、ブロックアップデートの確率
    - `network.enable-encryption` pmmp<->Minecraft間のパケットを暗号化するか否か
- `chunk-ticking.light-updates`が削除されました。光処理なしにチャンクチックを進めることができなくなります。

### world関連
- 最初のワールド生成時にはスポーン生成がログに表示されるようになります。
- バージョン1.12.xまでのMinecraft Bedrockのワールドがサポートされました。本家からワールドを持ってこれます。
- 非推奨となった`leveldb`以外のワールド形式は`leveldb`に変換されます。
- 建築高さ上限は256になりました。

### パフォーマンス
- 保存方式が変わったことによりワールド保存が高速化されました。
- 爆発や光処理が軽くなりました。
- パケット圧縮が高速化されました。ネットワーク全体の性能が向上します。

### ロガーの刷新
- 多くのメッセージでプレフィックスが追加されました。
- タイムスタンプがミリ秒まで含むようになります。

### ネットワーク
- デフォルトでパケットが暗号化されるようになります。
- エラーチェックが実装されました。例外時にサーバーがクラッシュするようになります。
- `Internal server error`は削除されました。

## 開発者向け情報
### DevTools API4対応版の配布場所
poggit上でダウンロード可 <https://poggit.pmmp.io/ci/pmmp/DevTools/PocketMine-DevTools> の Build History:master により最新版がダウンロード可能