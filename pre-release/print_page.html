
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.2">
    
    
      
        <title>Print as PDF - defrag-pmmp-info/Defragmentation-of-PocketMine-Information</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.5d38496d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="css/print-site.css">
    
      <link rel="stylesheet" href="css/print-site-material.css">
    
    <script>__md_scope=new URL("/",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="index.html" title="defrag-pmmp-info/Defragmentation-of-PocketMine-Information" class="md-header__button md-logo" aria-label="defrag-pmmp-info/Defragmentation-of-PocketMine-Information" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            defrag-pmmp-info/Defragmentation-of-PocketMine-Information
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print as PDF
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="クリア" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/defrag-pmmp-info/Defragmentation-of-PocketMine-Information" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="defrag-pmmp-info/Defragmentation-of-PocketMine-Information" class="md-nav__button md-logo" aria-label="defrag-pmmp-info/Defragmentation-of-PocketMine-Information" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    defrag-pmmp-info/Defragmentation-of-PocketMine-Information
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/defrag-pmmp-info/Defragmentation-of-PocketMine-Information" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        ようこそ
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          チュートリアル
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="チュートリアル" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          チュートリアル
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorial/index.html" class="md-nav__link">
        Minecraftサーバーについて
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          サーバー構築
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="サーバー構築" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          サーバー構築
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="building/index.html" class="md-nav__link">
        サーバー構築
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="building/build-in-api4.html" class="md-nav__link">
        API4でのサーバー構築
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          プラグイン
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="プラグイン" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          プラグイン
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plugin/index.html" class="md-nav__link">
        プラグイン
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plugin/awesome-plugins.html" class="md-nav__link">
        おすすめプラグインリスト
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          プラグイン開発
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="プラグイン開発" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          プラグイン開発
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plugin-develop/index.html" class="md-nav__link">
        プラグイン開発の基本
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plugin-develop/api-versioning.html" class="md-nav__link">
        APIバージョニング: API versioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plugin-develop/development-faq.html" class="md-nav__link">
        PocketMineプラグイン開発FAQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plugin-develop/language.html" class="md-nav__link">
        多言語対応
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API4" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API4
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="api4/index.html" class="md-nav__link">
        API4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="api4/changelogs.html" class="md-nav__link">
        API4 Changelogs全訳
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          単項記事
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="単項記事" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          単項記事
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Poggit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Poggit" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Poggit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="dictionary/poggit/poggit.html" class="md-nav__link">
        Poggit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="dictionary/poggit/virion.html" class="md-nav__link">
        Virion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="link.html" class="md-nav__link">
        リンク集
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Print as PDF
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="print_page.html" class="md-nav__link md-nav__link--active">
        Print as PDF
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. ようこそ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-チュートリアル" class="md-nav__link">
    I. チュートリアル
  </a>
  
    <nav class="md-nav" aria-label="I. チュートリアル">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tutorial-index" class="md-nav__link">
    2. Minecraftサーバーについて
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-サーバー構築" class="md-nav__link">
    II. サーバー構築
  </a>
  
    <nav class="md-nav" aria-label="II. サーバー構築">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#building-index" class="md-nav__link">
    3. サーバー構築
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-build-in-api4" class="md-nav__link">
    4. API4でのサーバー構築
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-プラグイン" class="md-nav__link">
    III. プラグイン
  </a>
  
    <nav class="md-nav" aria-label="III. プラグイン">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plugin-index" class="md-nav__link">
    5. プラグイン
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-awesome-plugins" class="md-nav__link">
    6. おすすめプラグインリスト
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-プラグイン開発" class="md-nav__link">
    IV. プラグイン開発
  </a>
  
    <nav class="md-nav" aria-label="IV. プラグイン開発">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plugin-develop-index" class="md-nav__link">
    7. プラグイン開発の基本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-develop-api-versioning" class="md-nav__link">
    8. APIバージョニング: API versioning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-develop-development-faq" class="md-nav__link">
    9. PocketMineプラグイン開発FAQ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-develop-language" class="md-nav__link">
    10. 多言語対応
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-api4" class="md-nav__link">
    V. API4
  </a>
  
    <nav class="md-nav" aria-label="V. API4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api4-index" class="md-nav__link">
    11. API4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api4-changelogs" class="md-nav__link">
    12. API4 Changelogs全訳
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-単項記事" class="md-nav__link">
    VI. 単項記事
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#link" class="md-nav__link">
    13. リンク集
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. ようこそ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-チュートリアル" class="md-nav__link">
    I. チュートリアル
  </a>
  
    <nav class="md-nav" aria-label="I. チュートリアル">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tutorial-index" class="md-nav__link">
    2. Minecraftサーバーについて
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-サーバー構築" class="md-nav__link">
    II. サーバー構築
  </a>
  
    <nav class="md-nav" aria-label="II. サーバー構築">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#building-index" class="md-nav__link">
    3. サーバー構築
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-build-in-api4" class="md-nav__link">
    4. API4でのサーバー構築
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-プラグイン" class="md-nav__link">
    III. プラグイン
  </a>
  
    <nav class="md-nav" aria-label="III. プラグイン">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plugin-index" class="md-nav__link">
    5. プラグイン
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-awesome-plugins" class="md-nav__link">
    6. おすすめプラグインリスト
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-プラグイン開発" class="md-nav__link">
    IV. プラグイン開発
  </a>
  
    <nav class="md-nav" aria-label="IV. プラグイン開発">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plugin-develop-index" class="md-nav__link">
    7. プラグイン開発の基本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-develop-api-versioning" class="md-nav__link">
    8. APIバージョニング: API versioning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-develop-development-faq" class="md-nav__link">
    9. PocketMineプラグイン開発FAQ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-develop-language" class="md-nav__link">
    10. 多言語対応
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-api4" class="md-nav__link">
    V. API4
  </a>
  
    <nav class="md-nav" aria-label="V. API4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api4-index" class="md-nav__link">
    11. API4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api4-changelogs" class="md-nav__link">
    12. API4 Changelogs全訳
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-単項記事" class="md-nav__link">
    VI. 単項記事
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#link" class="md-nav__link">
    13. リンク集
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
  
                


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <div id="print-site-banner">
            <p>
    <em>This box will disappear when printing</em>
    <span style="float: right"><a href="https://timvink.github.io/mkdocs-print-site-plugin/">mkdocs-print-site-plugin</a></span>
</p>
<p>
    This page has combined all site pages into one. You can export to PDF using <b>File > Print > Save as PDF</b>.
</p>
<p>
    See also <a href="https://timvink.github.io/mkdocs-print-site-plugin/how-to/export-PDF.html">export to PDF</a> and <a href="https://timvink.github.io/mkdocs-print-site-plugin/how-to/export-HTML.html">export to standalone HTML</a>.
</p>
        </div>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Index</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-defragmentation-of-pocketmine-information">Defragmentation of PocketMine information</h1>
<p>散っているPocketMine-MPの情報収集やpmmp公式からの情報の翻訳を行い、情報をまとめて掲載します。</p>
<h2 id="index-_1">現在掲載してる情報</h2>
<ul>
<li><strong><a href="#building">サーバー構築</a></strong> API3およびAPI4でのサーバー構築について</li>
<li><strong><a href="#api4">API4</a></strong> API4での変更点や関連情報を掲載</li>
<li><strong><a href="#plugin-develop">プラグイン</a></strong> プラグイン開発情報, 現在はAPIバージョニングのみ</li>
<li><strong><a href="#dictionary">単項記事</a></strong> 現在はpoggitとvirion情報の翻訳</li>
</ul>
<h2 id="index-contribute">Contribute</h2>
<p>PRやIssueなどで足りていない情報の補完をしてもらえると助かります。Issueテンプレートを利用してください。</p>
<p><a href="https://dpmi.f5.si/">https://dpmi.f5.si/</a>からmkdocs形式で見られます。</p></section>
                        <h1 class='nav-section-title' id='section-チュートリアル'>
                            チュートリアル <a class='headerlink' href='#section-チュートリアル' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="tutorial-index"><h1 id="tutorial-index-minecraft">Minecraftサーバーについて</h1>
<p>xboxマルチプレイやRealmsと異なり、BDSやpmmpといったMinecraftサーバーソフトでは人数上限をより多くした状態でサーバーを開くことができます。</p>
<p>ただし、サーバーに人を入れるためにはサーバーソフトを起動してPCを起動させたままにする必要があります。常に起動ができない環境であれば、外部のサーバーであるVPSを利用することもできます。</p>
<h2 id="tutorial-index-_1">サーバーの種類</h2>
<p>MinecraftのBedrockサーバーを立てる場合には以下のソフトウェアが利用できます。</p>
<ul>
<li><strong>Bedrock Dedicated Server(BDS)</strong> 公式・安定・フル互換<ul>
<li>Minecraft公式によるサーバーソフトです。Minecraftに実装されたすべての機能が利用できます。</li>
<li>pmmpのプラグインは利用できません。</li>
<li>Windows/Ubuntu上で動作します。armでは動作しません。</li>
</ul>
</li>
<li><strong>PocketMine-MP(pmmp)</strong> 非公式・高機能・一部機能未実装<ul>
<li>非公式のサーバーソフトです。サーバーに追加機能を加えるプラグインやマルチワールドが利用できます。</li>
<li>Minecraft本来のすべての機能が使えるわけではありません。pm4では1.12.xまでのBedrockのワールドが利用できます。</li>
<li>Windows/Mac/Linux/Android上で動作します。</li>
</ul>
</li>
</ul>
<h2 id="tutorial-index-pocketmine-mp">PocketMine-MPでのサーバーの立て方</h2>
<p><a href="#building-readme.md">サーバーの立て方</a>から見ることができます。</p>
<!-- TODO
## Bedrock Dedicated Serverでのサーバーの立て方 -->

<h2 id="tutorial-index-_2">サーバーに外部から入れるようにする</h2>
<p>外部からサーバーを入れるためには<strong>ポートフォワーディング</strong>(しばしば<strong>ポート開放</strong>)という作業が必要になります。
ポートフォワーディングというのは外部であるインターネットから来たパケットをサーバーがある内部のネットワークに転送する機能です。</p>
<p>自宅サーバーの場合UPnPを利用したり、手動でルーターの設定をいじることでポートフォワーディングすることができます。ただし、ネットワークの問題でできないこともあります。</p>
<p>VPSの場合は大抵ポートフォワーディングを設定できる画面があるため、そこで変更することでポートフォワーディングすることができます。</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>ポートフォワーディングはネットワークに穴を開けるような行為であり、設定によっては危険を伴います。設定がどのように働くかを理解したうえで設定することを推奨します。</p>
</div>
<h2 id="tutorial-index-windows10pc">Windows10版でサーバー機と同じPCでサーバーに入る</h2>
<p>ループバックを有効にすることで入ることができます。
Powershellを開いて</p>
<p><div class="highlight"><pre><span></span><code><span class="n">CheckNetIsolation</span> <span class="n">LoopbackExempt</span> <span class="n">-a</span> <span class="n">-n</span><span class="p">=</span><span class="s2">&quot;Microsoft.MinecraftUWP_8wekyb3d8bbwe&quot;</span>
</code></pre></div>
を実行します。</p>
<p>参考記事: <a href="https://yomi-note.com/games/minectaft/477/">https://yomi-note.com/games/minectaft/477/</a> on 2021/11/13</p></section><h1 class='nav-section-title-end'>Ended: チュートリアル</h1>
                        <h1 class='nav-section-title' id='section-サーバー構築'>
                            サーバー構築 <a class='headerlink' href='#section-サーバー構築' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="building-index"><h1 id="building-index-_1">サーバー構築</h1>
<p>ここではサーバー構築について記述します
API4.0.0(ベータ版)での構築は<a href="#building-build-in-api4">API4.0.0での構築</a>を参照してください</p>
<p>このページは <a href="https://pmmp.readthedocs.io/en/rtfd/installation/requirements.html">pmmp.readthedocs.io</a>を参考にしています。</p>
<h2 id="building-index-httpsgetpmmpio-linuxmacos">https://get.pmmp.io の利用(Linux/MacOS 限定)</h2>
<p>PocketMine-MPをインストールしたいディレクトリを作成して、そのディレクトリを端末で開きます。</p>
<p><code>curl</code>または<code>wget</code>を用いてPocketMine-MPをインストールできます。
<div class="highlight"><pre><span></span><code>curl -sL https://get.pmmp.io <span class="p">|</span> bash -s -
</code></pre></div>
または
<div class="highlight"><pre><span></span><code>wget -q -O - https://get.pmmp.io <span class="p">|</span> bash -s -
</code></pre></div>
するとこのような表示が出るはずです。
<div class="highlight"><pre><span></span><code>[*] Found PocketMine-MP Final_1.5dev (build 1254) using API 1.12.0
[*] This development build was released on Sat Jun 20 09:45:04 CEST 2015
[*] Installing/updating PocketMine-MP on directory ./
[1/3] Cleaning...
[2/3] Downloading PocketMine-MP Final_1.5dev-1254 phar... done!
[3/3] Obtaining PHP: detecting if build is available...
[3/3] MacOS 64-bit PHP build available, downloading PHP_5.6.10_x86-64_MacOS.tar.gz... checking... regenerating php.ini... done
[*] Everything done! Run ./start.sh to start PocketMine-MP
</code></pre></div></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>うまく動作しなかったら手動インストールを試してみてください</p>
</div>
<h2 id="building-index-powershellwindows">PowerShellスクリプトの利用(Windows 限定)</h2>
<p>PocketMine-MPをインストールしたいディレクトリを作成して、そのディレクトリをPowerShellで開きます。
<div class="highlight"><pre><span></span><code><span class="nb">wget </span><span class="n">https</span><span class="p">://</span><span class="n">gist</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">famima65536</span><span class="p">/</span><span class="n">d1493bd3e4713f09aed2c70e428a5064</span><span class="p">/</span><span class="n">raw</span><span class="p">/</span><span class="n">0935f747077fe3454b329801a93fe30bb1b55919</span><span class="p">/</span><span class="n">install</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-OutFile</span> <span class="n">temp-install</span><span class="p">.</span><span class="n">ps1</span><span class="p">;</span> <span class="p">./</span><span class="n">temp-install</span><span class="p">.</span><span class="n">ps1</span><span class="p">;</span> <span class="nb">Remove-Item</span> <span class="n">temp-install</span><span class="p">.</span><span class="n">ps1</span>
</code></pre></div></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>うまく動作しなかったら手動インストールを試してみてください</p>
</div>
<h2 id="building-index-_2">手動インストール</h2>
<h3 id="building-index-_3">必要なファイルの準備</h3>
<p>PocketMine-MPを最低限起動するためには</p>
<ul>
<li><strong>PocketMine-MP.phar</strong> サーバーの本体 <a href="https://github.com/pmmp/PocketMine-MP/releases/latest">GitHub</a>からダウンロード可能</li>
<li><strong>PHPバイナリ</strong> サーバーを動作させるプログラム <a href="https://jenkins.pmmp.io/job/PHP-8.0-Aggregate/">Jenkins</a>からダウンロード可能</li>
<li><strong>スタート用スクリプト</strong> サーバーを起動するためのファイル いずれも「名前を付けて保存」やwget等でダウンロード可能<ul>
<li><a href="https://raw.githubusercontent.com/pmmp/PocketMine-MP/stable/start.sh">start.cmd</a> / <a href="https://raw.githubusercontent.com/pmmp/PocketMine-MP/stable/start.ps1">start.ps1</a> (Windows)</li>
<li><a href="https://raw.githubusercontent.com/pmmp/PocketMine-MP/stable/start.sh">start.sh</a> (Linux/Mac)</li>
</ul>
</li>
</ul>
<h3 id="building-index-_4">ディレクトリ配置</h3>
<p>バイナリはzip形式のため展開し、以下のようにファイルを配置します。
<div class="highlight"><pre><span></span><code>|-- bin/
|-- PocketMine-MP.phar
|-- start.cmd(またはstart.ps1)
</code></pre></div></p>
<h3 id="building-index-_5">サーバーの起動</h3>
<p>start.cmdまたはstart.ps1を実行することでサーバーが起動されます。</p></section><section class="print-page" id="building-build-in-api4"><h1 id="building-build-in-api4-api4">API4でのサーバー構築</h1>
<h2 id="building-build-in-api4-_1">警告</h2>
<p>これは安定版リリースでは<strong>ありません</strong>。予期しないバグが存在する可能性があります。</p>
<h2 id="building-build-in-api4-httpsgetpmmpio-linuxmacos">https://get.pmmp.io の利用(Linux/MacOS 限定)</h2>
<p><code>curl</code>または<code>wget</code>を用いてPocketMine-MPをインストールできます。
<div class="highlight"><pre><span></span><code>curl -sL https://get.pmmp.io <span class="p">|</span> bash -s - -v beta
</code></pre></div>
または
<div class="highlight"><pre><span></span><code>wget -q -O - https://get.pmmp.io <span class="p">|</span> bash -s - -v beta
</code></pre></div>
を実行してください。</p>
<h2 id="building-build-in-api4-_2">手動インストール</h2>
<h3 id="building-build-in-api4-_3">必要なファイルの準備</h3>
<ul>
<li><strong>PocketMine-MP.phar</strong></li>
<li><strong>PHPバイナリ(API3・API4共用)</strong> バイナリが更新されたため、Jenkinsからダウンロードするものが使用できるようになりました。</li>
<li><strong>start.cmd/start.ps1/start.sh</strong> API3のものが利用可能</li>
</ul>
<h4 id="building-build-in-api4-pocketmine-mpphar">PocketMine-MP.pharのダウンロード</h4>
<p>API4のものは現段階ではPre-releaseでありGitHubのreleasesからダウンロードできます。
<a href="https://github.com/pmmp/PocketMine-MP/releases">https://github.com/pmmp/PocketMine-MP/releases</a></p>
<h2 id="building-build-in-api4-_4">ダウンロード後</h2>
<p>これ以降は<a href="#building-readme-_2">API3の手動インストール</a>と同様の手順で進められます。</p></section><h1 class='nav-section-title-end'>Ended: サーバー構築</h1>
                        <h1 class='nav-section-title' id='section-プラグイン'>
                            プラグイン <a class='headerlink' href='#section-プラグイン' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="plugin-index"><h1 id="plugin-index-_1">プラグイン</h1>
<p>プラグインはサーバーそのものにはない機能を追加できるものです。これを用いてゲームサーバーや経済サーバーなどのシステムが構築されています。</p>
<p>公開されているプラグインは <a href="#link.md">リンク集</a>にあるpoggit[<a href="#dictionary-poggit-poggit.md">解説</a>] やフォーラムなどからダウンロードすることができます。</p>
<h2 id="plugin-index-_2">プラグインの一般的なインストール方法</h2>
<p><code>(プラグイン名).phar</code>という形式で配布されているプラグインは一般的にはサーバーがあるディレクトリの内の<code>plugins</code>ディレクトリに入れることで動作します。プラグインによっては追加で設定をすることができるものや、そもそも設定しなければ動かないものもあります。</p></section><section class="print-page" id="plugin-awesome-plugins"><h1 id="plugin-awesome-plugins-_1">おすすめプラグインリスト</h1>
<p>ここではサーバーの特性や目的に合わせたおすすめのプラグインを掲載します。</p>
<h2 id="plugin-awesome-plugins-_2">経済プラグイン</h2>
<p>お金を追加して経済概念を導入するプラグインです。プラグインによっては経済APIに対応していないものがあります。</p>
<h3 id="plugin-awesome-plugins-economyapi"><a href="https://poggit.pmmp.io/p/EconomyAPI/">EconomyAPI</a></h3>
<p>EconomyAPI系統のプラグインの核をなすプラグインです。これを入れないとほかのEconomyAPI関連プラグインは動作しません。</p>
<h4 id="plugin-awesome-plugins-economyseconomyapi">EconomyS・EconomyAPI系統</h4>
<ul>
<li><a href="https://poggit.pmmp.io/p/EconomyLand/">EconomyLand</a> お金を使って土地を購入できるようにするプラグインです。</li>
<li><a href="https://poggit.pmmp.io/p/EconomyShop/">EconomyShop</a> サーバー側でショップを作れるようになるプラグインです。 </li>
<li><a href="https://poggit.pmmp.io/p/EconomyPShop/">EconomyPShop</a> OP以外の人でもショップを開けるようにするプラグインです。<a href="https://poggit.pmmp.io/p/ItemCloud">ItemCloud</a>というプラグインを導入しないと動作しません。</li>
<li><a href="https://poggit.pmmp.io/p/ChestShop/">ChestShop</a> チェストのGUIに基づいたショップが作成できるプラグインです。</li>
</ul>
<h2 id="plugin-awesome-plugins-_3">サーバー管理系プラグイン</h2>
<p>サーバー自体の管理をできるプラグインです。バックアップ・再起動・プラグインの更新等々。</p>
<h3 id="plugin-awesome-plugins-sheep"><a href="#plugin-poggit.pmmp.io-p-sheep">Sheep</a></h3>
<p>poggit上に存在するプラグインをインストール・アンインストール・更新することができるプラグインです。
セキュリティ上の理由からコンソールからでしか実行できないようになっています。</p></section><h1 class='nav-section-title-end'>Ended: プラグイン</h1>
                        <h1 class='nav-section-title' id='section-プラグイン開発'>
                            プラグイン開発 <a class='headerlink' href='#section-プラグイン開発' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="plugin-develop-index"><h1 id="plugin-develop-index-_1">プラグイン開発の基本</h1>
<p>PocketMine-MPはPHP言語により記述されており、プラグインもPHPを使用して作成されます。</p></section><section class="print-page" id="plugin-develop-api-versioning"><h1 id="plugin-develop-api-versioning-api-api-versioning">APIバージョニング: API versioning</h1>
<p>PocketMine-MPのプラグインはどのAPIバージョンと互換性があるかを宣言する必要があります。これはプラグインをロードするかしないかを決定し、サーバーバージョンと適合しなかったときにデグレードするために用いられます。</p>
<h2 id="plugin-develop-api-versioning-api">APIバージョンシステムの説明</h2>
<p>PocketMine-MP 3.0.0現在ではAPIバージョンとサーバーバージョンは一致しています。このバージョンは<a href="https://semver.org/lang/ja/">semantic major.minor.patch version number</a>で表します。</p>
<h3 id="plugin-develop-api-versioning-_1">定義</h3>
<p>Semverは大まかには以下のように定義されます。
- メジャーバージョンアップ: 破壊的な変更 - APIに準じるプラグインが動かなくなるレベルで公開APIが変更される。
- マイナーバージョンアップ: 機能の追加やAPIを破壊しない程度での大きな変更。これはAPIの非推奨化や新しいAPI機能が追加されることも含みうるが以前のマイナーバージョン向けに作られたプラグインは依然として動作する。
- パッチバージョンアップ: 大抵バグ修正。APIの破壊やそのバージョンのものに重大な変更があってはならない。</p>
<p>PocketMine-MPでは<code>==.&gt;=.&gt;=</code>(<code>bash</code>表記では<code>eq.ge.ge</code>)という条件をAPIバージョンの比較時に用いています。つまりこれは以下のことを表します。
- メジャーバージョンは互換性を持つためには<strong>必ず一致</strong>
- サーバーのマイナーバージョンは、プラグインのマイナーバージョン<strong>以上が必須</strong>
- サーバーのパッチバージョンもまた、プラグインのパッチバージョン<strong>以上が必須</strong></p>
<p>PocketMine-MP開発者はいかなる非メージャーバージョンにおいてもプラグインとAPIの互換性がなくならないようにする努力をします。つまり、<code>3.1.1</code>を対象に書かれたプラグインは<code>3.x.y</code>でも動くはずです。ただし<code>4.0.0</code>や将来のメジャーバージョンで動く保証はありません。</p>
<h3 id="plugin-develop-api-versioning-_2">例</h3>
<table>
<thead>
<tr>
<th align="left">サーバーバージョン</th>
<th align="left">プラグインバージョン</th>
<th align="center">互換性</th>
<th align="left">理由</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">4.0.0</td>
<td align="left">3.0.0</td>
<td align="center">無し</td>
<td align="left">メジャーバージョンが異なる</td>
</tr>
<tr>
<td align="left">3.1.0</td>
<td align="left">3.0.0</td>
<td align="center">あり</td>
<td align="left">サーバーがプラグインよりも高いマイナーバージョンを持ち、互換性が保証されるため</td>
</tr>
<tr>
<td align="left">3.0.0</td>
<td align="left">3.1.0</td>
<td align="center">無し</td>
<td align="left">プラグインがそのサーバーバージョンで持っていない機能を要求している</td>
</tr>
<tr>
<td align="left">3.0.1</td>
<td align="left">3.0.0</td>
<td align="center">あり</td>
<td align="left">サーバーがプラグインよりも高いパッチバージョンを持ち、互換性が保証されるため</td>
</tr>
<tr>
<td align="left">3.0.0</td>
<td align="left">3.0.1</td>
<td align="center">無し</td>
<td align="left">プラグインがそのサーバーバージョンで持っていないバグ修正を要求している</td>
</tr>
</tbody>
</table>
<h3 id="plugin-develop-api-versioning-api_1">サポートするAPIバージョンを選ぶ方法</h3>
<p>必要最小限バージョンを選ぶべきです。例えば必要とする機能が<code>3.1.0</code>で追加されているのであれば、現在のサポートされるバージョンが<code>3.2.0</code>であっても<code>3.1.0</code>を一番小さいバージョンとして要求できます。これによりどのバージョンのPocketMine-MPを使っているかによらずより良いUXを与えることができます。</p>
<p>もちろん、うまく動作することを保証するためにプラグインを最小限のバージョンでテストする必要があります。しかしながら、もう役目を終えている低いバージョンを要求するというのは意味がないこともあります。</p>
<h3 id="plugin-develop-api-versioning-_3">よくある誤解と落とし穴</h3>
<ul>
<li>APIバージョンは<strong>マジックナンバーではありません</strong>。盲目的にバージョンを変えてもそのバージョン向けになっていなければ<strong>プラグインは勝手に動きません</strong>。</li>
<li><strong>APIバージョンはプラグインマニフェスト内で一つずつ書かなければならないものではありません</strong>。<strong>それぞれのメジャーバージョン内で最小のバージョン</strong>のみが要求されます。<ul>
<li>良い例: <code>[3.1.0]</code>(単一の最小のバージョン), <code>[3.2.0, 4.0.0]</code>(異なる2つのメジャーバージョンでの最小のバージョン)</li>
<li><code>[3.1.0, 3.1.1, 3.1.2]</code> - これは望ましく<strong>なく</strong>、余計なバージョンは無視される</li>
</ul>
</li>
<li>プラグインが<strong>実際に指定したバージョンで動くこと</strong>を確かめてください。a) クラッシュするバージョンや b)期待されるように動作しないバージョンはバージョンリストから除外される必要があります。</li>
</ul>
<h2 id="plugin-develop-api-versioning-_4">翻訳元</h2>
<p>https://github.com/pmmp/DeveloperDocs/blob/b72417c924d0c917eeed6a172415edf7b5b3d52e/api-version-spec.md</p></section><section class="print-page" id="plugin-develop-development-faq"><h1 id="plugin-develop-development-faq-pocketminefaq">PocketMineプラグイン開発FAQ</h1>
<p>このページはプラグイン開発フォーラムでよく聞かれる質問について伝えることを目的にしています。コンテンツの大半はフォーラム上の質の良い投稿からまとめられたもので、参考があればリンクしてあります。</p>
<p>この元ページにはbitlink <a href="https://bit.ly/PmDev">https://bit.ly/PmDev</a> でアクセスしてください</p>
<h2 id="plugin-develop-development-faq-dpmi">翻訳について(dpmiより)</h2>
<p>このページのコンテンツは<a href="https://bit.ly/PmDev">PocketMine Plugin Development FAQ</a>から翻訳された内容です。元のコンテンツがunlicenseでだったことから、このページの内容もunlicenseとします。</p>
<h1 id="plugin-develop-development-faq-php">PHP</h1>
<h2 id="plugin-develop-development-faq-syntax-error">Syntax error 構文エラー</h2>
<p>これらはPHP自体での問題です。
These are pure PHP problems. <a href="http://stackoverflow.com/q/18050071/3990767">このStackOverflowのページ</a>を見てください。細かいところまでが書かれています。</p>
<h2 id="plugin-develop-development-faq-_1">ある数字が数字のリストの一つに等しいかを確認する</h2>
<p>日本語で「そのIDは1,2,3,4のいずれかなら」というのは意味が通る内容ですが、PHPで<code>if($id == [1, 2, 3, 4])</code>や<code>if($id == 1 or 2 or 3 or 4)</code>などのように書くのは間違いです。
詳細は<a href="https://stackoverflow.com/q/21343646/3990767">このStackOverflowの質問</a>と、さらに多くの方法を知りたければ<a href="https://stackoverflow.com/q/5593512/3990767">これ</a>を見てください。</p>
<h2 id="plugin-develop-development-faq-classnotfoundexception-class-not-found">ClassNotFoundException: Class <code>プラグイン内のクラス</code> not found</h2>
<p>クラスのファイルがPSR-0に基づいておかれているかを確認してください。(<a href="https://sof3.github.io/psr.htm">ここでチェック</a>).</p>
<h1 id="plugin-develop-development-faq-command-api">Command API</h1>
<h2 id="plugin-develop-development-faq-how-to-override-a-command">How to override a command?</h2>
<p>As of API 3.0.0-ALPHA4 and before, you have to first rename the original command into something else using <code>Command::setLabel</code>, then remove it from the command map using <code>Command::unregister</code>. Then your own command class can be registered to the command map directly. <sup><em>ref</em> from <a href="http://forums.pocketmine.net/thre7ads/overriding-default-7commands.8216/#post-87410">@iksaku</a> and <a href="https://gist.github.com/a540360b7323f7cc656f">@shoghicp</a></sup></p>
<p>For example, to override the /help command:</p>
<div class="highlight"><pre><span></span><code><span class="x">$map = $server-&gt;getCommandMap();</span>
<span class="x">$old = $map-&gt;getCommand(&quot;help&quot;);</span>
<span class="x">$old-&gt;setLabel(&quot;help_disabled&quot;);</span>
<span class="x">$old-&gt;unregister($map);</span>

<span class="x">$new = new MyHelpCommand($this);</span>
<span class="x">$map-&gt;register($this-&gt;getName(), $new);</span>
<span class="x">$map-&gt;register($this-&gt;getName(), $new, &quot;?&quot;);</span>
</code></pre></div>
<h2 id="plugin-develop-development-faq-custom-command-usage-autocompletion">Custom command usage / autocompletion</h2>
<p>In API 2.0.0 to API 3.0.0-ALPHA4, you have to do this for automatic command completion:
The actual command completion part can be done using the "enum_values" option.</p>
<p><div class="highlight"><pre><span></span><code><span class="x">// Class that extends pocketmine\command\Command</span>

<span class="x">public function generateCustomCommandData(Player $player) {</span>
<span class="x">   $commandData = parent::generateCustomCommandData($player);</span>
<span class="x">   $commandData[&quot;overloads&quot;][&quot;default&quot;][&quot;input&quot;][&quot;parameters&quot;] = [</span>
<span class="x">      0 =&gt; [</span>
<span class="x">         &quot;type&quot; =&gt; &quot;stringenum&quot;,</span>
<span class="x">         &quot;name&quot; =&gt; &quot;parameter&quot;,</span>
<span class="x">         &quot;optional&quot; =&gt; false,</span>
<span class="x">         &quot;enum_values&quot; =&gt; [&quot;parameter1&quot;, &quot;parameter2&quot;]</span>
<span class="x">      ],</span>
<span class="x">      1 =&gt; [</span>
<span class="x">         &quot;type&quot; =&gt; &quot;rawtext&quot;,</span>
<span class="x">         &quot;name&quot; =&gt; &quot;value&quot;,</span>
<span class="x">         &quot;optional&quot; =&gt; true</span>
<span class="x">      ],</span>
<span class="x">      2 =&gt; [</span>
<span class="x">         &quot;type&quot; =&gt; &quot;string&quot;,</span>
<span class="x">         &quot;name&quot; =&gt; &quot;name&quot;,</span>
<span class="x">         &quot;optional&quot; =&gt; true</span>
<span class="x">      ]</span>
<span class="x">   ];</span>

<span class="x">   return $commandData;</span>
<span class="x">}</span>
</code></pre></div>
For more information, refer to https://gist.github.com/NiclasOlofsson/db712fd9e3c9cb0777cd9381cb48915a <sup><a href="https://forums.pmmp.io/threads/available-subcommand-parameters-above-command.1841/"><em>ref</em></a></sup></p>
<!-- 編集者向け: https://github.com/pmmp/PocketMine-MP/blob/547503e8f44d1475def28bda2c0ed068eb24e670/changelogs/3.0-alpha.md#api-11 参照のとおり、この項目は不要となったため削除しました
# Event API
## \*\*\*Event does not have a handler list
You registered an event handler for an event that does not have a handler list. To fix this issue, find the parent class of the event that has a handler list, and handle that event class instead. Use `instanceof` in your event handler to filter events.

Take `EntityDamageByChildEntityEvent` as an example. Look at the [class file](https://github.com/pmmp/PocketMine-MP/blob/80292c6c7a542706a85c4f756e3d93bee1a07ca2/src/pocketmine/event/entity/EntityDamageByChildEntityEvent.php) &mdash; there is no `public static $handlerList;`, so you cannot make event handlers for it. Instead, look at the [class declaration](https://github.com/pmmp/PocketMine-MP/blob/80292c6c7a542706a85c4f756e3d93bee1a07ca2/src/pocketmine/event/entity/EntityDamageByChildEntityEvent.php#L29) to find out its superclass (`EntityDamageByEntityEvent`), and then [the superclass of the superclass](https://github.com/pmmp/PocketMine-MP/blob/80292c6c7a542706a85c4f756e3d93bee1a07ca2/src/pocketmine/event/entity/EntityDamageByEntityEvent.php#L30), vice versa, until you find a superclass [with the line `public static $handlerList = null;`](https://github.com/pmmp/PocketMine-MP/blob/80292c6c7a542706a85c4f756e3d93bee1a07ca2/src/pocketmine/event/entity/EntityDamageEvent.php#L32). Make your event handler handle this event class, and check if you are receiving `EntityDamageByChildEntityEvent` in the handler:

<div class="highlight"><pre><span></span><code><span class="x">public function handleDamage(EntityDamageEvent $event){</span>
<span class="x">    if($event instanceof EntityDamageByChildEntityEvent){</span>
<span class="x">        // handle $event here</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>
-->

<h1 id="plugin-develop-development-faq-scheduler-api">Scheduler APIとスレッディング</h1>
<h2 id="plugin-develop-development-faq-_2">タスクをキャンセルするには？(独自・更新)</h2>
<p>Use the <a href="https://github.com/pmmp/PocketMine-MP/blob/73592349cd29d91b03c2703107db859115a92e2d/src/scheduler/TaskHandler.php#L99"><code>TaskHandler::cancel()</code></a>メソッドを利用してください。</p>
<p><code>TaskHandler</code>はクラス外では<code>TaskScheduler::scheduleDelayedTask()</code>や<code>TaskScheduler::scheduleRepeatingTask()</code>の返り値として得られます。外部で利用したければ、プロパティに入れておくと良いでしょう。</p>
<p>またTask内部では<code>Task::getHandler()</code>が利用できます。</p>
<p>例:</p>
<!-- 編集者向け PluginTaskは削除されたことからも新しい方法でこの項目は書き直しています -->
<div class="highlight"><pre><span></span><code><span class="x">class MyTask extends Task{</span>
<span class="x">    public function onRun(int $ticks){</span>
<span class="x">        if(needToCancelTask()){</span>
<span class="x">            $this-&gt;getHandler()-&gt;cancel();</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>
<p>タスクのスケジュール時にタスクハンドラーを保存しておく:
<div class="highlight"><pre><span></span><code><span class="x">$this-&gt;taskHandler = $server-&gt;getScheduler()-&gt;scheduleRepeatingTask($myTask);</span>
<span class="x">// そのあとで……</span>
<span class="x">$this-&gt;taskHandler-&gt;cancel</span>
</code></pre></div></p>
<h2 id="plugin-develop-development-faq-_3">数秒以内に行われたイベントをキャンセルするには？</h2>
<p>そのような場合にはスケジューラーを使う必要はありません。システム時間の比較によって行うべきです。</p>
<p>この投稿はまだ整理されていません:</p>
<blockquote>
<p>~~Timer~~ スケジューラーとタスクは、一定の時間内の状態を持つわけではなく、一定時間後に動作をするものです。(プレイヤーが10秒間移動できない vs プレイヤーが10秒後に動けるようになる)</p>
<p>What is the difference? For the former, "be unfrozen" is the action, while for the latter, "be immobile" is the state.</p>
<p>How is a state different from an action? For an action, you do something actively. For example, "kill the player" is an action, but "the player is dead" is a state, a description, a condition.</p>
<p>In programming, the things you put in a function are always actions. You change a value, you call a function, you stop the code from executing. How does a condition affect execution? A condition is queried upon when something is executing, and it does not actively executes. Your condition is "cannot move". What executions will query this condition? Of course, you only need to know whether the player can move when the player tries to move. This is, as you said, cancel an event. You handle a PlayerMoveEvent and cancel it if the condition applies.</p>
<p>To be most convenient, you can change a value to make a player frozen/unfrozen, but this does not exist in PocketMine (there is Player-&gt;blocked, but it has side effects and it isn't very reliable). Therefore, you have to make PocketMine ask you whether the player can move every time the player tries to move. How do you yourself know whether the player can move? You ask yourself whether it is within the 10 seconds you asked for.</p>
<p>But the time that code executes changes - how do you know if it is that relative 10 seconds? Therefore, we make the relative time absolute. For example, if I tell you that I typed this sentence in the past minute, you don't know when I typed this sentence. So how do you find it out? You look at the time this post is posted, and minus one miniute, to know what I meant by "in the past minute". Without the post timestamp from the forums? I have to tell you the exact (absolute) date and time, that is, 2016-11-16 17:38:05 UTC+8.</p>
<p>Same goes to your code. You write down that "It is now 2016-11-16 17:38:05 UTC+8, and for the next 10 seconds the player can't move". Since time only goes forwards, I can make it even more straightforward: "The player can't move before 2016-11-16 17:38:15 UTC+8".</p>
<p>An absolute time can be retrieved using the time() or microtime() function. So, you only store the timestamp for the "unfreeze" time, then in the PlayerMoveEvent handler, you check if the current time is less than the "unfreeze" time. You don't need to check if it is less than the "freeze" time, because time only goes forwards.</p>
<p>You don't need to use scheduler tasks at all.</p>
</blockquote>
<p><sup><a href="https://forums.pmmp.io/threads/learning-timer-or-task.57/"><em>ref</em></a></sup></p>
<h2 id="plugin-develop-development-faq-what-is-different-between-scheduledelayedtask-schedulerepeatingtask-scheduledelayedrepeatingtask-and-scheduleasynctask">What is different between <code>scheduleDelayedTask</code>, <code>scheduleRepeatingTask</code>, <code>scheduleDelayedRepeatingTask</code> and <code>scheduleAsyncTask</code>?</h2>
<p>Do not mix them up. There is something called <code>Task</code>, where <code>PluginTask</code> is a type of <code>Task</code>; and there is something called <code>AsyncTask</code>, which is entirely irrelevant with <code>Task</code>.</p>
<p>A <code>Task</code> can be scheduled to run after some time, which is <code>scheduleDelayedTask</code>; or to run repeatedly at given intervals, starting immediately, which is <code>scheduleRepeatingTask</code>; or to start running repeatedly after some time, which is <code>scheduleDelayedRepeatingTask</code>. The code in <code>Task</code> is executed on the main thread.</p>
<h2 id="plugin-develop-development-faq-what-is-threading-does-it-make-the-server-faster">What is threading? Does it make the server faster?</h2>
<p>Threading is like executing code in another machine. Executing code in threads generally won't slow down the server unless you try to mine bitcoins. Each thread executes differently. We call the thread that the server does most of the work the "main thread". If the "main thread" is blocked (stops executing because it has to do something busy), it cannot respond to players, so it looks like the server hangs, or if it is only blocked for short periods, the server is laggy (decrease in TPS). <strong>In simple words, threading is executing in background.</strong></p>
<p>An <code>AsyncTask</code> is executed in other threads, but an <code>AsyncTask</code> is not an independent thread. PocketMine internally has some threads called <code>AsyncWorker</code>. Each <code>AsyncWorker</code> is an independent thread, which you can think as another CPU. When you <code>scheduleAsyncTask</code>, PocketMine adds your new <code>AsyncTask</code> to a queue of AsyncTasks called the <code>AsyncPool</code>. An <code>AsyncWorker</code> will take the oldest <code>AsyncTask</code> from the <code>AsyncPool</code> and execute it, and then takes and execute the next one from the <code>AsyncPool</code>. (Imagine there are a few water pipes removing water from a water pool &mdash; the water at the bottom gets removed first) They are still executed on the same machine, possibly on another core (system-dependent, I guess). Using an AsyncTask will not give you infinite CPU, but may facilitate better utilization of all the CPU available.</p>
<p>You should only use <code>AsyncTask</code> to run one-time operations (e.g. usually takes less than 15 seconds to execute). If you are using it to run repeating stuff, such as starting another server (e.g. an HTTP server like Volt or an IRC client like the IRCClient plugin), start a thread instead. Otherwise, you will keep one of the workers busy (the water pipe is stuck), and the server will get one less AsyncWorker available. <sup><a href="http://forums.pocketmine.net/threads/how-asynctask-reduces-lag.14056/#post-138729"><em>ref</em></a></sup></p>
<h3 id="plugin-develop-development-faq-asynctask-an-analogy-of-a-restaurant">AsyncTask: An analogy of a restaurant</h3>
<p>In this analogy, a customer = a player, the waiter = main thread, food = some data from the Internet that takes a long time to download, the cook = the code that downloads data</p>
<ol>
<li>A customer enters a restaurant and orders some food.
  * A player logins and asks the server to download some data from the Internet.</li>
<li>The waiter takes the order.
  * The server receives the command to download data.</li>
<li>The waiter writes a note to the cook to prepare the food.
  * The server starts an AsyncTask to download the data. While downloading data, the thread can't do anything else.</li>
<li>The waiter continues to serve other customers.
  * The server still serves the players, keeping them online, maintaining game mechanics, keep the server ticking, etc.</li>
<li>If the waiter does not ask the cook to prepare the food, but does the cooking himself, (assuming there is only one waiter) the customers will be left unattended, and they will be angry and leave the restaurant.
  * If the server downloads data on the main thread instead of in an AsyncTask, the players cannot see any response from the server to what they do, and may eventually timeout.</li>
<li>The waiter occasionally looks if the cook has finished preparing the food. (Looking at the table does not really stop him from serving customers, because it's just a glimpse and takes very little time)
  * The server checks if an AsyncTask is completed every tick.</li>
<li>The restaurant has a partition between the kitchen and the dining area, so the waiter and the cook cannot really talk directly.
  * Threads in PHP cannot communicate easily. They are often based on message stacks that may only be queried in long intervals.</li>
<li>The cook wants to say "the beef is ready, now preparing the noodles". He writes it on a note, and the waiter reads the note to the customer.
  * The AsyncTask announces that "50% downloaded" (using <code>AsyncTask::publishProgress</code>). The main thread checks for the progress every tick, and accordingly sends them to the player.
  * The main thread code is implemented in <code>AsyncTask::onProgressUpdate</code>, but they are actually run on the main thread.</li>
<li>If the food is ready, it is served to the player.
  * If the AsyncTask has a result, i.e. the data are downloaded, the data will be processed and the server accordingly reacts to the player.
  * The main thread code is implemented in <code>AsyncTask::onCompletion</code>, but they are actually run on the main thread.</li>
</ol>
<p><sup><em>ref</em>: an ancient post from @PEMapModder that can no longer be found. @SOF3 recited it.</sup></p>
<h2 id="plugin-develop-development-faq-what-can-be-done-in-asynctasks">What can be done in AsyncTasks?</h2>
<p><strong>You can't call API methods on a separate thread. This is the undeniable fact; this is by definition of "API methods of PocketMine" and "threads".</strong> The main body (<code>onRun</code>) of an AsyncTask is run entirely on a worker thread, and it is <strong>incorrect, if not impossible</strong> to call API methods from <code>AsyncTask::onRun()</code>. In addition to system limitations, most API operations you want to run in background actually have a bottleneck in network I/O with players, which cannot be prevented by threading anyway.</p>
<p>You may <em>request a delayed call</em> of API methods <em>on the main thread</em> from an AsyncTask using <code>publishProgress()</code> + <code>onProgressUpdate()</code>, or using <code>onCompletion()</code>, but <strong>you still cannot call API methods on other threads</strong>, but just on the main thread. You can <strong>pass scalar/serializable data</strong> between threads, and you can <em>request something to be done upon an object on the main thread</em> through a complicated series of scheduling, but you <strong>cannot</strong> do them <strong>directly on other threads</strong>. You may <em>break down objects and reconstruct them</em> in another thread, but <strong>they will not be the same object</strong>, i.e. if you somehow pass the Player object to an AsyncTask (which is actually impossible because it has a Server reference), <strong>it will be a clone</strong>, and <em>API methods won't work as they usually do</em>.</p>
<p>In other threads you may, however, call <em>static API methods</em>, such as <code>Utils::getURL()</code>, or even construct classes in the PocketMine API; but this is very dangerous, because if you aren't 100% sure what you are doing, you will end up trying to modify some data ineffectively without errors. <em>PHP builtin functions are not API methods</em>, but they are <strong>safe to use as long as they don't reference any storage in the main thread</strong>. For example, <a href="https://php.net/fopen"><code>fopen</code></a> returns a resource, which is actually an integer pointing to a handle stored in the PHP process; this resource ID will mean something probably entirely different if passed to another thread. You can still use resources in other threads, but make sure you don't try to reference resources in the main thread.</p>
<p>Therefore, <strong>trying to call an API method on other threads will fail silently</strong>. It is not possible, because you aren't calling API methods from <em>the</em> server at all; you are calling them probably on a clone of the server, or a clone of other objects, etc., which <strong>does not affect anything on the main thread</strong>. <sup><a href="https://forums.pmmp.io/threads/creating-async-task-and-call-methods-from-api.1000/#post-12255"><em>ref</em></a></sup></p>
<p>There are two typical uses:</p>
<h3 id="plugin-develop-development-faq-cpu-consuming-code">CPU-consuming code</h3>
<ul>
<li>No, this is not how you call setBlock() in a large loop in world edit. Remember that you cannot execute PocketMine core API stuff in AsyncTask or any other threads. (to be explained below)</li>
<li>One example is when you want to, say, delete a very big directory (e.g. the .git/ directory of a Git repo with many commits and branches like PocketMine, or the world folder of a map with many generated chunks). That is not related to PocketMine core, but it is time-consuming to run ("lagging the server") (I would consider anything taking more than half a tick, i.e. 25 ms "lagging the server"). You wouldn't expect it to take too much time (like a whole hour) to run, and you may execute it quite frequently.</li>
<li>For example, you may be copying/deleting a SkyWars map 5 times every 10 minutes). This is when you want to use AsyncTask. AsyncTask wouldn't magically use less CPU. But it executes in another thread, which is like in another process (or is it really in a subprocess/another process? I'm not sure about how pthreads works internally).
So instead of spending the server's core tick time to do stuff that you don't need to get done on the pulse, do it in another thread.</li>
<li>E.g. you can teleport the player to that world after the copying AsyncTask has completed; you don't need to do that immediately, and maybe your copying task spends 100 milliseconds to run, the player doesn't notice it but your server will lag behind for 2 ticks if you had not used an AsyncTask).</li>
</ul>
<h3 id="plugin-develop-development-faq-waiting-blocking">Waiting-blocking</h3>
<ul>
<li>No, I didn't say waiting for a player to do something. You can simply use the event API or the scheduler API to do that instead of suspending an async worker.</li>
<li>This refers to thread-blocking function calls, such as curl_exec() (hence <code>Utils::getURL()</code> and <code>Utils::postURL()</code>). HTTP requests (cURL execution) would lag your server, because it spends most of the time waiting for a response from another server.</li>
<li>Another example is MySQL queries. You aren't doing anything constructive in the majority time of a query function call. You are simply waiting for MySQL server to read your query, execute it and return a result.</li>
<li>Why spend all the main thread performance on waiting for a response?</li>
<li>It would of course be most convenient if you can set your queries/requests to be non-blocking and use a scheduler task to synchronously check if the server has respond. But in cases where you can't, we are simply putting the query aside and get a worker (another thread) stuck instead of getting the main thread stuck. Do you want the waiters look sick or the cooks to look sick, when your clients can see your waiters but not your cooks?</li>
<li>It doesn't save CPU. It just redistributes the CPU use.</li>
</ul>
<p><sup><a href="http://forums.pocketmine.net/threads/how-asynctask-reduces-lag.14056/#post-138729"><em>ref</em></a></sup></p>
<h2 id="plugin-develop-development-faq-stored-local-complex-data-did-not-remove-them-after-completion">Stored local complex data did not remove them after completion</h2>
<p>Do not pass anything to the AsyncTask (parent) constructor unless you are going to use them in onCompletion() or onProgressUpdate(). If you do so, you must call fetchLocal() in onCompletion() to remove the data.</p>
<p>AsyncTask is not a PluginTask. You do not need to pass arguments to it.</p>
<p><sup><a href="https://forums.pmmp.io/threads/async-task-spam.3163/"><em>ref</em></a></sup></p>
<h1 id="plugin-develop-development-faq-data-saving">Data saving</h1>
<h2 id="plugin-develop-development-faq-yaml-vs-sql">YAML vs SQL</h2>
<p>JSON is a subset of YAML. Any valid JSON data can be parsed as YAML. So unless you want to store the data in a compact way (which is pointless for small files, since <a href="https://unix.stackexchange.com/q/62049/161897">the size of each file is always multiples of 4 KB</a>), YAML seems to always be a better option compared to JSON, unless your data will be parsed by a program that only knows JSON but not YAML. (After all, JSON has a long history but YAML is kind of new, but most languages already have YAML libraries)</p>
<p>If you have may data for many small units, e.g. a few numbers per player, you won't want to store all the data in the same YAML file, because it's slow. You have to load all the data into memory whenever you do I/O, which may cause memory failure.</p>
<p>Therefore, to save data for each player, each account should have its own file. However, it creates a large number of files, which many users may dislike. Also, it is inconvenient to evaluate statistics based on all data, e.g. mean, sum, maximum, etc. To do so with YAML, you have to either:</p>
<ul>
<li>Load the data of all units every time. But if you have 100000 players registered, you are in trouble. You have to open a file stream for each unit, read the contents, store them in a list, and close stream. This will lead to very poor performance, especially on personal computers, whose harddisks don't expect you to read so many files at a time. Therefore, this is not a good idea.</li>
<li>Store the values. If you want a sum, store the sum somewhere and update it every time a datum is added/removed/updated. If you want an average or standard deviation, store the count too and also update it every time data are changed. If you want top 10, a bit trouble. If you want the median, basically you must recalculate all the data every time, unless you otherwise have an index of all numbers somewhere, which isn't per-player storage anymore. <sup><a href="http://forums.pocketmine.net/threads/yaml-vs-sql.15091/#post-147453"><em>ref</em></a></sup></li>
</ul>
<p>Oh the other hand, SQL has these advantages:</p>
<ul>
<li>All the data are stored in the same file, but the data are accessed using <a href="https://php.net/fseek"><code>fseek</code></a>, which prevents loading unnecessary data. SQL is optimized for various queries, and data are indexed upon request, so it is more efficient.</li>
<li>Most SQL implementations (e.g. MySQL) have good concurrency support, so multiple servers can access data together without conflict, if you know how to use it. Nevertheless, user-side setup might be slightly inconvenient.</li>
</ul>
<p>Of course, the best solution is to let the users pick what database to use and bear their own consequences! See <a href="https://github.com/PocketMine/SimpleAuth">SimpleAuth</a> for how to support switching between multiple database types.</p>
<h1 id="plugin-develop-development-faq-general-gameplay">General gameplay</h1>
<h2 id="plugin-develop-development-faq-coordinate-system">Coordinate system</h2>
<p>The Minecraft coordinate system complies with a right-handed Cartesian coordinate system, i.e. <code>x cross y = z</code>, as in this figure:</p>
<p><a href="https://en.wikipedia.org/wiki/Right-hand_rule"><img alt="See Wikipedia's article on Right-hand Rule" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Right_hand_rule_cross_product.svg/440px-Right_hand_rule_cross_product.svg.png" /></a></p>
<p>In the Minecraft system, Y (the index finger) points upwards (negative Y points downwards). X points eastwards (negative X goes westwards), and Z points southwards (negative Z goes northwards).</p>
<p>The sun and moon come out from the east since Pocket Edition 1.1 <sup><a href="https://minecraft.gamepedia.com/Day-night_cycle#History"><em>ref</em></a></sup>. Clouds float westward, too <sup><a href="https://minecraft.gamepedia.com/Cloud#Behavior"><em>ref</em></a></sup>.</p>
<p>Rotation is measured by yaw (a.k.a. azimuth) and pitch. The yaw is the clockwise rotation from the south, i.e.:</p>
<table>
<thead>
<tr>
<th align="center">Yaw (Degrees), mod 360</th>
<th align="center">Yaw (Radians), mod 2&pi;</th>
<th align="center">Direction</th>
<th align="center">One step from (x = 0, z = 0) in this direction</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">South</td>
<td align="center">(0, 1)</td>
</tr>
<tr>
<td align="center">90</td>
<td align="center">0.5&pi;</td>
<td align="center">West</td>
<td align="center">(-1, 0)</td>
</tr>
<tr>
<td align="center">180</td>
<td align="center">&pi;</td>
<td align="center">North</td>
<td align="center">(0, -1)</td>
</tr>
<tr>
<td align="center">270</td>
<td align="center">1.5&pi;</td>
<td align="center">East</td>
<td align="center">(1, 0)</td>
</tr>
</tbody>
</table>
<p>Pitch is the downward rotation. Starting at 0 at the horizontal, it increases to 90&deg; (0.5&pi;) when facing the ground, and decreases to -90&deg; (-0.5&pi;) when facing the sky.</p>
<p>A few cautions:
* The yaw and pitch are represented in degrees in most places in PocketMine, including <code>Entity::$yaw</code> and <code>Entity::$pitch</code>.
* The yaw is not guaranteed to be within the range <code>[0, 360)</code>. Be sure to mod 360 before comparing it.
* PHP's behaviour with <code>$negative_number % $positive_number</code> or <code>fmod($negative_number, $positive_number)</code>: a negative number is returned. But the yaw can be negative. Be sure to conditionally add 360 to the yaw after <code>% 360</code> if it is negative.
* PHP's <code>%</code> operator casts floats to ints. This may affect your results slightly. Use <code>fmod</code> instead; but it might still produce negative results.</p>
<p>Here is an alternative to <code>%</code>/<code>fmod</code> that always produces zero/positive float results:</p>
<div class="highlight"><pre><span></span><code><span class="x">function positive_fmod(float $a, float $b) : float{</span>
<span class="x">    return $a - floor($a / $b) * $b;</span>
<span class="x">}</span>
</code></pre></div>
<h3 id="plugin-develop-development-faq-conversion-of-yawpitch-to-a-unit-vector-src">Conversion of yaw+pitch to a unit vector <sup><a href="https://github.com/pmmp/PocketMine-MP/blob/master/src/pocketmine/entity/Entity.php#L1063-L1070"><em>src</em></a></sup></h3>
<div class="highlight"><pre><span></span><code><span class="x">$y = -sin(deg2rad($this-&gt;pitch));</span>
<span class="x">$xz = cos(deg2rad($this-&gt;pitch));</span>
<span class="x">$x = -$xz * sin(deg2rad($this-&gt;yaw));</span>
<span class="x">$z = $xz * cos(deg2rad($this-&gt;yaw));</span>
<span class="x">return (new Vector3($x $y, $z))-&gt;normalize(); // TODO: verify if normalize() call is needed</span>
</code></pre></div>
<h3 id="plugin-develop-development-faq-evaluate-yaw-and-pitch-looking-from-pos1-to-pos2-ref">Evaluate yaw and pitch looking from $pos1 to $pos2 <sup><a href="https://forums.pmmp.io/threads/direction.2285/#post-23772"><em>ref</em></a></sup></h3>
<div class="highlight"><pre><span></span><code><span class="x">$diff = $pos2-&gt;subtract($pos1)-&gt;normalize();</span>
<span class="x">$pitch = asin(-$diff-&gt;y);</span>
<span class="x">$yaw = acos($diff-&gt;z / cos($pitch));</span>
</code></pre></div>
<hr />
<h3 id="plugin-develop-development-faq-legacy">Legacy</h3>
<table>
<thead>
<tr>
<th align="center">symbol</th>
<th align="center">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><em>ref</em></td>
<td align="center">Content is copied from the linked forum thread</td>
</tr>
<tr>
<td align="center"><em>src</em></td>
<td align="center">Content is based on evidence from source code</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><a href="https://raw.githubusercontent.com/SOF3/forums-common-sense/master/LICENSE"><img alt="Unlicense" src="https://img.shields.io/badge/license-Unlicense-blue.svg?style=plastic" /></a> This wiki is community work.</p>
<p>In jurisdictions that recognize copyright laws, the author or authors of this software dedicate any and all copyright interest in the software to the public domain. We make this dedication for the benefit of the public at large and to the detriment of our heirs and successors. We intend this dedication to be an overt act of relinquishment in perpetuity of all present and future rights to this software under copyright law.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<p>For more information, please refer to <a href="http://unlicense.org">http://unlicense.org</a></p>
</div></section><section class="print-page" id="plugin-develop-language"><h1 id="plugin-develop-language-_1">多言語対応</h1>
<p>Poggitでプラグインをリリースする場合やサーバーを多言語対応する場合には<code>pocketmine\lang\Language</code>を用いることで比較的楽に対応することができます。また、これによりメッセージ送信部がスマートにできるかもしれません。</p>
<p><a href="https://github.com/pmmp/PocketMine-MP/blob/master/src/lang/Language.php">https://github.com/pmmp/PocketMine-MP/blob/master/src/lang/Language.php</a>より内容を抜粋。</p>
<h2 id="plugin-develop-language-language">Languageの利用</h2>
<p>例としてプラグインのディレクトリ構造が以下のようになっているとします。</p>
<p><div class="highlight"><pre><span></span><code>ExamplePlugin
├ resources
│ └ lang
│ 　 ├ jpn.ini
│ 　 └ eng.ini
├ src
│ └ ...
└ plugin.yml
</code></pre></div>
この場合、メインクラスにおいて
<div class="highlight"><pre><span></span><code><span class="x">$path = &quot;{$this-&gt;getFile()}/resources/lang&quot;;</span>
<span class="x">$language = new Language(&quot;jpn&quot;,$path);</span>
</code></pre></div>
とすれば、<code>$language</code>にはjpn.iniがロードされた状態になります。</p>
<p>例えば、<code>jpn.ini</code>の中身が以下のようであったとします。
<div class="highlight"><pre><span></span><code><span class="na">language.name</span><span class="o">=</span><span class="s">日本語</span><span class="w"></span>
<span class="na">test.msg1</span><span class="o">=</span><span class="s">Languageの使い方</span><span class="w"></span>
<span class="na">test.msg2</span><span class="o">=</span><span class="s">{%0}が{%1}に{%2}を渡しました。</span><span class="w"></span>
</code></pre></div>
このとき、上の<code>$language</code>では
<div class="highlight"><pre><span></span><code><span class="x">$language-&gt;translateString(&quot;test.msg1&quot;) /* -&gt; &quot;Languageの使い方&quot; */;</span>
<span class="x">$language-&gt;translateString(&quot;test.msg2&quot;, [&quot;Steve&quot;, &quot;Alex&quot;, &quot;スコップ&quot;]) /* -&gt; &quot;SteveがAlexにスコップを渡しました。&quot;*/</span>
</code></pre></div>
のようになります。
これを利用して多言語対応を行うことができます。</p>
<p>なお、<code>Language</code>インスタンスの生成はファイルIOを伴うため、実用時には以下のような構成にすると良いでしょう。</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">exampleplugin</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">pocketmine\lang\Language</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">pocketmine\plugin\PluginBase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Webmozart\PathUtil\Path</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Loader</span> <span class="k">extends</span> <span class="nx">PluginBase</span><span class="p">{</span>

    <span class="sd">/** @var array&lt;string, Language&gt;*/</span>
    <span class="k">private</span> <span class="k">array</span> <span class="nv">$language</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">onLoad</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$path</span> <span class="o">=</span> <span class="nx">Path</span><span class="o">::</span><span class="na">join</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">(),</span> <span class="s2">&quot;resources&quot;</span><span class="p">,</span> <span class="s2">&quot;lang&quot;</span><span class="p">);</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nx">Language</span><span class="o">::</span><span class="na">getLanguageList</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$lang</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">){</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getLogger</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">info</span><span class="p">(</span><span class="s2">&quot;Language: </span><span class="si">$name</span><span class="s2"> is loaded&quot;</span><span class="p">);</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">language</span><span class="p">[</span><span class="nv">$lang</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Language</span><span class="p">(</span><span class="nv">$lang</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getLanguage</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$lang</span><span class="o">=</span><span class="nx">Language</span><span class="o">::</span><span class="na">FALLBACK_LANGUAGE</span><span class="p">)</span><span class="o">:</span> <span class="nx">Language</span><span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">language</span><span class="p">[</span><span class="nv">$lang</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></section><h1 class='nav-section-title-end'>Ended: プラグイン開発</h1>
                        <h1 class='nav-section-title' id='section-api4'>
                            API4 <a class='headerlink' href='#section-api4' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="api4-index"><h1 id="api4-index-api4">API4</h1>
<h2 id="api4-index-_1">インストールについて</h2>
<p>現在(2021.10.9) API4.0.0はベータ段階であり、安定版ではありません。テスト目的でのみ使用してください。
インストール方法は以下のページを参考にしてください。</p>
<ul>
<li><a href="https://qiita.com/bbo51dog/items/414b6270682f1a028bfe">https://qiita.com/bbo51dog/items/414b6270682f1a028bfe</a> (Ubuntu)</li>
<li><a href="#building-build-in-api4">API4でのサーバー構築</a></li>
</ul>
<h2 id="api4-index-_2">変更点のまとめ(鯖主向け)</h2>
<p>このセクションではAPI4での変更点をいくつかまとめて記述します。全訳は<a href="#api4-changelogs">API4 Changelogs全訳</a>より見られます。</p>
<h3 id="api4-index-_3">一般</h3>
<ul>
<li>セキュリティ・荒らし対策に関する変更点<ul>
<li>プラグインのホワイトリスト化・ブラックリスト化ができるようになります。</li>
<li>RCONやスポーンプロテクションはプラグインに代わりました。</li>
<li>プレイヤーのアンチ移動チートがなくなります。</li>
</ul>
</li>
<li>サーバーの動作に関する変更<ul>
<li>チャンク関連のPHP拡張が変更されました。binの変更が必要です。</li>
<li>リスポーン時のバグが修正されました。</li>
<li></li>
</ul>
</li>
</ul>
<h3 id="api4-index-_4">コマンド</h3>
<ul>
<li><code>/reload</code>コマンドが無くなりました</li>
<li><code>/effect</code>, <code>/enchant</code>コマンドは数字のIDは受け付けなくなり、英語のIDのみでしか使えません。</li>
<li><code>/gc</code>,<code>/status</code>,<code>/op</code>,<code>/deop</code>コマンドの表示が日本語化されるようになりました。</li>
</ul>
<h3 id="api4-index-pocketmineyml">設定 (<code>pocketmine.yml</code>)</h3>
<ul>
<li><code>pocketmine.yml</code>におけるワールドプリセットのキーが<code>generator</code>から<code>preset</code>に変更されました。</li>
<li>新たなオプションが使えるようになります<ul>
<li><code>chunk-ticking.blocks-per-subchunk-per-tick</code> サボテンの成長など、ブロックアップデートの確率</li>
<li><code>network.enable-encryption</code> pmmp&lt;-&gt;Minecraft間のパケットを暗号化するか否か</li>
</ul>
</li>
<li><code>chunk-ticking.light-updates</code>が削除されました。光処理なしにチャンクチックを進めることができなくなります。</li>
</ul>
<h3 id="api4-index-world">world関連</h3>
<ul>
<li>最初のワールド生成時にはスポーン生成がログに表示されるようになります。</li>
<li>バージョン1.12.xまでのMinecraft Bedrockのワールドがサポートされました。本家からワールドを持ってこれます。</li>
<li>非推奨となった<code>leveldb</code>以外のワールド形式は<code>leveldb</code>に変換されます。</li>
<li>建築高さ上限は256になりました。</li>
</ul>
<h3 id="api4-index-_5">パフォーマンス</h3>
<ul>
<li>保存方式が変わったことによりワールド保存が高速化されました。</li>
<li>爆発や光処理が軽くなりました。</li>
<li>パケット圧縮が高速化されました。ネットワーク全体の性能が向上します。</li>
</ul>
<h3 id="api4-index-_6">ロガーの刷新</h3>
<ul>
<li>多くのメッセージでプレフィックスが追加されました。</li>
<li>タイムスタンプがミリ秒まで含むようになります。</li>
</ul>
<h3 id="api4-index-_7">ネットワーク</h3>
<ul>
<li>デフォルトでパケットが暗号化されるようになります。</li>
<li>エラーチェックが実装されました。例外時にサーバーがクラッシュするようになります。</li>
<li><code>Internal server error</code>は削除されました。</li>
</ul>
<h2 id="api4-index-_8">開発者向け情報</h2>
<h3 id="api4-index-devtools-api4">DevTools API4対応版の配布場所</h3>
<p>poggit上でダウンロード可 <a href="https://poggit.pmmp.io/ci/pmmp/DevTools/PocketMine-DevTools">https://poggit.pmmp.io/ci/pmmp/DevTools/PocketMine-DevTools</a> の Build History:master により最新版がダウンロード可能</p></section><section class="print-page" id="api4-changelogs"><h1 id="api4-changelogs-api4-changelogs">API4 Changelogs全訳</h1>
<h2 id="api4-changelogs-_1">訳に関して</h2>
<p><a href="https://github.com/pmmp/PocketMine-MP/blob/a3f8546ac442d6bbb44dfedc19eb6d3e639a50b6/changelogs/4.0.md">https://github.com/pmmp/PocketMine-MP/blob/a3f8546ac442d6bbb44dfedc19eb6d3e639a50b6/changelogs/4.0.md</a> 版より翻訳</p>
<p>翻訳漏れの無いように気を配りますが、書かれていない項目がある場合PRを送ってもらえると助かります。</p>
<h2 id="api4-changelogs-400-beta1">4.0.0-BETA1</h2>
<p>2021.9.7リリース
このメジャーバージョンAPI4は重要なAPIの変更,新しいワールド形式のサポート,パフォーマンスの向上やネットワークの刷新を含めたコア全体の重要な変更に焦点を当てています。</p>
<p>これはベータリリースであり、最終版でないことを注意してください。 現在からリリースまでに重大な変更はない予定ですがAPIはまだ変更される可能性があります。</p>
<p>さらに、このチェンジログはベストエフォートに基づいて提供されていて、すべての変更点が言及されていない可能性があることに注意してください。何か洩れがあった場合追加するためにプルリクエストをお願いします。(すなわち pmmp公式へ)</p>
<h3 id="api4-changelogs-_2">警告</h3>
<p>これは安定版リリースでは<strong>ありません</strong>。PMMPはこのビルドを使用したことによる損害のいかなる責任を負いません。
<strong>テスト</strong>目的にのみ使用してください。</p>
<h3 id="api4-changelogs-_3">コア</h3>
<h4 id="api4-changelogs-general">一般 General</h4>
<ul>
<li>"プラグイングレーリスト"機能が導入されます。ローディング時からプラグインをホワイトリスト化もしくはブラックリスト化することができます。</li>
<li>Remote Console (RCON) は削除されました。<a href="https://github.com/pmmp/RconServer">RconServer</a>プラグインが代わりに提供されます。</li>
<li>スポーンプロテクションは削除されました。<a href="https://github.com/pmmp/BasicSpawnProtection">BasicSpawnProtection</a>プラグインが代わりに提供されます。</li>
<li>Ctrl+Cシグナルハンドリングは削除されました。[PcnltSignalHandler]プラグインが代わりに提供されます。</li>
<li>プレイヤー移動アンチチートは削除されました。</li>
<li>GS4 QueryはRakLibが無効化されても停止されなくなりました。</li>
<li><code>pocketmine_chunkutils</code> PHP拡張は使われなくなりました。</li>
<li>新しいPHP拡張がこのバージョンから必要になりました。<ul>
<li><a href="https://github.com/pmmp/ext-chunkutils2">chunkutils2</a></li>
<li><a href="https://github.com/pmmp/ext-morton">morton</a></li>
</ul>
</li>
<li>プレイヤーリスポーン時の多くのバグが修正されました。<ul>
<li>生成されていない地形でリスポーンする際に岩盤下にスポーンするバグ</li>
<li>非常に遅いマシン上で初回サーバー参加時に岩盤下にスポーンするバグ</li>
<li>カスタムスポーン地点がセットされている状態でリスポーンしたときにブロック内(または上空)にスポーンするバグ</li>
<li>プレイヤースポーン地点がワールドスポーンが変わった時に以前の場所になってしまうバグ</li>
</ul>
</li>
<li>高い維持コストのわりに恩恵が少ないためプリプロセッサーはビルドから削除されました。現在、プリプロセッサー利用は非推奨です。</li>
</ul>
<h4 id="api4-changelogs-commands">コマンド Commands</h4>
<ul>
<li><code>/reload</code> コマンドは削除されました。</li>
<li><code>/effect</code> コマンドは数字IDをサポートしなくなりました。現在では名前が要求されます。</li>
<li><code>/enchant</code> コマンドは数学IDをサポートしなくなりました。現在では名前が要求されます。</li>
<li><code>/clear</code> コマンドが追加されました。バニラのMinecraftのものと機能的に同等のものです。</li>
<li>以下のコマンドの出力は選択した言語にローカライズされました。<ul>
<li><code>/gc</code></li>
<li><code>/status</code></li>
<li><code>/op</code></li>
<li><code>/deop</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-configuration">設定 Configuration</h4>
<ul>
<li>ワールドのプリセットは<code>pocketmine.yml</code>の<code>preset</code>キーとして利用できるようになりました: 以前は<code>generator</code>キー</li>
<li>新たに以下のオプションが<code>pocketmine.yml</code>に追加されます<ul>
<li><code>chunk-ticking.blocks-per-subchunk-per-tick</code>(デフォルト <code>3</code>):この値を増加させるとランダムブロックアップデートの確率が上がります。(例. 草の成長)</li>
<li><code>network.enable-encryption</code>(デフォルト<code>true</code>): Minecraftネットワークパケットを暗号化するか否かを決定できます。</li>
</ul>
</li>
<li>以下のオプションが<code>pocketmine.yml</code>から削除されました。<ul>
<li><code>chunk-ticking.light-updates</code>: 光処理は基本的なバニラの機能を動作させるのに必要なため、チャンクチックを無効化することなくこの機能を停止することは意味がありません。もし、明るさ計算をしたくなければチャンクチックと共に無効化するようにしてください。</li>
<li><code>player.anti-cheat.allow-movement-cheats</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-_4">ワールドハンドリング</h4>
<h5 id="api4-changelogs-_5">インターフェイス</h5>
<ul>
<li>最初のワールド生成時にスポーン地形チャンク生成の進度が表示されるようになりました。</li>
</ul>
<h5 id="api4-changelogs-_6">機能</h5>
<ul>
<li>1.12.xまでのMinecraft Bedrockのワールドがサポートされました。(1.13より上はまた別の形式変更によりまだ<strong>サポートされていません</strong>。対応には非常に労力を要します。)</li>
<li>非推奨のワールド形式の自動変換が実装されました。</li>
<li><code>leveldb</code>以外のすべての形式は非推奨となりました。以下のワールド形式は<strong>ロード時に自動的に新しい形式に変換されます</strong>:<ul>
<li><code>mcregion</code></li>
<li><code>anvil</code></li>
<li><code>pmanvil</code></li>
</ul>
</li>
<li>建築上限256はすべてのワールドでサポートされます。(自動変換により)</li>
<li>追加ブロックがサポートされます。(自動変換により)</li>
<li>光処理はディスク上に保存・ロードされなくなりました。</li>
<li>かわりに必要に応じてすぐに算出されます。これは以前からあった多くのバグを修正します。</li>
</ul>
<h5 id="api4-changelogs-_7">パフォーマンス</h5>
<ul>
<li><code>leveldb</code>は現在、基本のサポートされたワールド形式です。優れた設計により生来よりリージョンベース形式よりも高速です。</li>
<li>部分的なチャンク保存(変更されたチャンクの子要素のみを保存する)が実装されました。これによりチャンク保存時に書き込む必要のあるデータ量を徹底的に減らすことができます。また、同様に<strong>ワールド保存にかかる時間も徹底的に減らします</strong>。 これは<code>leveldb</code>ワールド形式のモジュール設計に可能になりました。リージョンベース形式ではこの強化はできません。</li>
<li>光処理はすべてのチャンクで利用可能であるとは限らなくなります。必要に応じてすぐに算出されます。</li>
<li><code>/op</code>, <code>/deop</code>, <code>/whitelist add</code> and <code>/whitelist remove</code> は理由なくプレイヤーデータを読み込まないようになりました。</li>
<li><code>Timings</code>はより正確なパフォーマンスメトリクスを収集するため<code>hrtime()</code>により提供される高精度なタイマーを使うようになります。</li>
<li>Z階数曲線(モートンコード)がブロックとチャンク座標のハッシュのために使用されます。これはハッシュテーブルキーハッシュ衝突問題を解決することにより広い範囲でパフォーマンスを非常に改善します。影響がある範囲には爆発や明るさ計算などを含みます。</li>
<li><a href="https://github.com/ebiggers/libdeflate"><code>libdeflate</code></a>が(オプションで)外方向へのMinecraftパケット圧縮に使用できます。これは多くのケースで<code>zlib</code>の2倍以上高速で、パケットブロードキャストとネットワーク全体の性能を向上させます。</li>
<li>クロージャーは現在内部イベントハンドラーの呼び出しのために使用されています。これにより3.xシステムよりも10-20%の性能向上ができます。3.xシステムはイベントコールのたびに動的にコーラブルを解決する必要がありました。</li>
</ul>
<h4 id="api4-changelogs-logger">Logger刷新</h4>
<ul>
<li>多くのコンポーネントは自動的にプレフィックスをメッセージに追加する専用のロガーを持つようになりました。</li>
<li>メインロガーはミリ秒のタイムスタンプを含むようになりました。</li>
</ul>
<h4 id="api4-changelogs-_8">ネットワーク</h4>
<p>このバージョンではネットワークシステムの重大な変更を組み込んでいます: コヒーレンシ、信頼性、モジュール性の向上をしました。</p>
<h5 id="api4-changelogs-minecraft-bedrock">Minecraft Bedrock パケット暗号化</h5>
<ul>
<li>これはハッカーがプレイヤーのログインを盗聴し利用することによる反射攻撃を防ぎます。</li>
<li>新たな設定<code>network.enable-encryption</code>が<code>pocketmine.yml</code>に追加されました。デフォルトでは<code>true</code>です。</li>
</ul>
<h5 id="api4-changelogs-_9">パケット受信エラーハンドリングが整備されました</h5>
<ul>
<li>今は<code>BadPacketException</code>のみがパケットのデコード、ハンドリング時にキャッチされます。これにはすべてのデコードが適切なエラーチェックを行うことが<strong>必須</strong>とされます。<ul>
<li>デコードで<code>BadPacketException</code>を投げるとプレイヤーは<code>Packet processing error</code>メッセージでキックされます。</li>
<li>切断メッセージにはサーバーオーナーがプレイヤーから報告された問題を特定しやすくするためのランダムな16進数IDが含まれます。</li>
</ul>
</li>
<li>そのほかの例外を投げるとサーバーはクラッシュします。<code>Internal server error</code>は削除されました。</li>
<li>現在ではサーバーに対するクライアント方向へのパケットの送信は不当なものになりました。これを行うとクライアントは<code>Unexpected non-serverbound packet</code>メッセージでキックされます。</li>
</ul>
<h5 id="api4-changelogs-_10">新たなパケットハンドラーシステム</h5>
<ul>
<li>パケットハンドラーはネットワークセッションから分離され、専用のパケットハンダラー構造に分かれました。</li>
<li>ネットワークセッションは正確に1つのハンドラーをその時点で持つことができます。ハンドラーは可変ありいつでも置き換えられます。これによりパケットハンドリングのロジックを複数のステージへと分離することができます。<ul>
<li>不正なタイミングで不正なパケットを送信することを防ぐ(今では何事もなくドロップされます)</li>
<li>一時的な状態固有のロジックの存在を許可する(例えばリソースパックのより厳格なダウンロードチェック)</li>
</ul>
</li>
<li>パケットハンドラーはほとんどいたるところで<code>Player</code>からなくなり、代わりにそのパケットハンドラー専用のユニットに存在しまるようになりました。</li>
<li>以前まで<code>Player</code>のパケットハンドラー内部に絡み合っていたほぼすべてのゲームロジックは新たなAPIメソッドへと展開されました。詳しくはPlayer APIの変更をご覧ください。</li>
</ul>
<h3 id="api4-changelogs-api">API</h3>
<h4 id="api4-changelogs-_11">一般</h4>
<ul>
<li>以前まで<code>callable</code>を許容していた大半の個所は、現在では<code>/Closure</code>のみを許可します。これはクロージャーがより一貫性のある振る舞いをして性能がより高いためです。</li>
<li><code>void</code>と<code>?nullable</code> パラメータおよび返り値の型指定は多くの箇所に適用されました。</li>
<li><code>pocketmine\metadeta</code>にあるすべてのものとそれに関連する実装は削除されました。</li>
</ul>
<h4 id="api4-changelogs-pluginyml"><code>plugin.yml</code>の変更</h4>
<h5 id="api4-changelogs-_12">パーミッションのネスト</h5>
<p>パーミッションのネストは<code>plugin.yml</code>内ではサポートされなくなりました。 <code>plugin.yml</code>内で(デフォルトにより)パーミッションのグループ化には、非常に混乱しやすく一貫性のないふるまいがありました。
ネストによるパーミッションの宣言の代わりに、宣言はそれぞればらばらになさなければならなりません。</p>
<p><em>Before</em>:
<div class="highlight"><pre><span></span><code>permissions:
    pmmp:
        default: op
children:
    pmmp.something:
        default: op
            pmmp.somethingElse:
                default: op
</code></pre></div></p>
<p><em>After</em>:
<div class="highlight"><pre><span></span><code>permissions:
    pmmp.something:
        default: op
    pmmp.somethingElse:
        default: op
</code></pre></div></p>
<h5 id="api4-changelogs-src-namespace-prefix"><code>src-namespace-prefix</code></h5>
<p>新しい指示文<code>src-namespace-prefix</code>が導入されます。これにより以下のようなプラグイン構造にある無駄なサブディレクトリを取り除くことができます。
例えば、以前では<code>pmmp\TesterPlugin\Main</code>がメインクラスであるようなプラグインはこのような構造でした。
<div class="highlight"><pre><span></span><code>|-- plugin.yml
|-- src/
    |-- pmmp/
        |-- TesterPlugin/
            |-- Main.php
            |-- SomeOtherClass.php
            |-- SomeNamespace/
                |-- SomeNamespacedClass.php
</code></pre></div>
しかし、<code>src-namespace-prefix:pmmp\TesterPlugin</code>を<code>plugin.yml</code>に付けくわえることで無駄なディレクトリを取り除き、このような構造にすることができます。
<div class="highlight"><pre><span></span><code>|-- plugin.yml
|-- src/
    |-- Main.php
    |-- SomeOtherClass.php
    |-- SomeNamespace/
        |-- SomeNamespacedClass.php
</code></pre></div></p>
<p><strong>ノート</strong>: 昔の構造でもちゃんと動きます。これは必ず変えなければならない変更ではありません。</p>
<h5 id="api4-changelogs-block">Block</h5>
<ul>
<li>新たに<code>VanillaBlocks</code>クラスが追加されました。このクラスは現在知られているどのブロックタイプでも生成できる静的メソッドを保有しています。 これは定数が使われている場合に<code>BlockFactory::get()</code>の代わりとしてしようされることが好ましいです。</li>
<li>ブロックは<code>Position</code>を継承するかわりにポジションを保有します。<code>Block-&gt;getBlockPosition()</code>が追加されました。</li>
<li>256以上のIDをもつブロックがサポートされました。</li>
<li>ブロックのステートとバリアントメタデータは分離されました。<ul>
<li>バリアントはIDの拡張と考えられ、不変です。(解説:これは回転や開閉といった状態を含まないことを表す)</li>
<li><code>Block-&gt;setDamage()</code>は削除されました。</li>
<li>すべてのブロックにはブロックプロパティ相応のゲッターとセッターが備わりました。例えば<code>facing</code> どの向きか,<code>lit/unlit</code> 着火/消火, <code>colour</code> 色などです。これらはメタデータの代わりに利用されるべきです。</li>
</ul>
</li>
<li>タイルエンティティは,タイルエンティティを必要とするブロックが<code>World-&gt;setBlock()</code>されたときに自動的に作成/削除されるようになります。</li>
<li>いくつかのタイルエンティティのAPIは,タイルエンティティが非推奨となると同時に対応する<code>Block</code>クラスで公開されるようになりました。</li>
<li>名前空間<code>pocketmine\tile</code>は<code>pocketmine\block\tile</code>に移動されました。</li>
<li><code>Block-&gt;recalculateBoundingBox()</code>と<code>Block-&gt;recalculateCollisionBoxes()</code>は自身の位置基準ではなく<code>0,0,0</code>に基準のAABBsを返すようになります。</li>
<li>ブロックの破壊情報は新しい動的な<code>BlockBreakInfo</code>ユニットへと展開されました。以下のメソッドが移動されます。<ul>
<li><code>Block-&gt;getBlastResistance()</code> -&gt; <code>BlockBreakInfo-&gt;getBlastResistance()</code></li>
<li><code>Block-&gt;getBreakTime()</code> -&gt; <code>BlockBreakInfo-&gt;getBreakTime()</code></li>
<li><code>Block-&gt;getHardness()</code> -&gt; <code>BlockBreakInfo-&gt;getHardness()</code></li>
<li><code>Block-&gt;getToolHarvestLevel()</code> -&gt; <code>BlockBreakInfo-&gt;getToolHarvestLevel()</code></li>
<li><code>Block-&gt;getToolType()</code> -&gt; <code>BlockBreakInfo-&gt;getToolType()</code></li>
<li><code>Block-&gt;isBreakable()</code> -&gt; <code>BlockBreakInfo-&gt;isBreakable()</code></li>
<li><code>Block-&gt;isCompatibleWithTool()</code> -&gt; <code>BlockBreakInfo-&gt;isToolCompatible()</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Block-&gt;asItem()</code>: ブロックに対応するアイテムスタックを返す。</li>
<li><code>Block-&gt;isSameState()</code>: ステート情報を含めてブロックが同じパラメータであるかを返す。</li>
<li><code>Block-&gt;isSameType()</code>: ステート情報を含めずにブロックが同じパラメータであるかを返す。</li>
<li><code>Block-&gt;isFullCube()</code></li>
</ul>
</li>
<li>以下のフックが追加されました。<ul>
<li><code>Block-&gt;onAttack()</code>: サバイバルモードのプレイヤーがブロックを左クリックしブロックの破壊をし始めた時に呼ばれる。</li>
<li><code>Block-&gt;onEntityLand()</code>: エンティティが(高さによらず)落下後にブロック上に乗ったときに呼ばれる。</li>
<li><code>Block-&gt;onPostPlace()</code>: ワールドにおかれた直後に呼ばれ、レール接続やチェストの連結をハンドルする。</li>
</ul>
</li>
<li>以下のAPIメソッドがリネームされました。<ul>
<li><code>Block-&gt;getDamage()</code> -&gt; <code>Block-&gt;getMeta()</code></li>
<li><code>Block-&gt;onActivate()</code> -&gt; <code>Block-&gt;onInteract()</code></li>
<li><code>Block-&gt;onEntityCollide()</code> -&gt; <code>Block-&gt;onEntityInside()</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変わりました。<ul>
<li><code>Block-&gt;onInteract()</code> は現在ではシグネチャ <code>onInteract(Item $item, int $face, Vector3 $clickVector, ?Player $player = null) : bool</code> を持ちます。</li>
<li><code>Block-&gt;getCollisionBoxes()</code> はファイナルになりました。 子クラスは<code>recalculateCollisionBoxes()</code>をオーバーライドするべきです。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Block-&gt;canPassThrough()</code></li>
<li><code>Block-&gt;setDamage()</code></li>
<li><code>Block::get()</code>: これはずいぶん前に <code>BlockFactory::get()</code>に置き換えられています。</li>
<li><code>Block-&gt;getBoundingBox()</code></li>
</ul>
</li>
<li>以下のクラスはリネームされました。<ul>
<li><code>BlockIds</code> -&gt; <code>BlockLegacyIds</code></li>
<li><code>CobblestoneWall</code> -&gt; <code>Wall</code></li>
<li><code>NoteBlock</code> -&gt; <code>Note</code></li>
<li><code>SignPost</code> -&gt; <code>Sign</code></li>
<li><code>StandingBanner</code> -&gt; <code>Banner</code></li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>Bricks</code></li>
<li><code>BurningFurnace</code></li>
<li><code>CobblestoneStairs</code></li>
<li><code>Dandelion</code></li>
<li><code>DoubleSlab</code></li>
<li><code>DoubleStoneSlab</code></li>
<li><code>EndStone</code></li>
<li><code>GlowingRedstoneOre</code></li>
<li><code>GoldOre</code></li>
<li><code>Gold</code></li>
<li><code>IronDoor</code></li>
<li><code>IronOre</code></li>
<li><code>IronTrapdoor</code></li>
<li><code>Iron</code></li>
<li><code>Lapis</code></li>
<li><code>NetherBrickFence</code></li>
<li><code>NetherBrickStairs</code></li>
<li><code>Obsidian</code></li>
<li><code>PurpurStairs</code></li>
<li><code>Purpur</code></li>
<li><code>QuartzStairs</code></li>
<li><code>Quartz</code></li>
<li><code>RedSandstoneStairs</code></li>
<li><code>RedSandstone</code></li>
<li><code>SandstoneStairs</code></li>
<li><code>Sandstone</code></li>
<li><code>StainedClay</code></li>
<li><code>StainedGlassPane</code></li>
<li><code>StainedGlass</code></li>
<li><code>StoneBrickStairs</code></li>
<li><code>StoneBricks</code></li>
<li><code>StoneSlab2</code></li>
<li><code>StoneSlab</code></li>
<li><code>Stone</code></li>
<li><code>WallBanner</code></li>
<li><code>WallSign</code></li>
<li><code>Wood2</code></li>
</ul>
</li>
<li><code>BlockToolType</code>の定数は<code>TYPE_</code>プレフィックスを削除する形でリネームされました。</li>
</ul>
<h4 id="api4-changelogs-command">Command</h4>
<ul>
<li>以下のクラスは削除されました。<ul>
<li><code>RemoteConsoleCommandSender</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変わりました。<ul>
<li><code>Command-&gt;setPermission()</code> nullableではありますが、引数が必須になりました</li>
<li><code>CommandSender-&gt;setScreenLineHeight()</code> nullableではありますが、引数が必須になりました</li>
</ul>
</li>
<li>名前に空白を含むコマンドはサポートされなくなりました</li>
</ul>
<h4 id="api4-changelogs-entity">Entity</h4>
<h5 id="api4-changelogs-_13">一般</h5>
<ul>
<li><code>Entity</code>は<code>Location</code>を継承しなくなります。 代わりに<code>Entity-&gt;getLocation()</code>や<code>Entity-&gt;getPosition()</code>を使ってください。</li>
<li>以下のフィールドは削除されました。<ul>
<li><code>Entity-&gt;chunk</code>: エンティティはどのチャンクにいるのかを自身では記憶しなくなりました (かわりに<code>World</code>がそれを管理します)。</li>
<li><code>Entity-&gt;height</code>: <code>EntitySizeInfo</code>に移動しました。 代わりに<code>Entity-&gt;size</code>を使ってください。</li>
<li><code>Entity-&gt;width</code>: <code>EntitySizeInfo</code>に移動しました。 代わりに<code>Entity-&gt;size</code>を使ってください。</li>
<li><code>Entity-&gt;eyeHeight</code>: <code>EntitySizeInfo</code>に移動しました。 代わりに <code>Entity-&gt;size</code>を使ってください。</li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Entity-&gt;getFallDistance()</code></li>
<li><code>Entity-&gt;setFallDistance()</code></li>
<li><code>ItemEntity-&gt;getDespawnDelay()</code></li>
<li><code>ItemEntity-&gt;setDespawnDelay()</code></li>
<li><code>Living-&gt;calculateFallDamage()</code>: これは<code>protected</code>です。 サブクラスにより、これをオーバーライドすることでダメージロジックをカスタマイズできます。</li>
<li><code>Human-&gt;getHungerManager()</code></li>
<li><code>Human-&gt;getXpManager()</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変わりました。<ul>
<li><code>Entity-&gt;entityBaseTick()</code>は<code>protected</code>になりました。</li>
<li><code>Entity-&gt;move()</code>は<code>protected</code>になりました。</li>
<li><code>Entity-&gt;setPosition()</code>は<code>protected</code>になりました。 (代わりに <code>Entity-&gt;teleport()</code>を使ってください).</li>
<li><code>Entity-&gt;setPositionAndRotation()</code>は<code>protected</code> (代わりに<code>Entity-&gt;teleport()</code>を使ってください).</li>
<li><code>Living-&gt;knockBack()</code>は<code>float, float, float</code>を受け入れるようになりました。 (最初の２つのパラメーターは削除されました).</li>
<li><code>Living-&gt;getEffects()</code>は<code>Effect[]</code>の代わりに<code>EffectManager</code>を返すようになりました。</li>
</ul>
</li>
<li>以下のクラスは追加されました。<ul>
<li><code>effect\EffectManager</code>: <code>Living</code>から展開されたエフェクト管理の機能群を保持します。</li>
<li><code>HungerManager</code>: <code>Human</code>から展開された空腹管理の機能群を保持します。</li>
<li><code>ExperienceManager</code>: <code>Human</code>から展開された経験値管理の機能群を保持します。</li>
</ul>
</li>
<li>以下のAPIメソッドは移動、またはリネームされました。<ul>
<li><code>Entity-&gt;fall()</code> -&gt; <code>Entity-&gt;onHitGround()</code> (また、アクセス権が<code>public</code>から<code>protected</code>になりました。)</li>
<li><code>Living-&gt;removeAllEffects()</code> -&gt; <code>EffectManager-&gt;clear()</code></li>
<li><code>Living-&gt;removeEffect()</code> -&gt; <code>EffectManager-&gt;remove()</code></li>
<li><code>Living-&gt;addEffect()</code> -&gt; <code>EffectManager-&gt;add()</code></li>
<li><code>Living-&gt;getEffect()</code> -&gt; <code>EffectManager-&gt;get()</code></li>
<li><code>Living-&gt;hasEffect()</code> -&gt; <code>EffectManager-&gt;has()</code></li>
<li><code>Living-&gt;hasEffects()</code> -&gt; <code>EffectManager-&gt;hasEffects()</code></li>
<li><code>Living-&gt;getEffects()</code> -&gt; <code>EffectManager-&gt;all()</code></li>
<li><code>Human-&gt;getFood()</code> -&gt; <code>HungerManager-&gt;getFood()</code></li>
<li><code>Human-&gt;setFood()</code> -&gt; <code>HungerManager-&gt;setFood()</code></li>
<li><code>Human-&gt;getMaxFood()</code> -&gt; <code>HungerManager-&gt;getMaxFood()</code></li>
<li><code>Human-&gt;addFood()</code> -&gt; <code>HungerManager-&gt;addFood()</code></li>
<li><code>Human-&gt;isHungry()</code> -&gt; <code>HungerManager-&gt;isHungry()</code></li>
<li><code>Human-&gt;getSaturation()</code> -&gt; <code>HungerManager-&gt;getSaturation()</code></li>
<li><code>Human-&gt;setSaturation()</code> -&gt; <code>HungerManager-&gt;setSaturation()</code></li>
<li><code>Human-&gt;addSaturation()</code> -&gt; <code>HungerManager-&gt;addSaturation()</code></li>
<li><code>Human-&gt;getExhaustion()</code> -&gt; <code>HungerManager-&gt;getExhaustion()</code></li>
<li><code>Human-&gt;setExhaustion()</code> -&gt; <code>HungerManager-&gt;setExhaustion()</code></li>
<li><code>Human-&gt;exhaust()</code> -&gt; <code>HungerManager-&gt;exhaust()</code></li>
<li><code>Human-&gt;getXpLevel()</code> -&gt; <code>ExperienceManager-&gt;getXpLevel()</code></li>
<li><code>Human-&gt;setXpLevel()</code> -&gt; <code>ExperienceManager-&gt;setXpLevel()</code></li>
<li><code>Human-&gt;addXpLevels()</code> -&gt; <code>ExperienceManager-&gt;addXpLevels()</code></li>
<li><code>Human-&gt;subtractXpLevels()</code> -&gt; <code>ExperienceManager-&gt;subtractXpLevels()</code></li>
<li><code>Human-&gt;getXpProgress()</code> -&gt; <code>ExperienceManager-&gt;getXpProgress()</code></li>
<li><code>Human-&gt;setXpProgress()</code> -&gt; <code>ExperienceManager-&gt;setXpProgress()</code></li>
<li><code>Human-&gt;getRemainderXp()</code> -&gt; <code>ExperienceManager-&gt;getRemainderXp()</code></li>
<li><code>Human-&gt;getCurrentTotalXp()</code> -&gt; <code>ExperienceManager-&gt;getCurrentTotalXp()</code></li>
<li><code>Human-&gt;setCurrentTotalXp()</code> -&gt; <code>ExperienceManager-&gt;setCurrentTotalXp()</code></li>
<li><code>Human-&gt;addXp()</code> -&gt; <code>ExperienceManager-&gt;addXp()</code></li>
<li><code>Human-&gt;subtractXp()</code> -&gt; <code>ExperienceManager-&gt;subtractXp()</code></li>
<li><code>Human-&gt;getLifetimeTotalXp()</code> -&gt; <code>ExperienceManager-&gt;getLifetimeTotalXp()</code></li>
<li><code>Human-&gt;setLifetimeTotalXp()</code> -&gt; <code>ExperienceManager-&gt;setLifetimeTotalXp()</code></li>
<li><code>Human-&gt;canPickupXp()</code> -&gt; <code>ExperienceManager-&gt;canPickupXp()</code></li>
<li><code>Human-&gt;onPickupXp()</code> -&gt; <code>ExperienceManager-&gt;onPickupXp()</code></li>
<li><code>Human-&gt;resetXpCooldown()</code> -&gt; <code>ExperienceManager-&gt;resetXpCooldown()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Human-&gt;getRawUniqueId()</code>は、代わりに<code>Human-&gt;getUniqueId()-&gt;toBinary()</code>を使うようになりました。</li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>Creature</code></li>
<li><code>Damageable</code></li>
<li><code>Monster</code></li>
<li><code>NPC</code></li>
<li><code>Rideable</code></li>
<li><code>Vehicle</code></li>
</ul>
</li>
<li><code>Skin</code>無効なデータを受け取ると例外を投げるようになりました。</li>
</ul>
<h5 id="api4-changelogs-effect">Effect</h5>
<ul>
<li>全ての<code>Effect</code>に関連したクラスは<code>pocketmine\entity\effect</code>の名前空間に移動しました。</li>
<li><code>Effect</code>クラスに入っていたエフェクト機能はいくつかのクラスに分けられました。以下のクラスが新しく追加されました。<ul>
<li><code>AbsorptionEffect</code></li>
<li><code>HealthBoostEffect</code></li>
<li><code>HungerEffect</code></li>
<li><code>InstantDamageEffect</code></li>
<li><code>InstantEffect</code></li>
<li><code>InstantHealthEffect</code></li>
<li><code>InvisibilityEffect</code></li>
<li><code>LevitationEffect</code></li>
<li><code>PoisonEffect</code></li>
<li><code>RegenerationEffect</code></li>
<li><code>SaturationEffect</code></li>
<li><code>SlownessEffect</code></li>
<li><code>SpeedEffect</code></li>
<li><code>WitherEffect</code></li>
</ul>
</li>
<li><code>VanillaEffects</code>クラスが追加されました。これは全てのバニラエフェクトタイプを静的メソッドで表現し、<code>Effect::getEffect()</code>よりもきれいに書けるようになります。<ul>
<li>例: <code>Effect::getEffect(Effect::NIGHT_VISION)</code>は<code>VanillaEffects::NIGHT_VISION()</code>に置き換えることができます。</li>
</ul>
</li>
<li>エフェクトの強さ(amplifiers)を負の値にすることは現在では明確に禁止されます。エフェクトの生み出す効果が定義されていないためです。</li>
<li>MCPEのエフェクトIDとPocketMine-MP内部のIDの境目がより明確になりました。<ul>
<li>IDハンドリングは<code>pocketmine\data\bedrock\EffectIdMap</code>へ移動しました。</li>
<li>すべてのエフェクトID定数は<code>Effect</code>から削除されました。何らかの理由でレガシーエフェクトIDが必要なら<code>pocketmine\data\bedrock\EffectIds</code>を利用してください。</li>
</ul>
</li>
<li>以下のAPIメソッドは移動しました。<ul>
<li><code>Effect-&gt;getId()</code> -&gt; <code>EffectIdMap-&gt;toId()</code></li>
<li><code>Effect::registerEffect()</code> -&gt; <code>EffectIdMap-&gt;register()</code></li>
<li><code>Effect::getEffect()</code> -&gt; <code>EffectIdMap-&gt;fromId()</code></li>
<li><code>Effect::getEffectByName()</code> -&gt; <code>VanillaEffects::fromString()</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Effect-&gt;getRuntimeId()</code>: これは<strong>動的ID</strong>でありエフェクトタイプの比較に用いることができます。<strong>これは決して保持されないため、configやNBTでは利用しないでください！</strong></li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-nbt">実行時エンティティNBTの削除</h5>
<ul>
<li>エンティティは実行時にNBTを存在させ続けなくなりました。<ul>
<li><code>Entity-&gt;namedtag</code>は削除されました。</li>
<li><code>Entity-&gt;saveNBT()</code>はその場で前のNBTに変更を加えるのではなく、現在では新規生成された<code>CompoundTag</code>を返すようになりました。</li>
<li><code>Entity-&gt;initEntity()</code>は現在では<code>CompoundTag</code>パラメータを受け付けます。</li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-_14">エンティティ生成</h5>
<ul>
<li><code>Entity::createEntity()</code>は削除されました。もはや実行時に新たなエンティティを生成するためには必要なくなりました。代わりに、単に<code>new YourEntity</code>のようにしてください。</li>
<li><code>Entity</code>の子クラスのコンストラクタは普通のクラスと同様にどのようなシグネチャでも持つことができます。</li>
<li>NBTからのエンティティの読み込みは現在では<code>EntityFactory</code>にハンドルされるようになりました。<code>Entity::createEntity()</code>の動作とはかなり違った動作をします。 <code>YourEntity::class</code>を一式のMinecraft save IDに登録する代わりに、 あるNBTと<code>World</code>が与えられたときにエンティティを構築するコールバックを与える必要があります。<ul>
<li>生成コールバックは<code>EntityFactory::register()</code>を用いて登録されます。</li>
<li>生成コールバックはシグネチャ<code>function(World, CompoundTag) : Entity</code>を持つ必要があります。</li>
<li>これにより<code>Entity</code>の子クラスはそれぞれにふさわしいコンストラクタ引数を持てるようになりました。</li>
<li>また、特定のデータが常に与えられるように要求することも可能になります。(例えば、<code>FallingBlock</code>をどの種類のブロックかを指定することなく生成するというのは理解できません。)</li>
<li>例:<ul>
<li><code>ItemEntity</code>は現在では<code>Item</code>をコンストラクタで要求するようになりました。そのため、生成コールバックは<code>Item</code>をコンストラクタに渡されたNBTからデコードするものです。</li>
<li><code>Painting</code>は現在では<code>PaintingMotive</code>をコンストラクタで要求するようになりました。そのため、生成コールバックはどの<code>PaintingMotive</code>を与えるべきかを受け取ったNBTに応じて決定するものです。</li>
<li>さらなる例は<code>EntityFactory</code>をご覧ください。</li>
</ul>
</li>
</ul>
</li>
<li><code>EntityFactory::register()</code>(以前の<code>Entity::registerEntity()</code>)はエラー発生時に<code>false</code>のかわりに例外を投げるようになりました。</li>
<li>以下のAPIメソッドが移動しました。<ul>
<li><code>Entity::registerEntity()</code> -&gt; <code>EntityFactory::register()</code></li>
</ul>
</li>
<li>以下のクラスはコンストラクタが変更されました。<ul>
<li>すべての発射物の子クラスは現在では<code>?Entity $thrower</code>パラメータを必要とします。</li>
<li><code>Arrow-&gt;__construct()</code>は現在では<code>bool $critical</code> パラメータを必要とします。</li>
<li><code>ExperienceOrb-&gt;__construct()</code>は現在では<code>int $xpValue</code>パラメータを必要とします。</li>
<li><code>FallingBlock-&gt;__construct()</code>は現在では<code>Block $block</code>パラメータを必要とします。</li>
<li><code>ItemEntity-&gt;__construct()</code>は現在では<code>Item $item</code>パラメータを必要とします。</li>
<li><code>Painting-&gt;__construct()</code>は現在では<code>PaintingMotive $motive</code>を必要とします。</li>
<li><code>SplashPotion-&gt;__construct()</code>は現在では<code>int $potionId</code>を必要とします。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Entity::createBaseNBT()</code>: <code>new YourEntity</code>と適切なAPIメソッドが利用されるべきです。</li>
<li><code>Entity-&gt;getSaveId()</code></li>
<li><code>Entity::getKnownEntityTypes()</code></li>
<li><code>Entity::createEntity()</code>: <code>new YourEntity</code>をかわりに利用してください。 </li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-_15">やりかけ エンティティのネットワークメタデータの削除</h5>
<ul>
<li>定数に関するすべてのネットワークメタデータは<code>Entity</code>クラスから削除され、プロトコル層へ移動されました。これはネットワークメタデータをAPIから全体的に削除することを意図していますが、完了はしていません。<ul>
<li>定数<code>Entity::DATA_FLAG_*</code>は<code>pocketmine\network\mcpe\protocol\types\entity\EntityMetadataFlags</code>に移動されました。</li>
<li>定数<code>Entity::DATA_TYPE_*</code>は<code>pocketmine\network\mcpe\protocol\types\entity\EntityMetadataTypes</code>に移動されました。</li>
<li>定数<code>Entity::DATA_*</code>は<code>pocketmine\network\mcpe\protocol\types\entity\EntityMetadataProperties</code>に移動されました。</li>
</ul>
</li>
<li><code>DataPropertyManager</code>は 名前空間<code>pocketmine\network\mcpe\protocol\types\entity</code>に移動され、したがってAPIの一部ではないものとして扱われます。</li>
<li>導入された内部の<code>Entity</code>は<code>syncNetworkData()</code>をフックします。この関数はエンティティのプロパティをエンティティはエンティティのネットワークデータセット同期することが期待されます。</li>
<li>内部のエンティティのプロパティを保存するためのネットワークメタデータセットの内部利用は削除されました。エンティティは現在では正規のクラスプロパティを使用し、ネットワークデータセットを同期することが期待されます。</li>
<li><code>Entity-&gt;propertyManager</code>は<code>Entity-&gt;networkProperties</code>にリネームされました。</li>
<li><code>Entity-&gt;getDataPropertyManager()</code>は<code>Entity-&gt;getNetworkProperties()</code>にリネームされました。</li>
</ul>
<h4 id="api4-changelogs-event">Event</h4>
<h5 id="api4-changelogs-listener">内部イベントシステムにおける<code>Listener</code>依存の排除</h5>
<ul>
<li>内部イベント処理システムは<code>Listener</code>オブジェクトに依存しなくなりました。ハンドラーになるための標準要求さえ満たせば任意のクロージャーが利用できます。<ul>
<li>この変更により、イベントハンドラーの呼び出し性能が15%程改善されます。プラグインが行っていることは何も含まれません。</li>
<li>以下のクラスが削除されました。<ul>
<li><code>pocketmine\plugin\EventExecutor</code></li>
<li><code>pocketmine\plugin\MethodEventExecutor</code></li>
</ul>
</li>
<li><code>RegisteredListener-&gt;__construct()</code>は先頭のパラメータとして<code>Listener, EventExecutor</code>の代わりに<code>Closure</code>を必要とします。</li>
<li><code>RegisteredListener-&gt;getListener()</code>は削除されました。</li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-_16">デフォルトのキャンセルハンドリングの振る舞いの変化</h5>
<ul>
<li>ハンドラー関数は<strong>デフォルトではキャンセルされたイベントを受け取らなくなります</strong>。 これは<strong>静かに後方互換性を損なうもの</strong>であり、すなわち直接エラーを吐くことはなくともバグを引き起こす可能性があります。</li>
<li><code>@ignoreCancelled</code>は無視されるようになりました。</li>
<li><code>@handleCancelled</code>が追加されました。これを用いるとキャンセルされたイベントを <em>受け取る</em> ことができるようになります。(<code>@ignoreCancelled</code>の反対です)</li>
</ul>
<h5 id="api4-changelogs-playerpreloginevent"><code>PlayerPreLoginEvent</code>の変更</h5>
<ul>
<li><code>Player</code>オブジェクトはログインのこのフェーズでは存在しなくなりました。代わりに<code>PlayerInfo</code>オブジェクトが接続情報とともに与えられます。</li>
<li>Ban、サーバーの満員、ホワイトリストの確認は<code>PlayerPreLoginEvent</code>に一元化されます。もはやこの手の切断をハンドルするために<code>PlayerKickEvent</code>に介入する必要はなくなるとともに、介入することはできなくなりました。<ul>
<li>複数のキック理由を使用すると、他にプレイヤーを切断する理由があって内一つが除外されたときにもプレイヤーを確実に切断することができます。例えばあるプレイヤーがBanされていてサーバーが満員であったとすると、Banフラグを除外してもサーバーが満員であることからプレイヤーはそれでも切断されます。</li>
<li>プラグインはカスタムのキック理由をセットできます。どの理由も絶対的な優先度を持ちます。</li>
<li>もし複数のフラグがセットされていた場合、キックメッセージには最も優先度が高いものが表示されます。優先度(このスナップショットにおいて)は下記の順に続きます。<ul>
<li>カスタム (最優先)</li>
<li>満員</li>
<li>ホワイトリスト</li>
<li>Ban</li>
</ul>
</li>
</ul>
</li>
<li><code>PlayerPreLoginEvent::KICK_REASON_PRIORITY</code>定数は高いほうが先にくるキック理由の優先度のリストを保持します。</li>
<li>以下の定数が追加されました<ul>
<li><code>PlayerPreLoginEvent::KICK_REASON_PLUGIN</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_SERVER_FULL</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_SERVER_WHITELISTED</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_BANNED</code></li>
<li><code>PlayerPreLoginEvent::KICK_REASON_PRIORITY</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;clearAllKickReasons()</code></li>
<li><code>PlayerPreLoginEvent-&gt;clearKickReason()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getFinalKickMessage()</code>: 現在の理由リストでプレイヤーに表示されるメッセージ</li>
<li><code>PlayerPreLoginEvent-&gt;getIp()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getKickReasons()</code>: キック理由を示すフラグの配列, 参加できる時には空</li>
<li><code>PlayerPreLoginEvent-&gt;getPlayerInfo()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getPort()</code></li>
<li><code>PlayerPreLoginEvent-&gt;isAllowed()</code></li>
<li><code>PlayerPreLoginEvent-&gt;isAuthRequired()</code>: XBL認証が強制されているか</li>
<li><code>PlayerPreLoginEvent-&gt;isKickReasonSet()</code></li>
<li><code>PlayerPreLoginEvent-&gt;setAuthRequired()</code></li>
<li><code>PlayerPreLoginEvent-&gt;setKickReason()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは変更されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;getKickMessage()</code>は現在ではシグネチャ<code>getKickMessage(int $flag) : ?string</code>を持ちます。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;setKickMessage()</code></li>
<li><code>PlayerPreLoginEvent-&gt;getPlayer()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは移動/リネームされました。<ul>
<li><code>InventoryPickupItemEvent-&gt;getItem()</code> -&gt; <code>InventoryPickupItemEvent-&gt;getItemEntity()</code></li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-_17">その他の変更</h5>
<ul>
<li>イベントの間にプレイヤーが切断されてもサーバーはクラッシュしなくなりました。(それでも他の副作用を引き起こす可能性があります)</li>
<li><code>PlayerKickEvent</code>は最初のログインシークエンスが完了する以前に発生した切断では着火されなくなりました。(例 リソースパックのダウンロード完了時)</li>
<li>キャンセル可能なイベントはインターフェースの要件を満たすために必要なキャンセル可能なコンポーネントを得るための<code>CancellableTrait</code>を実装する必要があります。<code>Event</code>はこれらのメソッドをスタブを持たなくなりました。</li>
<li><code>PlayerInteractEvent</code>はプレイヤーがアイテムをアクティベートしたときに着火されなくなりました。これは古くからの問題であった<code>PlayerInteractEvent</code>が一回触った時にも繰り返し発火されてしまう問題を修正します。以下の定数は削除されました。<ul>
<li><code>PlayerInteractEvent::LEFT_CLICK_AIR</code></li>
<li><code>PlayerInteractEvent::RIGHT_CLICK_AIR</code></li>
<li><code>PlayerInteractEvent::PHYSICAL</code></li>
</ul>
</li>
<li>以下のイベントが追加されます。<ul>
<li><code>PlayerEntityInteractEvent</code>: プレイヤーがエンティティを右クリック(スマホでは長押し)した時のイベント</li>
<li><code>PlayerItemUseEvent</code>: プレイヤーが持っているアイテムをアクティベートした時のイベント, 例えば雪玉を投げるなど。</li>
<li><code>BlockTeleportEvent</code>: ブロックがテレポートした時のイベント、例えばエンドラの卵が攻撃されたときなど。</li>
<li><code>PlayerDisplayNameChangeEvent</code></li>
<li><code>EntityItemPickupEvent</code>: プレイヤーやエンティティが落ちているアイテム(か矢)を拾った時のイベント。 <code>InventoryPickupItemEvent</code>と<code>InventoryPickupArrowEvent</code>の置き換え<ul>
<li>置き換え前とは違って、アイテムが入るインベントリを変更することができます。</li>
<li>もし入るインベントリを<code>null</code>にすると、アイテムは破棄されます。これはインベントリが満杯の状態でクリエイティブのプレイヤーが拾うときに見られる動作です。</li>
</ul>
</li>
<li><code>EntityTrampleFarmlandEvent</code>: 農地上でmobやプレイヤーがジャンプをして土に変化させるときのイベント。</li>
<li><code>StructureGrowEvent</code>: 木や竹、その他の複数ブロックの苗木構造物が成長するときに呼ばれます。</li>
</ul>
</li>
<li>以下のイベントは削除されました。<ul>
<li><code>EntityArmorChangeEvent</code></li>
<li><code>EntityInventoryChangeEvent</code></li>
<li><code>EntityLevelChangeEvent</code> - <code>EntityTeleportEvent</code>にてワールドの確認をすることで代用してください。</li>
<li><code>InventoryPickupItemEvent</code> - <code>EntityItemPickupEvent</code>を代わりに使用してください。</li>
<li><code>InventoryPickupArrowEvent</code> - <code>EntityItemPickupEvent</code>を代わり使用してください。</li>
<li><code>NetworkInterfaceCrashEvent</code></li>
<li><code>PlayerCheatEvent</code></li>
<li><code>PlayerIllegalMoveEvent</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>EntityDeathEvent-&gt;getXpDropAmount()</code></li>
<li><code>EntityDeathEvent-&gt;setXpDropAmount()</code></li>
<li><code>PlayerDeathEvent-&gt;getXpDropAmount()</code></li>
<li><code>PlayerDeathEvent-&gt;setXpDropAmount()</code></li>
</ul>
</li>
<li>以下のメソッドは削除されました。<ul>
<li><code>PlayerPreLoginEvent-&gt;getPlayer()</code></li>
<li><code>Cancellable-&gt;setCancelled()</code>: これにより<code>Cancellable</code>実装はそのイベント特有のキャンセル機構を実装できるようになりました。例えば<code>PlayerPreLoginEvent</code>における複雑な機構などです。</li>
</ul>
</li>
<li>以下のAPIメソッドは移動されました。<ul>
<li><code>Event-&gt;isCancelled()</code> -&gt; <code>CancellableTrait-&gt;isCancelled()</code>: これはクラスが<code>Cancellable</code>を実装していなかった場合に<code>BadMethodCallException</code>を投げるスタブでした。これは現在ではキャンセル不可能なイベントでは単に使えなくなっています。</li>
<li><code>Event-&gt;setCancelled()</code>は<code>cancel()</code>と<code>uncancel()</code>に分割され、<code>CancellableTrait</code>に移動しました。</li>
<li><code>HandlerList::unregisterAll()</code> -&gt; <code>HandlerListManager-&gt;unregisterAll()</code></li>
<li><code>HandlerList::getHandlerListFor()</code> -&gt; <code>HandlerListManager-&gt;getListFor()</code></li>
<li><code>HandlerList::getHandlerLists()</code> -&gt; <code>HandlerListManager-&gt;getAll()</code></li>
</ul>
</li>
<li>以下のクラスは移動しました。<ul>
<li><code>pocketmine\plugin\RegisteredListener</code> -&gt; <code>pocketmine\event\RegisteredListener</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-inventory">Inventory</h4>
<ul>
<li>すべてのクラフトとレシピに関するクラスは名前空間<code>pocketmine\crafting</code>に移動しました。</li>
<li>以下のクラスが追加されました。<ul>
<li><code>CallbackInventoryChangeListener</code></li>
<li><code>CreativeInventory</code>: 以前まで<code>pocketmine\item\Item</code>に埋め込まれていた機能群を含みます。詳細はアイテムの変更をご覧ください</li>
<li><code>InventoryChangeListener</code>: 一つのインベントリのイベントを監視できます(ただし介入はできません)。</li>
<li><code>transaction\CreateItemAction</code></li>
<li><code>transaction\DestroyItemAction</code></li>
</ul>
</li>
<li>以下のクラスはリネーム/移動されました。<ul>
<li><code>ContainerInventory</code> -&gt; <code>pocketmine\block\inventory\BlockInventory</code></li>
</ul>
</li>
<li>以下のクラスは名前空間<code>pocketmine\block\inventory</code> に移動されました。<ul>
<li><code>AnvilInventory</code></li>
<li><code>ChestInventory</code></li>
<li><code>DoubleChestInventory</code></li>
<li><code>EnchantInventory</code></li>
<li><code>EnderChestInventory</code></li>
<li><code>FurnaceInventory</code></li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>CustomInventory</code></li>
<li><code>InventoryEventProcessor</code></li>
<li><code>Recipe</code></li>
<li><code>transaction\CreativeInventoryAction</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Inventory-&gt;addChangeListeners()</code></li>
<li><code>Inventory-&gt;getChangeListeners()</code></li>
<li><code>Inventory-&gt;removeChangeListeners()</code></li>
<li><code>Inventory-&gt;swap()</code>: 二つのスロットのコンテンツを入れ替えます。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>BaseInventory-&gt;getDefaultSize()</code></li>
<li><code>BaseInventory-&gt;setSize()</code></li>
<li><code>Inventory-&gt;close()</code></li>
<li><code>Inventory-&gt;dropContents()</code></li>
<li><code>Inventory-&gt;getName()</code></li>
<li><code>Inventory-&gt;getTitle()</code></li>
<li><code>Inventory-&gt;onSlotChange()</code></li>
<li><code>Inventory-&gt;open()</code></li>
<li><code>Inventory-&gt;sendContents()</code></li>
<li><code>Inventory-&gt;sendSlot()</code></li>
<li><code>InventoryAction-&gt;onExecuteFail()</code></li>
<li><code>InventoryAction-&gt;onExecuteSuccess()</code></li>
<li><code>PlayerInventory-&gt;sendCreativeContents()</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変更されました。<ul>
<li><code>Inventory-&gt;clear()</code>は<code>bool</code>の代わりに現在では<code>void</code>を返します。</li>
<li><code>Inventory-&gt;setItem()</code>は<code>bool</code>の代わりに現在では<code>void</code>を返します。</li>
<li><code>InventoryAction-&gt;execute()</code>は<code>bool</code>の代わりに現在では<code>void</code>を返します。</li>
<li><code>BaseInventory-&gt;construct()</code>は初期化用のアイテムリストを受け取らなくなりました。</li>
</ul>
</li>
<li><code>PlayerInventory-&gt;setItemInHand()</code>は現在ではそのプレイヤーが見える人にアイテム更新を送信します。</li>
</ul>
<h4 id="api4-changelogs-item">Item</h4>
<h5 id="api4-changelogs-general_1">General</h5>
<ul>
<li>新たに<code>VanillaItems</code>クラスが追加されました。すべての既知のアイテムタイプを生成する静的メソッドを含んでいます。これは定数が使われている<code>ItemFactory::get()</code>の代わりとして使われることが好ましいです。</li>
<li><code>StringToItemParser</code>が追加されました。あらゆる文字列をIDに関係なくアイテムへとマッピングすることができるようになりました。これらのマッピングは<code>/give</code>と<code>/clear</code>で使われていて、プラグインでのカスタムエイリアスを念頭に置いて作られています。<ul>
<li>つまり、見苦しいハックなしに<code>/give</code>のカスタムエイリアスが追加できるようになったということです。</li>
</ul>
</li>
<li><code>LegacyStringToItemParser</code>が追加されました。これは少しだけ動的な(しかし推奨はされない)<code>ItemFactory::fromString()</code>の置き換えです。</li>
<li><code>Item-&gt;count</code>はアクセス権がpublicから変更されました。</li>
<li>書き込める本(本と羽ペン,記入済みの本)のヒエラルキーが変更されました。<code>WritableBook</code>と<code>WrittenBook</code>は現在では<code>WritableBookBase</code>を継承します。</li>
<li>以下のAPIはシグネチャが変更されました。<ul>
<li><code>WritableBookBase-&gt;setPages()</code>は現在では<code>CompoundTag[]</code>の代わりに<code>WritableBookPage[]</code>を受け付けます。</li>
<li><code>ItemFactory::get()</code>は<code>string</code>を<code>tags</code>パラメータとして受け付けなくなりました。</li>
<li><code>ItemFactory::fromString()</code>は<code>$multiple</code>パラメータを受け取らなくなり、<code>Item|Item[]</code>ではなく<code>Item</code>のみを返すようになりました。</li>
</ul>
</li>
<li>以下のメソッドはメソッドチェーンが利用できるようになりました。(原文: The following methods are now fluent)<ul>
<li><code>WritableBookBase-&gt;setPages()</code></li>
<li><code>Item-&gt;addEnchantment()</code></li>
<li><code>Item-&gt;removeEnchantment()</code></li>
<li><code>Item-&gt;removeEnchantments()</code></li>
<li><code>Armor-&gt;setCustomColor()</code></li>
<li><code>WrittenBook-&gt;setTitle()</code></li>
<li><code>WrittenBook-&gt;setAuthor()</code></li>
<li><code>WrittenBook-&gt;setGeneration()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Item-&gt;getNamedTagEntry()</code></li>
<li><code>Item-&gt;removeNamedTagEntry()</code></li>
<li><code>Item-&gt;setDamage()</code>: 現在では<code>Durable</code>を実装しているアイテム以外ではダメージは不変です。</li>
<li><code>Item-&gt;setNamedTagEntry()</code></li>
<li><code>Item::get()</code>: これはずいぶん前に<code>ItemFactory::get()</code>にとってかわられました。</li>
<li><code>Item::fromString()</code>: これはずいぶん前に<code>ItemFactory::fromString()</code>にとってかわられました。</li>
<li><code>Item-&gt;setCompoundTag()</code></li>
<li><code>Item-&gt;getCompoundTag()</code></li>
<li><code>Item-&gt;hasCompoundTag()</code></li>
<li><code>Potion::getPotionEffectsById()</code></li>
<li><code>ProjectileItem-&gt;getProjectileEntityType()</code></li>
</ul>
</li>
<li>以下の定数は削除されました。<ul>
<li><code>Potion::ALL</code> - <code>PotionType::getAll()</code>を代わりに使ってください。</li>
<li><code>Potion::WATER</code></li>
<li><code>Potion::MUNDANE</code></li>
<li><code>Potion::LONG_MUNDANE</code></li>
<li><code>Potion::THICK</code></li>
<li><code>Potion::AWKWARD</code></li>
<li><code>Potion::NIGHT_VISION</code></li>
<li><code>Potion::LONG_NIGHT_VISION</code></li>
<li><code>Potion::INVISIBILITY</code></li>
<li><code>Potion::LONG_INVISIBILITY</code></li>
<li><code>Potion::LEAPING</code></li>
<li><code>Potion::LONG_LEAPING</code></li>
<li><code>Potion::STRONG_LEAPING</code></li>
<li><code>Potion::FIRE_RESISTANCE</code></li>
<li><code>Potion::LONG_FIRE_RESISTANCE</code></li>
<li><code>Potion::SWIFTNESS</code></li>
<li><code>Potion::LONG_SWIFTNESS</code></li>
<li><code>Potion::STRONG_SWIFTNESS</code></li>
<li><code>Potion::SLOWNESS</code></li>
<li><code>Potion::LONG_SLOWNESS</code></li>
<li><code>Potion::WATER_BREATHING</code></li>
<li><code>Potion::LONG_WATER_BREATHING</code></li>
<li><code>Potion::HEALING</code></li>
<li><code>Potion::STRONG_HEALING</code></li>
<li><code>Potion::HARMING</code></li>
<li><code>Potion::STRONG_HARMING</code></li>
<li><code>Potion::POISON</code></li>
<li><code>Potion::LONG_POISON</code></li>
<li><code>Potion::STRONG_POISON</code></li>
<li><code>Potion::REGENERATION</code></li>
<li><code>Potion::LONG_REGENERATION</code></li>
<li><code>Potion::STRONG_REGENERATION</code></li>
<li><code>Potion::STRENGTH</code></li>
<li><code>Potion::LONG_STRENGTH</code></li>
<li><code>Potion::STRONG_STRENGTH</code></li>
<li><code>Potion::WEAKNESS</code></li>
<li><code>Potion::LONG_WEAKNESS</code></li>
<li><code>Potion::WITHER</code></li>
</ul>
</li>
<li>以下のメソッドはリネームされました。<ul>
<li><code>Item-&gt;getDamage()</code> -&gt; <code>Item-&gt;getMeta()</code></li>
</ul>
</li>
<li>以下のメソッドは <code>pocketmine\inventory\CreativeInventory</code>へと移動されました:<ul>
<li><code>Item::addCreativeItem()</code> -&gt; <code>CreativeInventory::add()</code></li>
<li><code>Item::clearCreativeItems()</code> -&gt; <code>CreativeInventory::clear()</code></li>
<li><code>Item::getCreativeItemIndex()</code> -&gt; <code>CreativeInventory::getItemIndex()</code></li>
<li><code>Item::getCreativeItems()</code> -&gt; <code>CreativeInventory::getAll()</code></li>
<li><code>Item::initCreativeItems()</code> -&gt; <code>CreativeInventory::init()</code></li>
<li><code>Item::isCreativeItem()</code> -&gt; <code>CreativeInventory::contains()</code></li>
<li><code>Item::removeCreativeItem()</code> -&gt; <code>CreativeInventory::remove()</code></li>
</ul>
</li>
<li>以下のクラスが追加されました。<ul>
<li><code>ArmorTypeInfo</code></li>
<li><code>Fertilizer</code></li>
<li><code>LiquidBucket</code></li>
<li><code>MilkBucket</code></li>
<li><code>PotionType</code>: バニラのポーションタイプについての情報を保持する列挙クラス</li>
<li><code>WritableBookBase</code></li>
<li><code>WritableBookPage</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Armor-&gt;getArmorSlot()</code></li>
<li><code>Item-&gt;canStackWith()</code>: 二つのアイテムが数量やサイズ上限は考慮せずに、同じアイテムスロットで保持できるかを返します。</li>
<li><code>Potion-&gt;getType()</code>: 適用されるエッふぇくとなどの情報をもつ<code>PotionType</code>列挙オブジェクトを返します。</li>
<li><code>ProjectileItem-&gt;createEntity()</code>: 投げられるプロジェクタイルエンティティの新規インスタンスを返します。</li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>ChainBoots</code></li>
<li><code>ChainChestplate</code></li>
<li><code>ChainHelmet</code></li>
<li><code>ChainLeggings</code></li>
<li><code>DiamondBoots</code></li>
<li><code>DiamondChestplate</code></li>
<li><code>DiamondHelmet</code></li>
<li><code>DiamondLeggings</code></li>
<li><code>GoldBoots</code></li>
<li><code>GoldChestplate</code></li>
<li><code>GoldHelmet</code></li>
<li><code>GoldLeggings</code></li>
<li><code>IronBoots</code></li>
<li><code>IronChesplate</code></li>
<li><code>IronHelmet</code></li>
<li><code>IronLeggings</code></li>
<li><code>LeatherBoots</code></li>
<li><code>LeatherCap</code></li>
<li><code>LeatherPants</code></li>
<li><code>LeatherTunic</code></li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-nbt-handling">NBT handling</h5>
<ul>
<li>シリアライズされたNBTバイト配列キャッシュはアイテムスタックに保持されなくなりました。これらのキャッシュはネットワークレイヤーシリアライズに用いられる早すぎる最適化であり、それ自体がネットワークNBT形式に依存していました。</li>
<li>内部NBTの利用は周縁化されます。 もはや即座に変更点をNBTへ書き込む必要はありません。以下のフックが追加されます:<ul>
<li><code>Item-&gt;serializeCompoundTag()</code></li>
<li><code>Item-&gt;deserializeCompoundTag()</code></li>
</ul>
</li>
<li>実行時NBTをアイテムから完全に取り除くことが計画されていますが、現段階では未解決の後方互換性の問題があります。</li>
</ul>
<h5 id="api4-changelogs-enchantment">Enchantment</h5>
<ul>
<li><code>VanillaEnchantments</code>クラスが追加されました。これはバニラのすべてのエンチャントを静的メソッドとして公開していて、 <code>Enchantment::get()</code>の意地の悪さを置き換えます。<ul>
<li>例: <code>Enchantment::get(Enchantment::PROTECTION)</code>は<code>VanillaEnchantments::PROTECTION()</code>で置き換えられました。</li>
<li>これらのメソッドは<code>Enchantment</code>の代わりに適切なタイプの情報を静的解析に渡し、コーディングがしやすくなりました。</li>
</ul>
</li>
<li>MCPEのエンチャントIDとPocketMine-MP内部のIDの境目がより明確になりました。<ul>
<li>IDハンドリングは<code>pocketmine\data\bedrock\EnchantmentIdMap</code>へ移動しました。</li>
<li>すべてのエンチャントID定数は<code>Enchantment</code>から削除されました。何らかの理由でレガシーエンチャントIDが必要なら<code>pocketmine\data\bedrock\EnchantmentIds</code>を利用してください。</li>
</ul>
</li>
<li><code>Enchantment::RARITY_*</code>定数は<code>Rarity</code>に移動され、<code>RARITY_</code>プレフィックスは削除されました。</li>
<li><code>Enchantment::SLOT_*</code>定数は<code>ItemFlags</code>に移動され、<code>SLOT_</code>プレフィックスは削除されました。</li>
<li>以下のAPIメソッドは移動されました。<ul>
<li><code>Enchantment::registerEnchantment()</code> -&gt; <code>EnchantmentIdMap-&gt;register()</code></li>
<li><code>Enchantment::getEnchantment()</code> -&gt; <code>EnchantmentIdMap-&gt;fromId()</code></li>
<li><code>Enchantment-&gt;getId()</code> -&gt; <code>EnchantmentIdMap-&gt;toId()</code></li>
<li><code>Enchantment::getEnchantmentByName()</code> -&gt; <code>VanillaEnchantments::fromString()</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Enchantment-&gt;getRuntimeId()</code>: これは<strong>動的ID</strong>でありエンチャントタイプの比較に用いることができます。<strong>これは決して保持されないため、configやNBTでは利用しないでください！</strong></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-lang">Lang</h4>
<ul>
<li>以下のクラスはリネームされました。<ul>
<li><code>BaseLang</code> -&gt; <code>Language</code></li>
<li><code>TranslationContainer</code> -&gt; <code>Translatable</code></li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>TextContainer</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Translatable-&gt;format()</code>: 変換に対してフォーマット(カラーコードなど)を追加できます。</li>
<li><code>Translatable-&gt;prefix()</code>: プレフィックスを追加できます。</li>
<li><code>Translatable-&gt;postfix()</code>: ポストフィキシングを追加できます。</li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変更されました。<ul>
<li><code>Translatable-&gt;__construct()</code>は現在では<code>list&lt;string&gt;</code>だけではなく<code>array&lt;int|string, Translatable|string&gt;</code>をパラメータとして受け取ります。</li>
<li><code>Translatable-&gt;getParameter()</code>は現在では<code>int</code>だけではなく<code>int|string</code>をインデックスとして受け取ります。</li>
<li><code>Translatable-&gt;getParameter()</code>は現在では<code>string</code>だけではなく<code>Translatable|string</code>を返します。</li>
<li><code>Translatable-&gt;getParameters()</code>は現在では<code>array&lt;int|string, Translatable|string&gt;</code>を返します。</li>
</ul>
</li>
<li><code>LanguageNotFoundException</code>が追加されました。これはサーバーファイルに存在しない<code>Language</code>を構成しようとした際に投げられます。</li>
<li><code>Translatable</code>は現在では変換パラメータのキーを無視しなくなりました。以前までは挿入される順番のみが考慮されていました。</li>
<li><code>Translatable</code>は変換パラメータの文字列キーをサポートするようになりました。</li>
<li><code>Translatable</code>は現在では、他の<code>Translatable</code>を変換パラメータとして提供することをサポートします。</li>
<li><code>Language-&gt;translateString()</code>は現在では、<code>Translatable</code>を変換パラメータとして提供することをサポートします。</li>
<li><code>Language-&gt;translateString()</code>は自動的な文字列パラメータ変換を試みなくなりました。もし変換したければ、明示的に変換する必要があります。これによりプレイヤーが変換キーを含むメッセージを送信した際に図らずも変換されてしまうバグが修正されます。</li>
<li><code>Language-&gt;translate()</code>は<code>Translatable</code>の文字列パラメータを変換しなくなりました。(上で指摘した点と同様)</li>
</ul>
<h4 id="api4-changelogs-network">Network</h4>
<ul>
<li>以下のフィールドが削除されました。<ul>
<li><code>Network::$BATCH_THRESHOLD</code></li>
</ul>
</li>
<li>以下のクラスがリネームされました。<ul>
<li><code>SourceInterface</code> -&gt; <code>NetworkInterface</code></li>
<li><code>AdvancedSourceInterface</code> -&gt; <code>AdvancedNetworkInterface</code></li>
</ul>
</li>
<li>以下のクラスが移動されました。<ul>
<li><code>CompressBatchedTask</code> -&gt; <code>mcpe\CompressBatchTask</code></li>
<li><code>level\format\io\ChunkRequestTask</code> -&gt; <code>mcpe\ChunkRequestTask</code></li>
<li><code>mcpe\RakLibInterface</code> -&gt; <code>mcpe\raklib\RakLibInterface</code></li>
</ul>
</li>
<li>以下のクラスが削除されました。<ul>
<li><code>mcpe\PlayerNetworkSessionAdapter</code></li>
</ul>
</li>
<li>以下のメソッドがリネームされました。<ul>
<li><code>UPnP::PortForward()</code> -&gt; <code>UPnP::portForward()</code></li>
<li><code>UPnP::RemovePortForward()</code> -&gt; <code>UPnP::removePortForward()</code></li>
</ul>
</li>
<li>以下のメソッドはシグネチャが変更されました。<ul>
<li><code>UPnP::portForward()</code>は<code>string $serviceURL, string $internalIP, int $internalPort, int $externalPort</code>を受け取るようになりました。</li>
<li><code>UPnP::removePortForward()</code>は<code>string $serviceURL, int $externalPort</code>を受け取るようになりました。</li>
</ul>
</li>
<li>以下のメソッドは削除されました。<ul>
<li><code>NetworkInterface-&gt;putPacket()</code></li>
<li><code>NetworkInterface-&gt;close()</code></li>
<li><code>NetworkInterface-&gt;emergencyShutdown()</code></li>
</ul>
</li>
<li><code>NetworkInterface</code>はプレイヤーネットワークインターフェースに特化するものではなく、現在ではいかなるネットワークコンポーネントにも実装されるためにより汎用なインターフェースを表します。</li>
<li><code>rcon</code>サブ名前空間以下にあるものはすべて削除されました。</li>
<li><code>upnp\UPnP</code>には重大な変更点があります。これは現在では二つの静的メソッドではなくネットワークコンポーネントになりました。</li>
</ul>
<h4 id="api4-changelogs-permission">Permission</h4>
<ul>
<li>以下の新規許可ノードが導入されます。<ul>
<li><code>pocketmine.group.everyone</code>: デフォルトで全員に与えられます。</li>
<li><code>pocketmine.group.operator</code>: OPのプレイヤーとコンソールに与えられます。
これらの許可ノードはほかのノードと同様に許可付与によって割り当て・上書き可能です。つまり、現在ではプレイヤー切断時(や付与が外れた際)に無くなる<strong>一時的OP</strong>状態を与えることができます。 </li>
</ul>
</li>
<li>許可が明示的にセットされていない時やほかの許可により暗示的に付与されている場合には、現在では常にfalseとなるようになりました。</li>
<li>定義されていない許可は<code>Permission::$DEFAULT_PERMISSION</code>ではなく、現在では常に<code>false</code>となりました。</li>
<li>許可は内部的にデフォルト値を持たなくなりました。 その代わりに、デフォルト値は<code>pocketmine.group</code>の子として許可として割り当てられます。<ul>
<li><code>true</code>: <code>pocketmine.group.everyone</code>に子として値<code>true</code>で追加する</li>
<li><code>false</code>: いかなる許可にも与えない</li>
<li><code>op</code>: <code>pocketmine.group.operator</code>に子として値<code>true</code>で追加する</li>
<li><code>notop</code>: <code>pocketmine.group.everyone</code>に子として値<code>true</code>で、<code>pocketmine.group.operator</code>に<code>false</code>で追加する
しかし、<code>plugin.yml</code>での許可定義での<code>default</code>キーはサポートされ続けます。</li>
</ul>
</li>
<li><code>PermissibleBase</code>を利用する際のひな形を減らすために<code>PermissibleDelegateTrait</code>が追加されました。このトレイトは<code>ConsoleCommandSender</code>と<code>Player</code>で利用されています。</li>
<li>以下のAPIメソッドは移動されました。<ul>
<li><code>Permission::getByName()</code> -&gt; <code>PermissionParser::defaultFromString()</code></li>
<li><code>Permission::loadPermissions()</code> -&gt; <code>PermissionParser::loadPermissions()</code></li>
<li><code>Permission::loadPermission()</code> -&gt; <code>PermissionParser::loadPermission()</code></li>
</ul>
</li>
<li>以下の定数は移動されました。<ul>
<li><code>Permission::DEFAULT_FALSE</code> -&gt; <code>PermissionParser::DEFAULT_FALSE</code></li>
<li><code>Permission::DEFAULT_TRUE</code> -&gt; <code>PermissionParser::DEFAULT_TRUE</code></li>
<li><code>Permission::DEFAULT_OP</code> -&gt; <code>PermissionParser::DEFAULT_OP</code></li>
<li><code>Permission::DEFAULT_NOT_OP</code> -&gt; <code>PermissionParser::DEFAULT_NOT_OP</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Permission-&gt;addChild()</code></li>
<li><code>Permission-&gt;removeChild()</code></li>
<li><code>Permissible-&gt;getPermissionRecalculationCallbacks()</code> - 新規許可が与えられたり拒否されたりなど、許可の変更に対しての反応が行えるようになります。</li>
<li><code>Permissible-&gt;setBasePermission()</code> - <code>pocketmine.group.operator</code>などのルート許可を割り当てる際に使用されます。通常プラグインでは使用するべきではありません。</li>
<li><code>Permissible-&gt;unsetBasePermission()</code></li>
<li><code>PermissionAttachmentInfo-&gt;getGroupPermissionInfo()</code> - 許可の<code>PermissionAttachmentInfo</code>を返します。これは現在の許可の値を定めたり、許可が明らかなときには空にするものです。</li>
</ul>
</li>
<li>以下のAPIメソッドが削除されました。<ul>
<li><code>Permissible-&gt;isOp()</code>: <code>Permissible-&gt;hasPermission(DefaultPermissions::ROOT_OPERATOR)</code>を代わりに使用してください。 <strong>ただし、プレイヤーがOPかどうかには直接的に依存するべきではありません。そのプラグイン固有の許可を与えてください。</strong></li>
<li><code>Permissible-&gt;setOp()</code>: <code>addAttachment($plugin, DefaultPermissions::ROOT_OPERATOR, true)</code>を追加時に、<code>removeAttachment()</code>を削除時に使用してください。(もしくは<code>addAttachment()</code>をfalseで使うとほかの許可と同様に明示的に拒否することもできます)</li>
<li><code>Permission-&gt;addParent()</code></li>
<li><code>Permission-&gt;getDefault()</code></li>
<li><code>Permission-&gt;setDefault()</code></li>
<li><code>PermissionManager-&gt;getDefaultPermissions()</code></li>
<li><code>PermissionManager-&gt;recalculatePermissionDefaults()</code></li>
<li><code>PermissionManager-&gt;subscribeToDefaultPerms()</code></li>
<li><code>PermissionManager-&gt;unsubscribeFromDefaultPerms()</code></li>
<li><code>PermissionManager-&gt;getDefaultPermSubscriptions()</code></li>
<li><code>PermissionAttachment-&gt;getPermissible()</code></li>
<li><code>PermissionAttachmentInfo-&gt;getPermissible()</code></li>
</ul>
</li>
<li>以下のフィールドは削除されました。<ul>
<li><code>Permission::$DEFAULT_PERMISSION</code></li>
</ul>
</li>
<li>以下のAPIは変更されました。<ul>
<li><code>PermissionParser::defaultFromString()</code>は現在では未知の値を渡されたときに<code>InvalidArgumentException</code>を投げるようになりました。</li>
<li><code>Permission-&gt;__construct()</code>は現在では<code>$defaultValue</code>パラメータを受け取らなくなりました(上記のデフォルト値に関するリファクタに関するノートを参照してください)。代わりに<code>pocketmine.group.everyone</code>か<code>pocketmine.group.operator</code>の子要素として許可を与える必要があります。</li>
</ul>
</li>
<li>以下のクラスは削除されました。<ul>
<li><code>ServerOperator</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-player">Player</h4>
<ul>
<li>以下のクラスは新規名前空間<code>pocketmine\Player</code>に移動されました。<ul>
<li><code>Achievement</code></li>
<li><code>GameMode</code></li>
<li><code>IPlayer</code></li>
<li><code>OfflinePlayer</code></li>
<li><code>PlayerInfo</code></li>
<li><code>Player</code></li>
</ul>
</li>
<li>以下の定数は削除されました<ul>
<li><code>Player::SURVIVAL</code> - <code>GameMode::SURVIVAL()</code>を使用してください</li>
<li><code>Player::CREATIVE</code> - <code>GameMode::CREATIVE()</code>を使用してください</li>
<li><code>Player::ADVENTURE</code> - <code>GameMode::ADVENTURE()</code>を使用してください</li>
<li><code>Player::SPECTATOR</code> - <code>GameMode::SPECTATOR()</code>を使用してください</li>
<li><code>Player::VIEW</code> - <code>GameMode::SPECTATOR()</code>を使用してください</li>
</ul>
</li>
<li>(ほぼ)すべてのパケットハンドラーは<code>プレイヤー</code>から除去されました。これらのハンドラーはネットワークレイヤー内にカプセル化されました</li>
<li><code>Player-&gt;getSpawn()</code>は現在ではプレイヤーのスポーン地点が設定されていないときにワールドのセーフスポーンを返さなくなりました。コールしたときのセーフスポーンを返すというのは意味がありません。実際に使われるときにセーフスポーンであるとは限らないからです。セーフスポーンを取得したい場合には<code>World-&gt;getSafeSpawn()</code>にこの関数の返り値を渡してください。</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Player-&gt;attackBlock()</code>: ターゲットブロックを殴る(左クリック), 例. ブロックの破壊を開始(サバイバル)</li>
<li><code>Player-&gt;attackEntity()</code>: (範囲内にいれば)ターゲットエンティティを素手攻撃(左クリック)</li>
<li><code>Player-&gt;breakBlock()</code>: 現在のワールドのターゲットブロックを(即座に)破壊する</li>
<li><code>Player-&gt;consumeHeldItem()</code>: 以前にアクティベートされたアイテムを消費する, 例. 食べ物を食べる</li>
<li><code>Player-&gt;continueBreakBlock()</code>: サバイバル時に破壊アニメーションとパーティクルを生成しながらターゲットブロックを殴る</li>
<li><code>Player-&gt;getItemCooldownExpiry()</code>: 与えられたアイテムのクールダウンが失効するtickを返す</li>
<li><code>Player-&gt;hasFiniteResources()</code></li>
<li><code>Player-&gt;interactBlock()</code>: 現在のワールドのターゲットブロックを触る(右クリック)</li>
<li><code>Player-&gt;interactEntity()</code>: ターゲットエンティティを触る(右クリック), 例. エンティティに名札で名前をつける</li>
<li><code>Player-&gt;pickBlock()</code>: 現在のワールドのターゲットブロックをピックする(マウスホイールクリック)</li>
<li><code>Player-&gt;releaseHeldItem()</code>: 以前にアクティベートされたアイテムをリリースする, 例. 竿を振る</li>
<li><code>Player-&gt;selectHotbarSlot()</code>: 特定のホットバースロットを選択する</li>
<li><code>Player-&gt;stopBreakBlock()</code>: それ以前に攻撃されていたブロックへの攻撃をやめる</li>
<li><code>Player-&gt;toggleFlight()</code>: 飛行を開始/停止しようとする (イベントを発火し、キャンセルされる可能性がある)</li>
<li><code>Player-&gt;updateNextPosition()</code>: プレイヤーの次に試みられる移動場所を設定する (イベントを発火し、キャンセルされる可能性がある)</li>
<li><code>Player-&gt;useHeldItem()</code>: 持っているアイテムをアクティベートする, 例. 雪玉を投げる</li>
<li><code>Player-&gt;getSaveData()</code>: その場でセーブデータを生成し、セーブデータを返す。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Player-&gt;addActionBarMessage()</code>: <code>sendActionBarMessage()</code>に置き換えられました。</li>
<li><code>Player-&gt;addSubTitle()</code>: <code>sendSubTitle()</code>に置き換えられました。</li>
<li><code>Player-&gt;addTitle()</code>: <code>sendTitle()</code>に置き換えられました。</li>
<li><code>Player-&gt;getAddress()</code>: <code>NetworkSession-&gt;getIp()</code>に置き換えられました。</li>
<li><code>Player-&gt;getPing()</code>: <code>NetworkSession</code>に移動されました。</li>
<li><code>Player-&gt;getPort()</code>: <code>NetworkSession</code>に移動されました。</li>
<li><code>Player-&gt;updatePing()</code>: <code>NetworkSession</code>に移動されました。</li>
<li><code>Player-&gt;dataPacket()</code>: <code>NetworkSession-&gt;sendDataPacket()</code>に置き換えられました。</li>
<li><code>Player-&gt;sendDataPacket()</code>: <code>NetworkSession-&gt;sendDataPacket()</code>に置き換えられました。</li>
<li><code>Player-&gt;updateNextPosition()</code>: <code>Player-&gt;handleMovement()</code>を代わりに使用してください。</li>
<li><code>IPlayer-&gt;isWhitelisted()</code>: <code>Server-&gt;isWhitelisted()</code>を代わりに使用してください。</li>
<li><code>IPlayer-&gt;setWhitelisted()</code>: <code>Server-&gt;setWhitelisted()</code>を代わりに使用してください。</li>
<li><code>IPlayer-&gt;isBanned()</code>: これはネームBANのみをチェックしプラグインによる独自のBANシステムについて把握していなかったため信頼性に欠けていました。<code>Server-&gt;getNameBans()-&gt;isBanned()</code>と<code>Server-&gt;getIPBans()-&gt;isBanned()</code>を代わりに使用してください。</li>
<li><code>IPlayer-&gt;setBanned()</code>: <code>Server</code>のAPIを代わりに使用してください。</li>
<li><code>IPlayer-&gt;isOp()</code>: <code>Server</code>のAPIを代わりに使用してください。</li>
<li><code>IPlayer-&gt;setOp()</code>: <code>Server</code>のAPIを代わりに使用してください。</li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-plugin">Plugin</h4>
<ul>
<li>APIバージョンのチェックがより厳格になりました。現在では同じメジャーバージョン内における複数の最小バージョンの宣言をすることができなくなりました。複数宣言した場合、プラグインは読み込みに失敗し、<code>Multiple minimum API versions found for some major versions</code>というメッセージが表示されます。</li>
<li><code>plugin.yml</code>のYAMLコマンドのロードは<code>PluginBase</code>に取り込まれました。</li>
<li><code>PluginManager-&gt;registerEvent()</code>はよりシンプルなシグネチャを持つようになります: <code>registerEvent(string $event, \Closure $handler, int $priority, Plugin $plugin, bool $handleCancelled = false)</code>。 与えられるクロージャーはその唯一のパラメータとしてその特定のイベントのみを受け取る必要があります. 詳しくは<a href="#api4-changelogs-event">Event APIの変更</a>をご覧ください。</li>
<li>以下のクラスは削除されました。<ul>
<li><code>PluginLogger</code></li>
</ul>
</li>
<li>以下の定数は削除されました。<ul>
<li><code>PluginLoadOrder::STARTUP</code> - <code>PluginEnableOrder::STARTUP()</code>を使用してください。</li>
<li><code>PluginLoadOrder::POSTWORLD</code> - <code>PluginEnableOrder::POSTWORLD()</code>を使用してください。</li>
</ul>
</li>
<li>以下のインターフェース要求は削除されました。<ul>
<li><code>Plugin-&gt;onEnable()</code>: <code>PluginBase</code>に取り込まれました。</li>
<li><code>Plugin-&gt;onDisable()</code>: 同上</li>
<li><code>Plugin-&gt;onLoad()</code>: 同上</li>
<li><code>Plugin-&gt;getServer()</code>は実装が要求されなくなりました。利便性のために<code>PluginBase</code>に実装されます。</li>
<li><code>Plugin-&gt;isDisabled()</code>は削除されました。(<code>Plugin-&gt;isEnabled()</code>を代わりに使用してください)</li>
<li><code>Plugin</code>は<code>CommandExecutor</code>を継承しなくなりました。つまりこれは<code>Plugin</code>実装は<code>onCommand()</code>をこれからは実装する必要がないことを表します。</li>
</ul>
</li>
<li>以下のフックメソッドはアクセス権が変更されました。<ul>
<li><code>PluginBase-&gt;onEnable()</code>は<code>public</code>から<code>protected</code>に変更されました。</li>
<li><code>PluginBase-&gt;onDisable()</code>は<code>public</code>から<code>protected</code>に変更されました。</li>
<li><code>PluginBase-&gt;onLoad()</code>は<code>public</code>に<code>protected</code>変更されました。</li>
</ul>
</li>
<li>以下のフックメソッドはリネームされました。<ul>
<li><code>Plugin-&gt;setEnabled()</code> -&gt; <code>Plugin-&gt;onEnableStateChange()</code> - この変更はプラグイン開発者に、このフックメソッドを誤って使わせないようにしこのメソッドが行うことをより正確に説明する名前を与えるためのものです。</li>
</ul>
</li>
<li>以下の(非推奨の)APIメソッドは削除されました。<ul>
<li><code>PluginManager-&gt;callEvent()</code>: <code>Event-&gt;call()</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;addPermission()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;getDefaultPermSubscriptions()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;getDefaultPermissions()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;getPermission()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;getPermissionSubscriptions()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;getPermissions()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;recalculatePermissionDefaults()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;removePermission()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;subscribeToDefaultPerms()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;subscribeToPermission()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;unsubscribeFromDefaultPerms()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
<li><code>PluginManager-&gt;unsubscribeFromPermission()</code>: <code>PermissionManager</code>を代わりに使用してください。</li>
</ul>
</li>
<li><code>PluginBase-&gt;onEnable()</code>や<code>PluginBase-&gt;onLoad()</code>で例外を投げることは許可されなくなりました。現在では例外を投げるとサーバーがクラッシュします。</li>
</ul>
<h4 id="api4-changelogs-scheduler">Scheduler</h4>
<h5 id="api4-changelogs-asynctask">AsyncTaskのためのスレッドローカルストレージ</h5>
<ul>
<li>TLSは自己完結し、より安定し、使いやすくなるようにこのリリースで完全に書き直されました。</li>
<li>そして、よりシンプルなプロパティのように振る舞います。<code>storeLocal()</code> は書き込み、 <code>fetchLocal()</code> は読み込みです。</li>
<li>自己完結し、その後クリーンアップするために非同期プールに依存もしません。</li>
<li>値は <code>AsyncTask</code> がガベージコレクトされたときに、通常のプロパティと同様に自動的に削除されます。</li>
<li>複数の値を文字列の名前で識別して保存できます。</li>
<li><code>fetchLocal()</code> は複数回使えるようになりました。保存されている値を削除することはなくなりました。</li>
<li>以下のクラスは削除されました。<ul>
<li><code>FileWriteTask</code></li>
</ul>
</li>
<li>以下のメソッドは削除されました。<ul>
<li><code>AsyncTask-&gt;peekLocal()</code>: <code>fetchLocal()</code> を代わりに使用してください。</li>
</ul>
</li>
<li>以下のメソッドはシグネチャが変わりました。<ul>
<li><code>AsyncTask-&gt;storeLocal()</code> は <code>storeLocal(string $key, mixed $complexData) : void</code> をシグネチャに持ちます。</li>
<li><code>AsyncTask-&gt;fetchLocal()</code> は <code>fetchLocal(string $key) : mixed</code> をシグネチャに持ちます。</li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-_18">その他の変更</h5>
<ul>
<li><code>AsyncPool</code> は新しく、かなり効率の良いアルゴリズムをタスクコレクションに使用します。</li>
<li><code>BulkCurlTask</code> のコンストラクタ引数 <code>$complexData</code> は削除されました。</li>
<li><code>BulkCurlTask-&gt;__construct()</code> は <code>mixed[]</code> の代わりに <code>BulkCurlTaskOperation[]</code> を受け取ります。</li>
<li><code>CancelTaskException</code> が追加されました。これは、 <code>Task::onRun()</code> からタスクをキャンセルするために投げられます。（特に <code>ClosureTask</code> に便利です）</li>
<li><code>pocketmine\Collectable</code> は削除され、 <code>AsyncTask</code> から継承されなくなりました。</li>
<li>以下のフックが追加されました。<ul>
<li><code>AsyncTask-&gt;onError()</code>: メインスレッドにおいて非同期処理でメモリ不足などの制御不能なエラーを検知したときに呼び出されます。</li>
</ul>
</li>
<li>以下のフックはシグネチャが変わりました。<ul>
<li><code>AsyncTask-&gt;onCompletion()</code> は <code>Server</code> パラメーターを受け取らなくなり、 <code>void</code> を戻り値の型とします。</li>
<li><code>AsyncTask-&gt;onProgressUpdate()</code> は <code>Server</code> パラメーターを受け取らなくなり、 <code>void</code> を戻り値の型とします。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>AsyncTask-&gt;getFromThreadStore()</code>: <code>AsyncTask-&gt;worker-&gt;getFromThreadStore()</code> を代わりに使用してください。</li>
<li><code>AsyncTask-&gt;removeFromThreadStore()</code>: <code>AsyncTask-&gt;worker-&gt;removeFromThreadStore()</code> を代わりに使用してください。</li>
<li><code>AsyncTask-&gt;saveToThreadStore()</code>: <code>AsyncTask-&gt;worker-&gt;saveToThreadStore()</code> を代わりに使用してください。</li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-server">Server</h4>
<ul>
<li>権限システムに依存しない、新しいチャット配信APIが実装されました。<ul>
<li>以下のAPIメソッドが追加されました。</li>
<li><code>subscribeToBroadcastChannel()</code> - チャット（及びその他の種類の）メッセージを受信するために、<code>CommandSender</code>をサブスクライブできます。</li>
<li><code>unsubscribeFromBroadcastChannel()</code></li>
<li><code>unsubscribeFromAllBroadcastChannels()</code></li>
<li><code>getBroadcastChannelSubscribers()</code></li>
<li><code>Player</code>に<code>pocketmine.broadcast.*</code>のいずれかの権限を与えると、自動的に対応するブロードキャストチャンネルに加入できます。（権限を削除すると登録も解除されます）</li>
<li>権限を使わずにカスタムブロードキャストチャンネルを作成・登録できるようになりました。</li>
<li>しかし、<code>Player</code>達が適切な権限を持っていなければ、内蔵ブロードキャストチャンネルからは自動的に登録解除されるでしょう。</li>
<li>カスタムブロードキャストチャンネルからの自動的な登録/登録解除は新しい<code>Permissible</code>権限再計算コールバックAPI使用して実装できます。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>reloadWhitelist()</code></li>
<li><code>getLevelMetadata()</code></li>
<li><code>getPlayerMetadata()</code></li>
<li><code>getEntityMetadata()</code></li>
<li><code>getDefaultGamemode()</code></li>
<li><code>getLoggedInPlayers()</code></li>
<li><code>onPlayerLogout()</code></li>
<li><code>addPlayer()</code></li>
<li><code>removePlayer()</code></li>
<li><code>reload()</code></li>
<li><code>getSpawnRadius()</code></li>
<li><code>enablePlugin()</code></li>
<li><code>disablePlugin()</code></li>
<li><code>getGamemodeString()</code> - <code>pocketmine\player\GameMode-&gt;getTranslationKey()</code> に置き換えられました。</li>
<li><code>getGamemodeName()</code> - <code>pocketmine\player\GameMode-&gt;name()</code>　に置き換えられました。</li>
<li><code>getGamemodeFromString()</code> - <code>GameMode::fromString()</code> に置き換えられました。</li>
<li><code>broadcast()</code> - <code>broadcastMessage()</code> を代わりに使用してください。</li>
</ul>
</li>
<li>以下のAPIメソッドは変更されました。<ul>
<li><code>getOfflinePlayerData()</code> 存在しないデータを生成しなくなりました。</li>
</ul>
</li>
<li>以下のAPIメソッドは名前が変更されました。<ul>
<li><code>getPlayer()</code> -&gt; <code>getPlayerByPrefix()</code> (可能な場所では <code>getPlayerExact()</code> を代わりに使用することを検討してください)</li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-level-world">Level / World</h4>
<h5 id="api4-changelogs-general_2">General</h5>
<ul>
<li>"world"の文脈での<code>Level</code>への言及は全て<code>World</code>に変更されました。<ul>
<li>名前空間<code>pocketmine\level</code>は<code>pocketmine\world</code>に変更されました。</li>
<li>"world"の文脈で<code>Level</code>を名前に含む全てのクラスの該当箇所は、<code>World</code>に変更されました。</li>
<li>例えば、<code>Position-&gt;getLevel()</code>は<code>Position-&gt;getWorld()</code>に変更され、<code>Position-&gt;level</code>は<code>Position-&gt;world</code>に変更されました。</li>
</ul>
</li>
<li><code>WorldManager</code>ユニットを<code>Server</code>から分割しました。<ul>
<li><code>Server-&gt;findEntity()</code> -&gt; <code>WorldManager-&gt;findEntity()</code></li>
<li><code>Server-&gt;generateLevel()</code> -&gt; <code>WorldManager-&gt;generateWorld()</code></li>
<li><code>Server-&gt;getAutoSave()</code> -&gt; <code>WorldManager-&gt;getAutoSave()</code></li>
<li><code>Server-&gt;getDefaultLevel()</code> -&gt; <code>WorldManager-&gt;getDefaultWorld()</code></li>
<li><code>Server-&gt;getLevel()</code> -&gt; <code>WorldManager-&gt;getWorld()</code></li>
<li><code>Server-&gt;getLevelByName()</code> -&gt; <code>WorldManager-&gt;getWorldByName()</code></li>
<li><code>Server-&gt;getLevels()</code> -&gt; <code>WorldManager-&gt;getWorlds()</code></li>
<li><code>Server-&gt;isLevelGenerated()</code> -&gt; <code>WorldManager-&gt;isWorldGenerated()</code></li>
<li><code>Server-&gt;isLevelLoaded()</code> -&gt; <code>WorldManager-&gt;isWorldLoaded()</code></li>
<li><code>Server-&gt;loadLevel()</code> -&gt; <code>WorldManager-&gt;loadWorld()</code></li>
<li><code>WorldManager-&gt;loadWorld()</code> 要求された場合はワールドを変換できます。 (<code>$autoUpgrade</code>パラメーターが提供されている必要があります)</li>
<li><code>Server-&gt;setAutoSave()</code> -&gt; <code>WorldManager-&gt;setAutoSave()</code></li>
<li><code>Server-&gt;setDefaultLevel()</code> -&gt; <code>WorldManager-&gt;setDefaultWorld()</code></li>
<li><code>Server-&gt;unloadLevel()</code> -&gt; <code>WorldManager-&gt;unloadWorld()</code></li>
</ul>
</li>
<li><code>WorldManager-&gt;getAutoSaveTicks()</code>が追加され、自動セーブの間隔を操作できるようになりました。</li>
<li>以下のクラスは追加されました。<ul>
<li><code>BlockTransaction</code>: 検証条件付きでブロックの一括変更を行えます - 一つでも変更不可なブロックがある場合、変更全体が適用できなくなります。</li>
<li><code>ChunkListenerNoOpTrait</code>: チャンクリスナーの実装のための標準のno-opスタブを含みます。</li>
<li><code>ChunkListener</code>: 与えられたチャンクで発生したイベントを監視することができるインタフェースです。</li>
<li><code>TickingChunkLoader</code>: チャンクの時を刻むことに特化した<code>ChunkLoader</code>です。</li>
</ul>
</li>
<li><code>ChunkLoader</code>は<code>getX()</code>と<code>getZ()</code>の実装を必要としなくなりました。</li>
<li><code>ChunkLoader</code>でチャンクがランダムに更新されることがなくなりました。この動作が必要なら<code>TickingChunkLoader</code>を実装してください。</li>
<li>以下のクラスは改名されました。<ul>
<li><code>pocketmine\world\utils\SubChunkIteratorManager</code> -&gt; <code>pocketmine\world\utils\SubChunkExplorer</code></li>
</ul>
</li>
<li>以下のAPIメソッドは追加されました。<ul>
<li><code>World-&gt;registerChunkListener()</code></li>
<li><code>World-&gt;unregisterChunkListener()</code></li>
<li><code>World-&gt;getBlockAt()</code> (Vector3の代わりにint x/y/zを受け入れ、場合によってはより速くなります)</li>
<li><code>World-&gt;setBlockAt()</code> (Vector3の代わりにint x/y/zを受け入れ、場合によってはより速くなります)</li>
<li><code>Chunk-&gt;isDirty()</code> (<code>Chunk-&gt;hasChanged()</code>の置換)</li>
<li><code>Chunk-&gt;getDirtyFlag()</code> (より細かなコンポーネント・ベースのチャンクダーティフラッギングで、チャンクの変更されていない部分を保存することを回避するために使用されます)</li>
<li><code>Chunk-&gt;setDirty()</code></li>
<li><code>Chunk-&gt;setDirtyFlag()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>ChunkLoader-&gt;getLoaderId()</code> (オブジェクトIDが使われるようになりました)</li>
<li><code>ChunkLoader-&gt;isLoaderActive()</code></li>
<li><code>ChunkLoader-&gt;getPosition()</code></li>
<li><code>ChunkLoader-&gt;getLevel()</code></li>
<li><code>Chunk-&gt;fastSerialize()</code> (<code>FastChunkSerializer::serialize()</code>を代わりに使用してください)</li>
<li><code>Chunk-&gt;getBlockData()</code></li>
<li><code>Chunk-&gt;getBlockDataColumn()</code></li>
<li><code>Chunk-&gt;getBlockId()</code></li>
<li><code>Chunk-&gt;getBlockIdColumn()</code></li>
<li><code>Chunk-&gt;getBlockLight()</code></li>
<li><code>Chunk-&gt;getBlockLightColumn()</code></li>
<li><code>Chunk-&gt;getBlockSkyLight()</code></li>
<li><code>Chunk-&gt;getBlockSkyLightColumn()</code></li>
<li><code>Chunk-&gt;getMaxY()</code></li>
<li><code>Chunk-&gt;getSubChunkSendCount()</code> (これはプロトコルの取り扱いに特化していました)</li>
<li><code>Chunk-&gt;getX()</code></li>
<li><code>Chunk-&gt;getZ()</code></li>
<li><code>Chunk-&gt;hasChanged()</code> (<code>Chunk-&gt;isDirty()</code>または<code>Chunk-&gt;getDirtyFlag()</code>を代わりに使用してください)</li>
<li><code>Chunk-&gt;isGenerated()</code></li>
<li><code>Chunk-&gt;networkSerialize()</code> (<code>network\mcpe\serializer</code>の中にある<code>ChunkSerializer</code>を確認してください)</li>
<li><code>Chunk-&gt;populateSkyLight()</code> (<code>SkyLightUpdate-&gt;recalculateChunk()</code>を代わりに使用してください)</li>
<li><code>Chunk-&gt;recalculateHeightMap()</code> (<code>SkyLightUpdate</code>に移動しました)</li>
<li><code>Chunk-&gt;recalculateHeightMapColumn()</code> (<code>SkyLightUpdate</code>に移動しました)</li>
<li><code>Chunk-&gt;setAllBlockLight()</code></li>
<li><code>Chunk-&gt;setAllBlockSkyLight()</code></li>
<li><code>Chunk-&gt;setBlock()</code></li>
<li><code>Chunk-&gt;setBlockData()</code></li>
<li><code>Chunk-&gt;setBlockId()</code></li>
<li><code>Chunk-&gt;setBlockLight()</code></li>
<li><code>Chunk-&gt;setBlockSkyLight()</code></li>
<li><code>Chunk-&gt;setChanged()</code> (<code>Chunk-&gt;setDirty()</code>または<code>Chunk-&gt;setDirtyFlag()</code>を代わりに使用してください)</li>
<li><code>Chunk-&gt;setGenerated()</code></li>
<li><code>Chunk-&gt;setX()</code></li>
<li><code>Chunk-&gt;setZ()</code></li>
<li><code>Chunk::fastDeserialize()</code> (<code>FastChunkSerializer::deserialize()</code>を代わりに使用してください)</li>
<li><code>World-&gt;isFullBlock()</code></li>
<li><code>World-&gt;getFullBlock()</code></li>
<li><code>World-&gt;getBlockIdAt()</code></li>
<li><code>World-&gt;setBlockIdAt()</code></li>
<li><code>World-&gt;getBlockDataAt()</code></li>
<li><code>World-&gt;setBlockDataAt()</code></li>
<li><code>World-&gt;setBlockLightAt()</code></li>
<li><code>World-&gt;setBlockSkyLightAt()</code></li>
<li><code>World-&gt;getBlockSkyLightAt()</code> (場合によって、<code>World-&gt;getRealBlockSkyLightAt()</code>または<code>World-&gt;getPotentialBlockSkyLightAt()</code>を使用してください)</li>
<li><code>World-&gt;getHeightMap()</code> (誤解を招く名前であり、空の光の計算にのみ有益です - おそらく<code>getHighestBlockAt()</code>が求められているものでしょう)</li>
<li><code>World-&gt;setHeightMap()</code> (誤解を招く名前であり、空の光の計算にのみ有益です)</li>
<li><code>World-&gt;getChunkEntities()</code></li>
<li><code>World-&gt;getChunkTiles()</code></li>
<li><code>World-&gt;getTileById()</code></li>
<li><code>World-&gt;checkSpawnProtection()</code></li>
<li><code>World-&gt;updateBlockLight()</code></li>
<li><code>World-&gt;updateSkyLight()</code></li>
<li><code>World-&gt;isFullBlock()</code> (<code>Block-&gt;isFullCube()</code>を代わりに使用してください)</li>
<li><code>World-&gt;sendBlocks()</code></li>
<li><code>World-&gt;sendTime()</code></li>
<li><code>World-&gt;addGlobalPacket()</code></li>
<li><code>World-&gt;broadcastGlobalPacket()</code></li>
<li><code>World-&gt;addChunkPacket()</code></li>
<li><code>World-&gt;broadcastLevelSoundEvent()</code></li>
<li><code>World-&gt;broadcastLevelEvent()</code></li>
<li><code>World-&gt;getTickRate()</code></li>
<li><code>World-&gt;setTickRate()</code></li>
<li><code>World::generateChunkLoaderId()</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャーが変更されました。<ul>
<li><code>World-&gt;addParticle()</code>は<code>addParticle(Vector3 $pos, Particle $particle, ?Player[] $players = null) : void</code>のシグネチャーを持つようになります。</li>
<li><code>World-&gt;addSound()</code>は<code>addSound(?Vector3 $pos, Sound $sound, ?Player[] $players = null) : void</code>のシグネチャーを持つようになります。</li>
<li><code>World-&gt;getRandomTickedBlocks()</code>は<code>SplFixedArray</code>の代わりに<code>bool[]</code>を受け付けます。</li>
<li><code>World-&gt;addRandomTickedBlock()</code>は<code>int, int</code>の代わりに<code>Block</code>を受け付けます。</li>
<li><code>World-&gt;removeRandomTickedBlock()</code>は<code>int, int</code>の代わりに<code>Block</code>を受け付けます。</li>
<li><code>World-&gt;setBlock()</code>にあった<code>$direct</code>パラメーターは削除されました。</li>
<li><code>World-&gt;loadChunk()</code>は<code>?Chunk</code>を返し、<code>$create</code>パラメーターは削除されました。</li>
<li><code>World-&gt;getChunk()</code>は<code>$create</code>パラメーターを受け付けなくなりました。</li>
<li><code>World-&gt;updateAllLight()</code>は<code>Vector3</code>の代わりに<code>int, int, int</code>を受け付けます。</li>
<li><code>ChunkManager-&gt;setChunk()</code> (および<code>World</code>と<code>SimpleChunkManager</code>の中の注目に値する実装) は<code>$chunk</code>パラメーターにNULLを受け付けなくなりました。</li>
<li><code>Chunk-&gt;__construct()</code>は<code>array&lt;int, SubChunk&gt; $subChunks, ?list&lt;CompoundTag&gt; $entities, ?list&lt;CompoundTag&gt; $tiles, ?BiomeArray $biomeArray, ?HeightArray $heightArray</code>のシグネチャーを持つようになります。</li>
<li><code>Chunk-&gt;getSubChunk()</code>は<code>SubChunkInterface|null</code>の代わりに<code>SubChunk</code>を返します。(範囲外の座標では<code>InvalidArgumentException</code>を投げます)</li>
<li><code>Chunk-&gt;setSubChunk()</code>はもう<code>SubChunkInterface</code>を受け入れず、<code>$allowEmpty</code>パラメーターは削除されました。</li>
<li><code>WorldManager-&gt;generateWorld()</code> (以前の<code>Server-&gt;generateWorld()</code>) は<code>int $seed, class-string&lt;Generator&gt; $generator, mixed[] $options</code>の代わりに<code>WorldCreationOptions</code>を受け付けるようになりました。</li>
</ul>
</li>
<li>以下のAPIメソッドは改名または移動しました。<ul>
<li><code>Level-&gt;getChunks()</code> -&gt; <code>World-&gt;getLoadedChunks()</code></li>
<li><code>Level-&gt;getCollisionCubes()</code> -&gt; <code>World-&gt;getCollisionBoxes()</code></li>
<li><code>World-&gt;getName()</code> -&gt; <code>World-&gt;getDisplayName()</code></li>
<li><code>World-&gt;populateChunk()</code>は<code>World-&gt;requestChunkPopulation()</code>と<code>World-&gt;orderChunkPopulation()</code>に分割されました。</li>
</ul>
</li>
<li>以下のAPIメソッドは動作が変更されました。<ul>
<li><code>World-&gt;getChunk()</code>はディスクからチャンクを読み込もうとしなくなりました。チャンクがすでにメモリになかった場合、<code>null</code>が返されます。 (この動作は他の<code>ChunkManager</code>の実装と適切に調和します)</li>
<li><code>World-&gt;getHighestBlockAt()</code>は目標のX/Z列にブロックがなかった場合<code>-1</code>の代わりに<code>null</code>を返すようになりました。</li>
<li>以下のメソッドは未生成の地形を指定したときに<code>WorldException</code>を投げるようになりました。</li>
<li><code>World-&gt;getSafeSpawn()</code> (以前はただ黙って入力位置を返していました)</li>
<li><code>World-&gt;getHighestBlockAt()</code> (以前は-1を返していました)</li>
<li><code>World-&gt;loadChunk()</code>はディスクに指定のチャンクが存在しなかった時に空のチャンクを生成しなくなりました。</li>
<li><code>World-&gt;setChunk()</code>は<code>ChunkLoadEvent</code>と<code>ChunkListener-&gt;onChunkLoaded()</code>を以前存在していなかったチャンクを置き換えるときに呼び出します。</li>
<li><code>World-&gt;useBreakOn()</code>は指定の場所が未生成、または未ロードの（または生成のためにロックされている）チャンクに含まれていた場合に<code>false</code>を返すようになりました。</li>
<li><code>World-&gt;useItemOn()</code>は指定の場所が未生成、または未ロードの（または生成のためにロックされている）チャンクに含まれていた場合に<code>false</code>を返すようになりました。</li>
</ul>
</li>
<li><code>ChunkListener</code>インタフェースは<code>ChunkLoader</code>から分割されました。以下のメソッドは移動しました。<ul>
<li><code>ChunkLoader-&gt;onBlockChanged()</code> -&gt; <code>ChunkListener-&gt;onBlockChanged()</code></li>
<li><code>ChunkLoader-&gt;onChunkChanged()</code> -&gt; <code>ChunkListener-&gt;onChunkChanged()</code></li>
<li><code>ChunkLoader-&gt;onChunkLoaded()</code> -&gt; <code>ChunkListener-&gt;onChunkLoaded()</code></li>
<li><code>ChunkLoader-&gt;onChunkPopulated()</code> -&gt; <code>ChunkListener-&gt;onChunkPopulated()</code></li>
<li><code>ChunkLoader-&gt;onChunkUnloaded()</code> -&gt; <code>ChunkListener-&gt;onChunkUnloaded()</code></li>
</ul>
</li>
<li><code>Location</code>は<code>pocketmine\entity\Location</code>に移動しました。</li>
</ul>
<h5 id="api4-changelogs-particles">Particles</h5>
<ul>
<li><code>DestroyBlockParticle</code>は<code>BlockBreakParticle</code>に一貫性のために名前が変更されました。</li>
<li><code>DustParticle-&gt;__construct()</code>は<code>pocketmine\color\Color</code>オブジェクトを<code>r, g, b, a</code>の代わりに受け付けるようになりました。</li>
<li><code>pocketmine\world\particle\Particle</code>は<code>pocketmine\math\Vector3</code>を継承しなくなり、インタフェースに変換されました。</li>
<li>以下の<code>Particle</code>が追加されました。<ul>
<li><code>DragonEggTeleportParticle</code></li>
<li><code>PunchBlockParticle</code></li>
</ul>
</li>
</ul>
<h5 id="api4-changelogs-sounds">Sounds</h5>
<ul>
<li><code>pocketmine\world\sound\Sound</code>は<code>pocketmine\math\Vector3</code>を継承しなくなり、インタフェースに変換されました。</li>
<li><code>Sound-&gt;encode()</code>は<code>?\pocketmine\math\Vector3</code>を受け付けるようになりました。全体へのサウンドの場合は<code>NULL</code>を渡すことができます。</li>
<li>以下のクラスが追加されました。<ul>
<li><code>ArrowHitSound</code></li>
<li><code>BlockBreakSound</code></li>
<li><code>BlockPlaceSound</code></li>
<li><code>BowShootSound</code></li>
<li><code>BucketEmptyLavaSound</code></li>
<li><code>BucketEmptyWaterSound</code></li>
<li><code>BucketFillLavaSound</code></li>
<li><code>BucketFillWaterSound</code></li>
<li><code>ChestCloseSound</code></li>
<li><code>ChestOpenSound</code></li>
<li><code>EnderChestCloseSound</code></li>
<li><code>EnderChestOpenSound</code></li>
<li><code>ExplodeSound</code></li>
<li><code>FlintSteelSound</code></li>
<li><code>ItemBreakSound</code></li>
<li><code>NoteInstrument</code></li>
<li><code>NoteSound</code></li>
<li><code>PaintingPlaceSound</code></li>
<li><code>PotionSplashSound</code></li>
<li><code>RedstonePowerOffSound</code></li>
<li><code>RedstonePowerOnSound</code></li>
<li><code>ThrowSound</code></li>
<li><code>XpCollectSound</code></li>
<li><code>XpLevelUpSound</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-utils">Utils</h4>
<ul>
<li><code>Color</code>クラスは移動されました。現在では<a href="https://github.com/pmmp/Color"><code>pocketmine/color</code></a>パッケージ内の<code>pocketmine\color\Color</code>に存在します。</li>
<li><code>UUID</code>クラスは削除されました。 <a href="https://github.com/ramsey/uuid"><code>ramsey/uuid</code></a>のバージョン4.1が代わりに使用されます。<ul>
<li><code>UUID::fromData()</code>は<code>Ramsey\Uuid\Uuid::uuid3()</code>に置き換えられます</li>
<li><code>UUID::fromRandom()</code>は<code>Ramsey\Uuid\Uuid::uuid4()</code>に置き換えられます</li>
<li><code>UUID::fromBinary()</code>は<code>Ramsey\Uuid\Uuid::fromBytes()</code>に置き換えられます (<code>Ramsey\Uuid\Uuid::isValid()</code>で有効か確認してください)</li>
<li><code>UUID::toBinary()</code>は<code>Ramsey\Uuid\UuidInterface::getBytes()</code>で置き換えられます</li>
<li>詳細は <a href="https://uuid.ramsey.dev/en/latest/introduction.html">https://uuid.ramsey.dev/en/latest/introduction.html</a> で確認できます</li>
</ul>
</li>
<li><code>Terminal::hasFormattingCodes()</code>はフォーマットに用いるコードが利用できるかを自動的に検出しなくなりました。 代わりに<code>Terminal::init()</code>をパラメータなしで用いて初期化するか、<code>true</code>か<code>false</code>を与えて上書きする必要があります。</li>
<li><code>Config-&gt;save()</code>はディスク書き込み時の例外を受け取らなくなりました。</li>
<li>以下のクラスが追加されました。<ul>
<li><code>InternetException</code></li>
<li><code>Internet</code></li>
<li><code>Process</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Config-&gt;getPath()</code>: ディスク上のConfigのパスを返します</li>
<li><code>Terminal::write()</code>: Minecraftフォーマットを使用したテキストを新たな行を作ることなく出力します</li>
<li><code>Terminal::writeLine()</code>: Minecraftフォーマットを使用したテキストを新たな行を作って出力します</li>
<li><code>Utils::recursiveUnlink()</code>: 再帰的にディレクトリ内のコンテンツとそのディレクトリを削除します</li>
</ul>
</li>
<li>以下のAPIクラス定数が追加されました。<ul>
<li><code>TextFormat::COLORS</code>: すべての既知のカラーコードのリスト</li>
<li><code>TextFormat::FORMATS</code>: すべての既知のフォーマットコードのリスト(例. イタリック,ボールド)。 (<code>RESET</code>は含まれません。これはフォーマットを追加せず <em>削除</em> するためです。)</li>
</ul>
</li>
<li>以下の非推奨のAPIリダイレクトが削除されました。<ul>
<li><code>Utils::execute()</code>: <code>Process</code>に移動されました。</li>
<li><code>Utils::getIP()</code>: <code>Internet</code>に移動されました。</li>
<li><code>Utils::getMemoryUsage()</code>: <code>Process</code>に移動されました。</li>
<li><code>Utils::getRealMemoryUsage()</code>: <code>Process</code>に移動されました。</li>
<li><code>Utils::getThreadCount()</code>: <code>Process</code>に移動されました。</li>
<li><code>Utils::getURL()</code>: <code>Internet</code>に移動されました。</li>
<li><code>Utils::kill()</code>: <code>Process</code>に移動されました。</li>
<li><code>Utils::postURL()</code>: <code>Internet</code>に移動されました。</li>
<li><code>Utils::simpleCurl()</code>: <code>Internet</code>に移動されました。</li>
</ul>
</li>
<li>以下のAPIフィールドは削除/隠蔽されました。<ul>
<li><code>Utils::$ip</code></li>
<li><code>Utils::$online</code></li>
<li><code>Utils::$os</code></li>
</ul>
</li>
<li>以下のAPIメソッドはシグネチャが変更されました。<ul>
<li><code>Internet::simpleCurl()</code>は現在では<code>callable</code>ではなく<code>Closure</code>を<code>onSuccess</code>パラメータとして要求します</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>TextFormat::toJSON()</code></li>
<li><code>Utils::getCallableIdentifier()</code></li>
</ul>
</li>
</ul>
<h3 id="api4-changelogs-gameplay">Gameplay</h3>
<h4 id="api4-changelogs-blocks">Blocks</h4>
<ul>
<li>以下のブロックが実装されました<ul>
<li>bamboo</li>
<li>bamboo sapling</li>
<li>barrel</li>
<li>barrier</li>
<li>blast furnace</li>
<li>blue ice</li>
<li>carved pumpkin</li>
<li>coral block</li>
<li>daylight sensor</li>
<li>dried kelp</li>
<li>elements (from Minecraft: Education Edition)</li>
<li>hard (stained and unstained) glass (from Minecraft: Education Edition)</li>
<li>hard (stained and unstained) glass pane (from Minecraft: Education Edition)</li>
<li>jukebox</li>
<li>note block</li>
<li>red, green, blue and purple torches (from Minecraft: Education Edition)</li>
<li>sea pickle</li>
<li>slime</li>
<li>smoker</li>
<li>underwater torches (from Minecraft: Education Edition)</li>
<li>additional wood variants of the following:<ul>
<li>buttons</li>
<li>pressure plates</li>
<li>signs</li>
<li>trapdoors</li>
</ul>
</li>
<li>stairs of the following materials:<ul>
<li>andesite (smooth and natural)</li>
<li>diorite (smooth and natural)</li>
<li>end stone</li>
<li>end stone brick</li>
<li>granite (smooth and natural)</li>
<li>mossy cobblestone</li>
<li>prismarine (natural, dark and bricks)</li>
<li>red nether brick</li>
<li>red sandstone (and variants)</li>
</ul>
</li>
<li>stone-like slabs of many variants</li>
</ul>
</li>
<li>プレイヤーでないエンティティがベッドに落ちた際に跳ねるようになりました。</li>
<li>プレイヤーとmobはベッドに落ちた際にダメージが軽減されるようになりました。</li>
</ul>
<h4 id="api4-changelogs-items">Items</h4>
<ul>
<li>以下のアイテムが実装されました<ul>
<li>records</li>
<li>compounds (from Minecraft: Education Edition)</li>
<li>black, brown, blue and white dyes</li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-inventory_1">Inventory</h4>
<ul>
<li>オフハンドインベントリが実装されました。</li>
</ul>
<h2 id="api4-changelogs-400-beta2">4.0.0-BETA2</h2>
<p>2021年9月10日リリース</p>
<h3 id="api4-changelogs-general_3">General</h3>
<ul>
<li>ext-chunkutils 0.3.xが要求されるようになりました。</li>
<li>ガベージコレクションの後のライトストレージのメモリ使用量を削減しました。</li>
<li>一種類のブロックのみを含む均一なサブチャンクのメモリ使用量を削減しました。</li>
<li>タイトルバーはヒープメモリの使用量を表示しなくなりました。(それはさておき、誰もそれが何かわかっていなかったようです。)</li>
<li><code>/status</code>はヒープメモリの使用量を表示しなくなりました。</li>
<li><code>start.sh</code>はPHPバイナリが見当たらないエラーにおいてPHP7を挙げることはなくなりました。</li>
<li>到達距離のチェックによってプレイヤーが何かをすることを妨げられた時に、デバッグメッセージが記録されるようになりました。</li>
</ul>
<h3 id="api4-changelogs-fixes">Fixes</h3>
<ul>
<li>プレイヤーが未生成のチャンクに対して<code>/tp</code>を使用した(あるいは他のプレイヤーによってテレポートされた)時に切断される問題を修正しました。</li>
<li>チャンクがアンロードされた時にブロックが更新されることで発生する可能性のあるメモリリークの問題を修正しました。</li>
<li><code>Living-&gt;lookAt()</code>が目線の高さを考慮に入れていなかった動作を修正しました。</li>
<li>草を設置したときにそれが勝手に入れ替わる(インベントリのアイテムを消費する)問題を修正しました。</li>
<li>プレイヤーが壁の横に落下した時にダメージを受ける問題を修正しました。</li>
</ul>
<h3 id="api4-changelogs-api-changes">API changes</h3>
<ul>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>World-&gt;getChunkEntities()</code></li>
<li><code>World-&gt;notifyNeighbourBlockUpdate()</code></li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>Chunk-&gt;getEntities()</code></li>
<li><code>Chunk-&gt;getSavableEntities()</code></li>
<li><code>Chunk-&gt;addEntity()</code></li>
<li><code>Chunk-&gt;removeEntity()</code></li>
</ul>
</li>
<li>以下のクラスが追加されました。<ul>
<li><code>pocketmine\inventory\transaction\TransactionBuilderInventory</code>: 標準的な<code>Inventory</code>APIメソッドを用いて<code>InventoryTransaction</code>を作成することを容易にします。</li>
</ul>
</li>
<li>以下のクラス定数が追加されました。<ul>
<li><code>Chunk::EDGE_LENGTH</code></li>
<li><code>Chunk::COORD_BIT_SIZE</code></li>
<li><code>Chunk::COORD_MASK</code></li>
<li><code>SubChunk::EDGE_LENGTH</code></li>
<li><code>SubChunk::COORD_BIT_SIZE</code></li>
<li><code>SubChunk::COORD_MASK</code></li>
</ul>
</li>
</ul>
<h2 id="api4-changelogs-400-beta3">4.0.0-BETA3</h2>
<h3 id="api4-changelogs-general_4">General</h3>
<ul>
<li>Minecraft: Bedrock Edition 1.17.30をサポートしました。</li>
<li>Minecraft: Bedrock Edition 1.17.1xのサポートを打ち切りました。</li>
<li><code>tools/convert-world.php</code>は標準エラー出力を書くようになり、適切な終了コードを設定するようになりました。</li>
<li>爆発はブロック更新の処理に標準的なメカニズムを使用するようになりました。以前は、あまりに非効率な標準のアルゴリズムが原因で特別なアルゴリズムを用いていました。これらの非効率が解消されたことで、爆発は他のものと変わらないほどにパフォーマンスへの影響を最小化しました。</li>
<li>コマンドの使用方法の文字列は自動的に翻訳されなくなります。(<code>Translatable</code>を最も基本的な文字列キーの代わりに使用してください)</li>
<li>コマンド説明の文字列は自動的に翻訳されなくなります。(<code>Translatable</code>を最も基本的な文字列キーの代わりに使用してください)</li>
</ul>
<h3 id="api4-changelogs-fixes_1">Fixes</h3>
<ul>
<li><code>ItemFactory-&gt;isRegistered()</code>負のアイテムIDが渡されてもクラッシュしなくなりました。</li>
<li>かまどは設置されているチャンクのリロードのの後ものあとも後も動作を継続するようになりました。</li>
<li>一部の場合において切断後10秒間再接続ができない問題を修正しました。</li>
</ul>
<h3 id="api4-changelogs-api-changes_1">API changes</h3>
<ul>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Liquid-&gt;getMinAdjacentSourcesToFormSource()</code>: 現在のブロックが水源・マグマ源になるためには付近にいくつの水源・マグマ源ブロックが必要であるかを返します。</li>
<li><code>Player-&gt;getPlayerInfo()</code></li>
</ul>
</li>
<li><code>Liquid</code>の最小コストの流量計算のコードは<code>MinimumCostFlowCalculator</code>に分割されました。</li>
</ul>
<h2 id="api4-changelogs-400-beta4">4.0.0-BETA4</h2>
<p>2021年10月6日リリース</p>
<h3 id="api4-changelogs-general_5">General</h3>
<ul>
<li>光の計算のパフィーマンスをメインスレッドから使えないデータをコピーしないようにすることで改善しました。</li>
<li>リソースパックの読み込みでは<code>dependencies</code>と<code>capabilities</code>フィールドを<code>manifest.json</code>に書き込めるようになりました。(しかし、今のところそれを確認することはありません)</li>
<li><code>/help</code>は<code>server.properties</code>に設定された言語によってローカライズされるようになりました。</li>
<li>ワールドの読み込み、生成、変換に関する種類のメッセージは<code>server.properties</code>に設定された言語によってローカライズされるようになりました。</li>
<li>コンパスはプレイヤーが異なるワールドにテレポートした後に、適切な（移動後の）ワールドのスポーン地点を指すようになりました。以前はプレイヤーが最初にスポーンしたワールドのスポーン地点を指し続けていました。</li>
<li>CLIオプションの<code>--bootstrap</code>は削除されました。</li>
<li>RakLib 0.14.2が要求されるようになりました。これにより以下の問題が修正されます。<ul>
<li>クライアントの切断時のセッションの不適切な処理（タイムアウトのデバッグメッセージの原因となっていた）を修正しました。</li>
<li>プレイヤーの転送がしばしば正しく動作していなかった問題を修正しました。</li>
<li>時々切断画面が表示されなかった問題を修正しました。</li>
</ul>
</li>
</ul>
<h3 id="api4-changelogs-fixes_2">Fixes</h3>
<ul>
<li>UPnPがエラーに遭遇したときにクラッシュしなくなりました。</li>
<li>インベントリトランザクションでクライアントが不正なNBTを持つアイテムを送った時にサーバーがクラッシュする問題を修正しました。</li>
<li>古い権限構造がネストされたプラグインを読み込んだ時のクラッシュを修正しました。(プラグインは読み込みに失敗しますが、サーバーはクラッシュしなくなりました。)</li>
<li>不正なNBTを持つ任意のアイテムで<code>/give</code>を使用するとサーバーがクラッシュする問題を修正しました。</li>
<li>不正確に形式化されたAPIバージョンを持つプラグインを読み込むとサーバーがクラッシュする問題を修正しました。 (プラグインは読み込みに失敗しますが、サーバーはクラッシュしなくなりました。)</li>
<li><code>PlayerLoginEvent</code>にてプレイヤーのゲームモードを変更したときにサーバーがクラッシュする問題を修正しました。</li>
<li>プラグインのマニフェスト中の誤った<code>commands</code>の構造はより早く検知され、よりうまく処理されるようになりました。</li>
<li>Windowsでクラッシュした時に、コンソールリーダーのサブプロセスが残ってしまいターミナルがおかしくなる問題を修正しました。</li>
<li><code>PlayerLoginEvent</code>の途中でプレイヤーをキックした時の<code>Player</code>のメモリリークを修正しました。(これはシャットダウン時に<code>World</code>がリークしたエンティティについてレポートするきっかけになっていました)</li>
<li><code>Projectile-&gt;move()</code>が与えられた<code>dx</code>/<code>dy</code>/<code>dz</code>パラメーターを無視し、自身の<code>motion</code>を代わりに使用するようになりました。</li>
<li><code>BlockFactory-&gt;get()</code>が誤ったメタ値の<code>16</code>を受け付ける問題を修正しました。</li>
<li><code>Block-&gt;isSameState()</code>がいくつかの種類のハーフブロックに偽の値を返す問題を修正しました。</li>
<li>二重のハーフブロックを作るために互いのハーフブロックの上に同じ種類のハーフブロックを置くことができない問題を修正しました。</li>
</ul>
<h3 id="api4-changelogs-api-changes_2">API changes</h3>
<ul>
<li><code>plugin.yml</code>のプラグインのコマンドはそれぞれのコマンドに対する<code>permission</code>を設定しなければならなくなりました。以前は<code>permission</code>キーは任意であり、誰もがコマンドを使えてしまう原因になっていました。<ul>
<li>この動作は潜在的な瀬絵キュリティの問題から削除されました。- <code>plugin.yml</code>における誤字は危険な機能が全員に公開されてしまう可能性があります。</li>
<li>もし誰にでも使えるコマンドを作りたい場合は、<code>default</code>または<code>true</code>を設定した権限を設定し、それをコマンドの権限に割り当ててください。</li>
</ul>
</li>
<li><code>plugin.yml</code>のプラグインの権限はそれぞれに<code>default</code>を宣言しなければならなくなりました。以前は<code>default</code>キーは任意でしたが、権限が全ての人に拒否されたり(PM4)、暗黙のうちにオペレーターに付与されたり(PM3)する原因でした。</li>
</ul>
<h4 id="api4-changelogs-block_1">Block</h4>
<ul>
<li>以下のクラスを追加しました。<ul>
<li><code>pocketmine\block\utils\LeverFacing</code></li>
</ul>
</li>
<li>以下のAPIメソッドを追加しました。<ul>
<li><code>pocketmine\block\Lever-&gt;isActivated()</code></li>
<li><code>pocketmine\block\Lever-&gt;setActivated()</code></li>
<li><code>pocketmine\block\Lever-&gt;getFacing()</code></li>
<li><code>pocketmine\block\Lever-&gt;setFacing()</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-world">World</h4>
<ul>
<li>以下のAPIメソッドのシグネチャーは変更されました。<ul>
<li><code>Chunk-&gt;getSubChunks()</code>は<code>SplFixedArray&lt;SubChunk&gt;</code>の代わりに<code>array&lt;int, SubChunk&gt;</code>を返すようになりました。</li>
</ul>
</li>
<li>以下のAPIメソッドは削除されました。<ul>
<li><code>FastChunkSerializer::serialize()</code></li>
<li><code>FastChunkSerializer::deserialize()</code></li>
</ul>
</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>FastChunkSerializer::serializeTerrain()</code>: ブロックとバイオームのみをシリアライズします。</li>
<li><code>FastChunkSerializer::deserializeTerrain()</code>: <code>serializeTerrain()</code>の出力をでシリアライズします。</li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-utils_1">Utils</h4>
<ul>
<li>以下のAPIメソッドのシグネチャーは変更されました。<ul>
<li><code>Process::kill()</code>は追加の<code>bool $subprocesses</code>パラメーターを要求するようになりました。</li>
</ul>
</li>
</ul>
<h2 id="api4-changelogs-400-beta5">4.0.0-BETA5</h2>
<p>2021年10月12日リリース</p>
<h3 id="api4-changelogs-general_6">General</h3>
<ul>
<li>例外のログフォーマットが変更されました。例外の情報は一つの大きなメッセージのブロックに記録されるようになりました。これによりコンソールの空間が節約され可読性が向上するとともに、不正な<code>ThreadedLoggerAttachment</code>が例外の出力を壊す可能性を引き下げます。</li>
<li>ログメッセージはロガーアタッチメントを呼び出す前に<code>server.log</code>に出力されるようになりました。これによりロガーアタッチメントでエラーが発生した際にディスクに書き込まれない問題が修正されました。</li>
<li>多くのプラグインを読み込んだ時の起動パフォーマンスを改善しました。</li>
<li><code>pocketmine.yml</code>の中の<code>worlds</code>設定は、これ以降<code>generator</code>キーにジェネレーターの設定を付け加えることをサポートしません。(代わりに<code>preset</code>キーを使用してください)</li>
<li><code>server.properties</code>や<code>pocketmine.yml</code>で未知のジェネレーターを使うとワールドの生成が失敗する要因になります。</li>
<li><code>server.properties</code>や<code>pocketmine.yml</code>で無効/不正確なワールドジェネレーターのオプション(プリセット)を使用するとワールドの生成が失敗する要因になります。</li>
<li>既存のワールドのジェネレーターオプションは読み込み前に有効になるようになりました。それらが無効である場合、サーバーはワールドを読み込むことができません。</li>
<li>プラグイン読み込みのエラーを含む他のいくつかのログメッセージもローカライズされました。</li>
</ul>
<h3 id="api4-changelogs-fixes_3">Fixes</h3>
<ul>
<li><code>/give</code>でマインクラフトにないIDを用いてアイテムを与えようとしたときにサーバーがクラッシュする問題を修正しました。</li>
<li>真偽値が求められる<code>server.properties</code>のオプションで整数型が与えられた時にサーバーがクラッシュする問題を修正しました。(例 <code>false</code>や<code>true</code>の代わりに<code>0</code>や<code>1</code>)</li>
<li>実在しない<code>pocketmine.yml</code>の設定を確認する統計報告を修正しました。</li>
<li>適切な権限がないコマンドの使用において正しいメッセージの代わりに<code>commands.generic.permission</code>が送られてしまっていた問題を修正しました。</li>
<li>エンティティがダメージを受けていないにも関わらず、炎の中に留まっているように見える設定になっていた問題を修正しました。</li>
<li><code>/gc</code>の出力の<code>Memory freed</code>で単位<code>MB</code>が重複していた問題を修正しました。</li>
<li>ワールドの読み込みに失敗した場合にワールドを生成しようとする不具合を修正しました。</li>
</ul>
<h3 id="api4-changelogs-api_1">API</h3>
<h4 id="api4-changelogs-block_2">Block</h4>
<ul>
<li>以下のAPIメソッドは名前が変更されました。<ul>
<li><code>Block-&gt;getPositionOffset()</code> -&gt; <code>Block-&gt;getModelPositionOffset()</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-event_1">Event</h4>
<ul>
<li><code>@handleCancelled</code>というPhpDocのアノテーションはキャンセルできないイベントのイベントハンドラーに使われなくなりました。</li>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>StructureGrowEvent-&gt;getPlayer()</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-inventory_2">Inventory</h4>
<ul>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Inventory-&gt;getAddableItemQuantity()</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-scheduler_1">Scheduler</h4>
<ul>
<li><code>ClosureTask</code>は明確な返り値がないクロージャーを許可するようになりました。(アロー関数に便利です) </li>
</ul>
<h4 id="api4-changelogs-utils_2">Utils</h4>
<ul>
<li>以下のAPIメソッドが追加されました。<ul>
<li><code>Config::parseProperties()</code></li>
<li><code>Config::writeProperties()</code></li>
<li><code>Config::parseList()</code></li>
<li><code>Config::writeList()</code></li>
</ul>
</li>
</ul>
<h4 id="api4-changelogs-world_1">World</h4>
<ul>
<li>以下のAPIメソッドのシグネチャーは変更されました。<ul>
<li><code>GeneratorManager-&gt;registerGenerator()</code>は<code>\Closure $presetValidator</code>パラメーターを要求するようになりました。これはワールドとコンフィグのオプションをそれらに適用する前に確認するために使われます。</li>
</ul>
</li>
</ul>
<h2 id="api4-changelogs-400-beta6">4.0.0-BETA6</h2>
<p>2021年10月19日リリース</p>
<h3 id="api4-changelogs-general_7">General</h3>
<ul>
<li>Minecraft: Bedrock Edition 1.17.40をサポートしました。</li>
<li>以前のバージョンのサポートを終了しました。</li>
<li>CTRL+Cシグナルの処理は復元され、Windowsで使用できるようになりました。サーバー起動中にCTRL+Cを押下すると<code>/stop</code>が実行されたように振る舞います。</li>
<li>新しいスクリプト<code>tools/generate-permission-doc.php</code>を全ての権限とその関係性のリストを含むマークダウンファイルの生成のために追加しました。将来的には、これは公式の文献を保守するために使用される予定ですが、プラグイン開発者も彼ら自身の目的のために有用であることに気付くでしょう。</li>
<li><a href="https://packagist.org/packages/respect/validation"><code>respect/validation</code></a>はもう中核的な依存関係にはありません。</li>
</ul>
<h3 id="api4-changelogs-fixes_4">Fixes</h3>
<ul>
<li>大きすぎるアイテムIDのアイテムを<code>/give</code>で与えようとした時、あるいは<code>/clear</code>で存在しないアイテムを削除しようとしたときにサーバーがクラッシュする問題を修正しました。<ul>
<li><code>LegacyStringToItemParser</code>は独占的に使われるようになり、数字のIDはもう解析されません。</li>
</ul>
</li>
</ul>
<h3 id="api4-changelogs-gameplay_1">Gameplay</h3>
<ul>
<li>ドロップされたアイテムスタックからいくつかのアイテムを拾うことができるようになりました。これによりほぼ満杯のインベントリでアイテムを拾えない種々のバグが修正されます。</li>
</ul></section><h1 class='nav-section-title-end'>Ended: API4</h1>
                        <h1 class='nav-section-title' id='section-単項記事'>
                            単項記事 <a class='headerlink' href='#section-単項記事' title='Permanent link'>↵</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-poggit'>
                            Poggit <a class='headerlink' href='#section-poggit' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="dictionary-poggit-poggit"><h1 id="dictionary-poggit-poggit-poggit">Poggit</h1>
<p>PocketMineの公式プラグインレポジトリです。
ここにあるプラグインは以下の二つに分けられます。</p>
<ul>
<li>
<p><strong>Releases</strong> Poggitスタッフに承認されたプラグインがダウンロードでき、評価をつけることもできます。</p>
</li>
<li>
<p><strong>Dev</strong> 開発中のプラグインがダウンロードできます。動作の確認がされているとは限りません。</p>
</li>
</ul>
<h2 id="dictionary-poggit-poggit-_1">使い方</h2>
<!-- 画像をつける -->
<p>ReleasesやDevタブからプラグインを探すことができます。
Relesesでは初期状態ではすべてのプラグインが表示されていますが<code>All Caregories</code>となっているプルダウンメニューから自分の探したいジャンル、<code>All API Versions</code>となっているメニューから対応するバージョンを絞って探すことができます。</p></section><section class="print-page" id="dictionary-poggit-virion"><h1 id="dictionary-poggit-virion-virion">Virion</h1>
<p>Poggit Virion(以下Virion)はPocketMineプラグイン専用のPHPライブラリです。
このドキュメントでは、Virionの開発と使用についてのワークフローについての情報を提供します。</p>
<h2 id="dictionary-poggit-virion-virion_1">Virionの目的</h2>
<p>ソフトウェア開発においてライブラリは素晴らしいものですが、複数のプラグインが同じライブラリを使用する場合、同じPHPランタイムで実行されるために間違ったバージョンのライブラリが使用される可能性があります。Virionフレームワークでは、クラスをシェーディング(名前空間の操作)することでこの問題を解決することを目指しています。</p>
<h2 id="dictionary-poggit-virion-_1">前置き</h2>
<p>Virionはプラグインや他のVirionによって使用されます。
このドキュメントでは、<code>Virionユーザ</code>は、Virionを使用するプラグインまたはVirionを指します。</p>
<h2 id="dictionary-poggit-virion-_2">ワークフロー</h2>
<h3 id="dictionary-poggit-virion-virion_2">Virionの開発</h3>
<p>Virionはメインクラスを含む必要はありませんが、virion が宣言するすべてのシンボル (クラス・インターフェース・trait・名前空間関数・名前空間定数) は、<strong>Antigen</strong>と呼ばれるVirionの名前空間、またはAntigenのサブ名前空間の下になければなりません。
Antigenはビリオンに固有のものでなければなりません。
他のVirionやプラグインは、Antigenの名前空間またはその下位の名前空間の下でシンボルを宣言することはできません。</p>
<p>名前空間内に置くことができない他の名前付きグローバルリソースを登録する場合、その名前は、Virionのランタイム名前空間に依存するか、Virionユーザが提供する文字列に依存する必要があります。
例えば、VirionがAsyncTaskスレッドストアを使用する場合、<code>AsyncTask::saveToThreadStore()</code>に渡されるキーは<strong>クラスの構文上の名前空間の参照 (<a href="#dictionary-poggit-virion-構文的参照">構文的参照</a>) から生成されるか、Virionユーザから渡された値から生成されなければなりません</strong>。
stream_wrapper_register()`も同様のケースで、プロトコル名Virionによってハードコードされてはなりません。</p>
<p>Virionフレームワークには、<code>PSR-0</code>のソースファイルとVirionのマニフェストファイル <code>virion.yml</code> が含まれています。
<code>virion.yml</code>には以下の属性が含まれます。</p>
<table>
<thead>
<tr>
<th align="center">名前</th>
<th align="center">説明</th>
<th align="center">例</th>
<th align="center">必須/任意</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>name</code></td>
<td align="center">現在は使用されていませんが、Poggitのプロジェクト名と一致する必要があります。</td>
<td align="center"><code>libasynql</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>version</code></td>
<td align="center">セマンティック・バージョニングを用いたVirionのバージョン</td>
<td align="center"><code>0.1.0-beta</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>antigen</code></td>
<td align="center">Antigen(名前空間)</td>
<td align="center"><code>poggit\libasynql</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>api</code></td>
<td align="center">このVirionが使用できる<strong>唯一</strong>のPocketMine APIのバージョンです。plugin.yml の<code>api</code>と同じシステムを使用します。</td>
<td align="center"><code>[1.4.0, 2.0.0, 3.0.0-ALPHA1]</code></td>
<td align="center"><code>api</code>か<code>php</code>のどちらか</td>
</tr>
<tr>
<td align="center"><code>php</code></td>
<td align="center">このVirionが使用できる<strong>唯一</strong>の PHP バージョンです。plugin.ymlの<code>api</code> と同様のシステムを使用します。</td>
<td align="center"><code>[5.6, 7.0]</code></td>
<td align="center"><code>api</code>か<code>php</code>のどちらか</td>
</tr>
<tr>
<td align="center"><code>authors</code></td>
<td align="center">製作者名。文字列かリストが指定できます。</td>
<td align="center"><code>[SOFe, PEMapModder]</code></td>
<td align="center">任意</td>
</tr>
<tr>
<td align="center"><code>description</code></td>
<td align="center">説明文</td>
<td align="center"><code>Simple asynchronous SQL access</code></td>
<td align="center">任意</td>
</tr>
</tbody>
</table>
<p>異なるプラグインで使用されている同じVirionが相互に作用してはいけません。</p>
<h3 id="dictionary-poggit-virion-virion_3">Virionユーザの開発</h3>
<p>virion ユーザーは、virion によって宣言されたシンボルが正常にロードされることを前提に開発することができます。ただし、これらのシンボルへのすべての参照は、<a href="#dictionary-poggit-virion-構文的参照">構文的</a>でなければなりません。</p>
<h3 id="dictionary-poggit-virion-virion_4">Virionやプラグインのテスト</h3>
<p>Virion用テスターの役割を果たすプラグインを作ることが推奨されます。</p>
<p>Poggitは<a href="https://poggit.pmmp.io/p/DEVirion">DEVirion</a>を提供しています。詳しい使い方はPoggitのリリースページにあるプラグインの説明を参照してください。
このプラグインを使うと、Phar形式またはフォルダ形式のVirionまたはプラグインでサーバーを動かすことができます。</p>
<p><strong>デバッグ以外の理由でDEVirionを使用しないでください</strong>。
DEVirionはvirionのクラスを影で支えているわけではないので、DEVirionを使った複数のプラグインがあっても互換性の問題が発生し、virionフレームワークの意味がなくなってしまいます。</p>
<h3 id="dictionary-poggit-virion-poggitvirion">PoggitでVirionをビルドする</h3>
<p>Virionプロジェクトは、プラグインプロジェクトと同様にリポジトリの<code>.poggit.yml</code>で宣言することができますが、プロジェクト属性が 2 つ追加されます。</p>
<div class="highlight"><pre><span></span><code><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">library</span><span class="w"></span>
<span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">virion</span><span class="w"></span>
</code></pre></div>
<p>例:</p>
<div class="highlight"><pre><span></span><code><span class="nt">projects</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">libasynql</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/libasynql</span><span class="w"></span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">library</span><span class="w"></span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">virion</span><span class="w"></span>
</code></pre></div>
<h3 id="dictionary-poggit-virion-virion_5">ローカルでVirionをビルドする</h3>
<p>Virionをローカルで直接コンパイルする公式ツールは作成されていませんが、ビルドスクリプトは簡単に作成することができます。</p>
<p>基本的にVirionはプラグインと同じフォーマットですが、4つの違いがあります。
- <code>plugin.yml</code>が<code>virion.yml</code>になります。
- <code>resources</code> はサポートされていません (将来的に追加される可能性があります)。
- <code>virion.php</code>というファイルと、<code>virion_stub.php</code>というファイルがpharに含まれている必要があります。これらのファイルは、<a href="https://github.com/poggit/poggit/tree/beta/assets/php/"></a>からダウンロードすることができます。
    - <code>virion_stub.php</code>はビルド用のCLIを提供します。
    - <code>virion.php</code>には、実際にVirionを注入するコードが含まれています。
- pharのスタブは<code>virion.php</code>を直接読み込む必要があります。以下は有効なスタブの例です。</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">require</span> <span class="s2">&quot;phar://&quot;</span> <span class="o">.</span> <span class="no">__FILE__</span> <span class="o">.</span> <span class="s2">&quot;/virion_stub.php&quot;</span><span class="p">;</span> <span class="nx">__HALT_COMPILER</span><span class="p">();</span>
</code></pre></div>
<p><a href="https://github.com/poggit/poggit/blob/d587ecf3891270bd37940bf5640fca1eb7e374ad/src/poggit/ci/builder/PoggitVirionBuilder.php?utf8=%E2%9C%93#L50-L52">参考</a></p>
<h3 id="dictionary-poggit-virion-poggitvirion_1">PoggitでVirionユーザをビルドする</h3>
<p>Virionユーザ(Virionを使用するプラグインやVirion本体)は、<code>.poggit.yml</code>で使用するVirionを宣言することができ、プラグインのビルド時にPoggitが自動的にVirionを注入します。Virionは、プラグインプロジェクトの<code>libs</code>属性でリストアップできます。利用する各Virionの宣言は下記の属性を含みます。</p>
<table>
<thead>
<tr>
<th align="center">名前</th>
<th align="center">説明</th>
<th align="center">形式・例</th>
<th align="center">必須/任意</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>format</code></td>
<td align="center">ライブラリのフォーマット</td>
<td align="center"><code>virion</code> (現在この値のみ選択可能)</td>
<td align="center">任意 (デフォルト：<code>virion</code>)</td>
</tr>
<tr>
<td align="center"><code>vendor</code></td>
<td align="center">Virionのインポート元</td>
<td align="center"><code>poggit-project</code> または <code>raw</code></td>
<td align="center">任意 (デフォルト：<code>poggit-project</code>)</td>
</tr>
<tr>
<td align="center"><code>src</code> (<code>vendor</code>属性で<code>poggit-project</code>を選択した場合)</td>
<td align="center">Poggitプロジェクトのフルパス</td>
<td align="center"><code>/projectName</code> (同じリポジトリのプロジェクト) OR <code>repoOwner/repoName/projectName</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>src</code> (<code>vendor</code>属性で<code>raw</code>)を選択した場合</td>
<td align="center">ダウンロード先URL(HTTP/HTTPS)、またはプロジェクトからの相対パス</td>
<td align="center"><code>https://example.com/virion.phar</code> または <code>libs/virion.phar</code></td>
<td align="center">必須</td>
</tr>
<tr>
<td align="center"><code>version</code> (<code>vendor: poggit-project</code>)</td>
<td align="center"><a href="https://getcomposer.org/doc/articles/versions.md">セマンティックバージョニング</a>で指定</td>
<td align="center"><code>^1.0</code></td>
<td align="center"><code>vender</code>属性で<code>poggit-project</code>を指定した場合のみ必須</td>
</tr>
<tr>
<td align="center"><code>shade</code></td>
<td align="center">シェーディングストラテジ</td>
<td align="center"><code>syntax</code> または <code>single</code> または <code>double</code></td>
<td align="center">任意 (デフォルト：<code>syntax</code>)</td>
</tr>
<tr>
<td align="center"><code>branch</code> (<code>vendor</code>属性で<code>poggit-project</code>を選択した場合)</td>
<td align="center">ブランチの指定</td>
<td align="center"><code>ブランチ名</code> または <code>:default</code>(デフォルトブランチ) または <code>*</code>/<code>%</code>(全てのブランチ)</td>
<td align="center">任意(デフォルト：<code>:default</code>)</td>
</tr>
<tr>
<td align="center"><code>epitope</code></td>
<td align="center">追加の名前空間</td>
<td align="center"><code>.random</code>(ランダム) または <code>.sha</code>(ハッシュ) または <code>.none</code> または <code>任意の名前空間</code></td>
<td align="center">任意 (デフォルト：<code>libs</code>)</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong></p>
<p>セキュリティ上の理由から、Poggitでのビルドではローカルのvirion.phpを無視し、常に最新のvirion.phpを使用します。</p>
<h3 id="dictionary-poggit-virion-virion_6">ローカルでVirionユーザをコンパイルする</h3>
<p>ビルドされたVirionには、<code>virion_stub.php</code>および<code>virion.php</code>ファイルが含まれている必要があります。これらのファイルはVirionをVirionユーザに注入するためのCLIを提供します。</p>
<p>基本的な使い方：</p>
<div class="highlight"><pre><span></span><code>php used_virion.phar virion_user.phar <span class="si">${</span><span class="nv">ANTIBODY_PREFIX</span><span class="si">}</span>
</code></pre></div>
<p><code>${ANTIBODY_PREFIX}</code>はビリオンユーザーのメインの名前空間（プラグインの場合はメインクラスの名前空間、ビリオンの場合はAntigenの名前空間）でなければなりません。バックスラッシュ等はエスケープする必要があります。</p>
<h2 id="dictionary-poggit-virion-cli">CLI機能の拡張</h2>
<p>Virionは、プロジェクトルートに<code>cli-map.json</code>というファイルを追加することで、カスタムコマンドを追加することができます。このファイルには、コマンド名と実行ファイルをマッピングしたオブジェクトを記述します。</p>
<p><code>cli-map.json</code>が存在する場合、Poggitはsrcディレクトリのオートローダーのための<code>cli-autoload.php</code>を作成します。</p>
<p>コマンド名は<code>.phar</code>で終わらないようにしてください。</p>
<h2 id="dictionary-poggit-virion-_3">制限事項</h2>
<ul>
<li>Virionユーザは、自分のAPIでVirionのクラスを公開してはいけません。もしそのようなオブジェクトをAPIで公開しなければならない場合は、Virionユーザが宣言したインターフェースでラップしなければなりません。</li>
</ul>
<h2 id="dictionary-poggit-virion-_4">付録</h2>
<h3 id="dictionary-poggit-virion-_5">構文的参照</h3>
<p>基本的に、構文参照は以下のように定義されます。</p>
<blockquote>
<p>A <code>T_NAMESPACE</code> (<code>namespace</code>), <code>T_USE</code> (<code>use</code>) or <code>T_NS_SEPARATOR</code> (<code>\</code>) token, or <code>T_USE</code> + <code>T_FUNCTION</code> (<code>use function</code>) or <code>T_USE</code> + <code>T_CONST</code> (<code>use const</code>), followed by a consecutive series of <code>T_STRING</code> (a non-keyword set of characters, i.e. part of the namespace) and <code>T_NS_SEPARATOR</code> (<code>\</code>).</p>
</blockquote>
<p>Virionの<code>クラス</code>・<code>関数</code>・<code>定数</code>の名前空間を参照する際には、以下のような形式で<strong>のみ</strong>行うことができます。</p>
<p><div class="highlight"><pre><span></span><code><span class="x">namespace name\space;</span>
<span class="x">use name\space\Clazz;</span>
<span class="x">use function name\space\func;</span>
<span class="x">use const name\space\CONSTANT;</span>
<span class="x">\name\space\Clazz::method();</span>
</code></pre></div>
<code>poggit\libasynql</code>というAntigenのVirionの例：</p>
<div class="highlight"><pre><span></span><code><span class="x">// syntactic reference</span>
<span class="x">use poggit\libasynql\SqlResult as Result; </span>
<span class="x">$result = new Result;</span>

<span class="x">// syntactic reference</span>
<span class="x">$result = new \poggit\libasynql\SqlResult;</span>

<span class="x">// syntactic reference</span>
<span class="x">use poggit\libasynql\SqlResult as Result;</span>
<span class="x">$class = new \ReflectionClass(Result::class);</span>

<span class="x">// syntactic reference</span>
<span class="x">$class = new \ReflectionClass(\poggit\libasynql\SqlResult::class);</span>

<span class="x">// syntactic references, from the scope of a class method in poggit\libasynql\SqlResult</span>
<span class="x">$class = new \ReflectionClass(self::class);</span>
<span class="x">$class = new \ReflectionClass(static::class);</span>
<span class="x">$class = new \ReflectionClass(get_class());</span>
<span class="x">$class = new \ReflectionClass(__CLASS__);</span>
<span class="x">$class = new \ReflectionClass(__NAMESPACE__ . &quot;\\SqlResult&quot;); // a boundary case barely acceptable</span>

<span class="x">// non-syntactic reference</span>
<span class="x">$class = new \ReflectionClass(&quot;poggit\\libasynql\\SqlResult&quot;);</span>
<span class="x">$class = new \ReflectionClass(&#39;poggit\libasynql\SqlResult&#39;);</span>
</code></pre></div>
<p>名前空間からの相対参照はシェーディングされないため、<strong>Virionの名前空間への相対参照は使用しないでください</strong>。例えば、Virion のAntigenが<code>namespace poggit\libasynql</code>である場合、Virionユーザでは<code>namespace poggit</code>で始まるコードを書いてはいけません。</p></section><h1 class='nav-section-title-end'>Ended: Poggit</h1><h1 class='nav-section-title-end'>Ended: 単項記事</h1><section class="print-page" id="link"><h1 id="link-_1">リンク集</h1>
<h2 id="link-_2">バイナリやソースコードの配布先</h2>
<ul>
<li><a href="https://github.com/pmmp/PocketMine-MP">pmmp/PocketMine-MP(GitHub)</a> - Releaseから最新版をダウンロード可能</li>
<li><a href="https://dev.azure.com/pocketmine/PHP-Builds/_build?definitionId=3&amp;_a=summary">PHP8 Binary</a> - publishedから、︙をクリックでダウンロードできます。</li>
</ul>
<h2 id="link-_3">ドキュメント</h2>
<ul>
<li><a href="https://pmmp.readthedocs.io/en/rtfd">公式ドキュメント</a> - インストール方法やアップデート方法、プラグインについてやよくある質問を見ることができます。</li>
</ul>
<h2 id="link-_4">フォーラム</h2>
<ul>
<li><a href="https://forums.pmmp.io">Forums</a> - 公式フォーラム(英語)</li>
<li><a href="https://forum.mcbe.jp">MCBEフォーラム</a> - 非公式日本語フォーラム</li>
<li><a href="https://forum.minecraft.study/">マインクラフト非公式フォーラム</a></li>
</ul>
<h2 id="link-_5">サーバーリスト</h2>
<ul>
<li><a href="https://mcservers.jp/">MCServers.JP</a></li>
</ul>
<h2 id="link-_6">プラグイン配布先</h2>
<ul>
<li><a href="https://poggit.pmmp.io/">poggit</a> - レビューされたプラグインやその他開発中のプラグインをダウンロードできます。</li>
</ul></section></div>

              

  

            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
<script id="__config" type="application/json">{"base": "/", "features": [], "search": "assets/javascripts/workers/search.b028fd86.min.js", "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version.title": "Select version"}}</script>
    

<script src="https://unpkg.com/iframe-worker/polyfill"></script>
<script src="search/search_index.js"></script>


    
      <script src="assets/javascripts/bundle.7f366e99.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="js/arithmatex.config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>