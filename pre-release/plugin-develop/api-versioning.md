# APIバージョニング: API versioning
PocketMine-MPのプラグインはどのAPIバージョンと互換性があるかを宣言する必要があります。これはプラグインをロードするかしないかを決定し、サーバーバージョンと適合しなかったときにデグレードするために用いられます。

## APIバージョンシステムの説明
PocketMine-MP 3.0.0現在ではAPIバージョンとサーバーバージョンは一致しています。このバージョンは[semantic major.minor.patch version number](https://semver.org/lang/ja/)で表します。

### 定義
Semverは大まかには以下のように定義されます。
- メジャーバージョンアップ: 破壊的な変更 - APIに準じるプラグインが動かなくなるレベルで公開APIが変更される。
- マイナーバージョンアップ: 機能の追加やAPIを破壊しない程度での大きな変更。これはAPIの非推奨化や新しいAPI機能が追加されることも含みうるが以前のマイナーバージョン向けに作られたプラグインは依然として動作する。
- パッチバージョンアップ: 大抵バグ修正。APIの破壊やそのバージョンのものに重大な変更があってはならない。

PocketMine-MPでは`==.>=.>=`(`bash`表記では`eq.ge.ge`)という条件をAPIバージョンの比較時に用いています。つまりこれは以下のことを表します。
- メジャーバージョンは互換性を持つためには**必ず一致**
- サーバーのマイナーバージョンは、プラグインのマイナーバージョン**以上が必須**
- サーバーのパッチバージョンもまた、プラグインのパッチバージョン**以上が必須**

PocketMine-MP開発者はいかなる非メージャーバージョンにおいてもプラグインとAPIの互換性がなくならないようにする努力をします。つまり、`3.1.1`を対象に書かれたプラグインは`3.x.y`でも動くはずです。ただし`4.0.0`や将来のメジャーバージョンで動く保証はありません。

### 例
| サーバーバージョン | プラグインバージョン | 互換性 | 理由 |
|:---------------|:---------------|:----------:|:-------|
| 4.0.0 | 3.0.0 | 無し | メジャーバージョンが異なる |
| 3.1.0 | 3.0.0 | あり | サーバーがプラグインよりも高いマイナーバージョンを持ち、互換性が保証されるため |
| 3.0.0 | 3.1.0 | 無し | プラグインがそのサーバーバージョンで持っていない機能を要求している |
| 3.0.1 | 3.0.0 | あり | サーバーがプラグインよりも高いパッチバージョンを持ち、互換性が保証されるため |
| 3.0.0 | 3.0.1 | 無し | プラグインがそのサーバーバージョンで持っていないバグ修正を要求している |

### サポートするAPIバージョンを選ぶ方法
必要最小限バージョンを選ぶべきです。例えば必要とする機能が`3.1.0`で追加されているのであれば、現在のサポートされるバージョンが`3.2.0`であっても`3.1.0`を一番小さいバージョンとして要求できます。これによりどのバージョンのPocketMine-MPを使っているかによらずより良いUXを与えることができます。

もちろん、うまく動作することを保証するためにプラグインを最小限のバージョンでテストする必要があります。しかしながら、もう役目を終えている低いバージョンを要求するというのは意味がないこともあります。

### よくある誤解と落とし穴
- APIバージョンは**マジックナンバーではありません**。盲目的にバージョンを変えてもそのバージョン向けになっていなければ**プラグインは勝手に動きません**。
- **APIバージョンはプラグインマニフェスト内で一つずつ書かなければならないものではありません**。**それぞれのメジャーバージョン内で最小のバージョン**のみが要求されます。
    - 良い例: `[3.1.0]`(単一の最小のバージョン), `[3.2.0, 4.0.0]`(異なる2つのメジャーバージョンでの最小のバージョン)
    - `[3.1.0, 3.1.1, 3.1.2]` - これは望ましく**なく**、余計なバージョンは無視される
- プラグインが**実際に指定したバージョンで動くこと**を確かめてください。a) クラッシュするバージョンや b)期待されるように動作しないバージョンはバージョンリストから除外される必要があります。

## 翻訳元
https://github.com/pmmp/DeveloperDocs/blob/b72417c924d0c917eeed6a172415edf7b5b3d52e/api-version-spec.md